From: <Saved by Blink>
Snapshot-Content-Location: https://paste.ubuntu.com/24458430/
Subject: Ubuntu Pastebin
Date: Thu, 23 Aug 2018 04:36:55 -0000
MIME-Version: 1.0
Content-Type: multipart/related;
	type="text/html";
	boundary="----MultipartBoundary--myup3W28cJhACPRv5gfAkJpIiTgDgdI7llNQjDYTk8----"


------MultipartBoundary--myup3W28cJhACPRv5gfAkJpIiTgDgdI7llNQjDYTk8----
Content-Type: text/html
Content-ID: <frame-0306DD45577F8B408A1E8361E021A06A@mhtml.blink>
Content-Transfer-Encoding: quoted-printable
Content-Location: https://paste.ubuntu.com/24458430/

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.=
w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns=3D"http://www.w3.=
org/1999/xhtml" xml:lang=3D"en" lang=3D"en"><head><meta http-equiv=3D"Conte=
nt-Type" content=3D"text/html; charset=3DUTF-8">
   =20
    <link rel=3D"stylesheet" type=3D"text/css" charset=3D"utf-8" media=3D"s=
creen" href=3D"https://paste.ubuntu.com/static/pastebin.css">
    <title>Ubuntu Pastebin</title>
</head>

    <body>
	<div id=3D"outerColumnContainer" style=3D"color: #000">
	      <div id=3D"contentColumn">
		      <div class=3D"inside">
	    <h1 id=3D"title">Ubuntu Pastebin</h1>
	   =20

<h1>Paste from tabris at Wed, 26 Apr 2017 05:00:02 +0000</h1>

<div class=3D"paste">
<a class=3D"pturl" href=3D"https://paste.ubuntu.com/24458430/plain/">Downlo=
ad as text</a>
<div class=3D"paste">
<table class=3D"pastetable"><tbody><tr><td class=3D"linenos"><div class=3D"=
linenodiv"><pre>   1
   2
   3
   4
   5
   6
   7
   8
   9
<span class=3D"special">  10</span>
  11
  12
  13
  14
  15
  16
  17
  18
  19
<span class=3D"special">  20</span>
  21
  22
  23
  24
  25
  26
  27
  28
  29
<span class=3D"special">  30</span>
  31
  32
  33
  34
  35
  36
  37
  38
  39
<span class=3D"special">  40</span>
  41
  42
  43
  44
  45
  46
  47
  48
  49
<span class=3D"special">  50</span>
  51
  52
  53
  54
  55
  56
  57
  58
  59
<span class=3D"special">  60</span>
  61
  62
  63
  64
  65
  66
  67
  68
  69
<span class=3D"special">  70</span>
  71
  72
  73
  74
  75
  76
  77
  78
  79
<span class=3D"special">  80</span>
  81
  82
  83
  84
  85
  86
  87
  88
  89
<span class=3D"special">  90</span>
  91
  92
  93
  94
  95
  96
  97
  98
  99
<span class=3D"special"> 100</span>
 101
 102
 103
 104
 105
 106
 107
 108
 109
<span class=3D"special"> 110</span>
 111
 112
 113
 114
 115
 116
 117
 118
 119
<span class=3D"special"> 120</span>
 121
 122
 123
 124
 125
 126
 127
 128
 129
<span class=3D"special"> 130</span>
 131
 132
 133
 134
 135
 136
 137
 138
 139
<span class=3D"special"> 140</span>
 141
 142
 143
 144
 145
 146
 147
 148
 149
<span class=3D"special"> 150</span>
 151
 152
 153
 154
 155
 156
 157
 158
 159
<span class=3D"special"> 160</span>
 161
 162
 163
 164
 165
 166
 167
 168
 169
<span class=3D"special"> 170</span>
 171
 172
 173
 174
 175
 176
 177
 178
 179
<span class=3D"special"> 180</span>
 181
 182
 183
 184
 185
 186
 187
 188
 189
<span class=3D"special"> 190</span>
 191
 192
 193
 194
 195
 196
 197
 198
 199
<span class=3D"special"> 200</span>
 201
 202
 203
 204
 205
 206
 207
 208
 209
<span class=3D"special"> 210</span>
 211
 212
 213
 214
 215
 216
 217
 218
 219
<span class=3D"special"> 220</span>
 221
 222
 223
 224
 225
 226
 227
 228
 229
<span class=3D"special"> 230</span>
 231
 232
 233
 234
 235
 236
 237
 238
 239
<span class=3D"special"> 240</span>
 241
 242
 243
 244
 245
 246
 247
 248
 249
<span class=3D"special"> 250</span>
 251
 252
 253
 254
 255
 256
 257
 258
 259
<span class=3D"special"> 260</span>
 261
 262
 263
 264
 265
 266
 267
 268
 269
<span class=3D"special"> 270</span>
 271
 272
 273
 274
 275
 276
 277
 278
 279
<span class=3D"special"> 280</span>
 281
 282
 283
 284
 285
 286
 287
 288
 289
<span class=3D"special"> 290</span>
 291
 292
 293
 294
 295
 296
 297
 298
 299
<span class=3D"special"> 300</span>
 301
 302
 303
 304
 305
 306
 307
 308
 309
<span class=3D"special"> 310</span>
 311
 312
 313
 314
 315
 316
 317
 318
 319
<span class=3D"special"> 320</span>
 321
 322
 323
 324
 325
 326
 327
 328
 329
<span class=3D"special"> 330</span>
 331
 332
 333
 334
 335
 336
 337
 338
 339
<span class=3D"special"> 340</span>
 341
 342
 343
 344
 345
 346
 347
 348
 349
<span class=3D"special"> 350</span>
 351
 352
 353
 354
 355
 356
 357
 358
 359
<span class=3D"special"> 360</span>
 361
 362
 363
 364
 365
 366
 367
 368
 369
<span class=3D"special"> 370</span>
 371
 372
 373
 374
 375
 376
 377
 378
 379
<span class=3D"special"> 380</span>
 381
 382
 383
 384
 385
 386
 387
 388
 389
<span class=3D"special"> 390</span>
 391
 392
 393
 394
 395
 396
 397
 398
 399
<span class=3D"special"> 400</span>
 401
 402
 403
 404
 405
 406
 407
 408
 409
<span class=3D"special"> 410</span>
 411
 412
 413
 414
 415
 416
 417
 418
 419
<span class=3D"special"> 420</span>
 421
 422
 423
 424
 425
 426
 427
 428
 429
<span class=3D"special"> 430</span>
 431
 432
 433
 434
 435
 436
 437
 438
 439
<span class=3D"special"> 440</span>
 441
 442
 443
 444
 445
 446
 447
 448
 449
<span class=3D"special"> 450</span>
 451
 452
 453
 454
 455
 456
 457
 458
 459
<span class=3D"special"> 460</span>
 461
 462
 463
 464
 465
 466
 467
 468
 469
<span class=3D"special"> 470</span>
 471
 472
 473
 474
 475
 476
 477
 478
 479
<span class=3D"special"> 480</span>
 481
 482
 483
 484
 485
 486
 487
 488
 489
<span class=3D"special"> 490</span>
 491
 492
 493
 494
 495
 496
 497
 498
 499
<span class=3D"special"> 500</span>
 501
 502
 503
 504
 505
 506
 507
 508
 509
<span class=3D"special"> 510</span>
 511
 512
 513
 514
 515
 516
 517
 518
 519
<span class=3D"special"> 520</span>
 521
 522
 523
 524
 525
 526
 527
 528
 529
<span class=3D"special"> 530</span>
 531
 532
 533
 534
 535
 536
 537
 538
 539
<span class=3D"special"> 540</span>
 541
 542
 543
 544
 545
 546
 547
 548
 549
<span class=3D"special"> 550</span>
 551
 552
 553
 554
 555
 556
 557
 558
 559
<span class=3D"special"> 560</span>
 561
 562
 563
 564
 565
 566
 567
 568
 569
<span class=3D"special"> 570</span>
 571
 572
 573
 574
 575
 576
 577
 578
 579
<span class=3D"special"> 580</span>
 581
 582
 583
 584
 585
 586
 587
 588
 589
<span class=3D"special"> 590</span>
 591
 592
 593
 594
 595
 596
 597
 598
 599
<span class=3D"special"> 600</span>
 601
 602
 603
 604
 605
 606
 607
 608
 609
<span class=3D"special"> 610</span>
 611
 612
 613
 614
 615
 616
 617
 618
 619
<span class=3D"special"> 620</span>
 621
 622
 623
 624
 625
 626
 627
 628
 629
<span class=3D"special"> 630</span>
 631
 632
 633
 634
 635
 636
 637
 638
 639
<span class=3D"special"> 640</span>
 641
 642
 643
 644
 645
 646
 647
 648
 649
<span class=3D"special"> 650</span>
 651
 652
 653
 654
 655
 656
 657
 658
 659
<span class=3D"special"> 660</span>
 661
 662
 663
 664
 665
 666
 667
 668
 669
<span class=3D"special"> 670</span>
 671
 672
 673
 674
 675
 676
 677
 678
 679
<span class=3D"special"> 680</span>
 681
 682
 683
 684
 685
 686
 687
 688
 689
<span class=3D"special"> 690</span>
 691
 692
 693
 694
 695
 696
 697
 698
 699
<span class=3D"special"> 700</span>
 701
 702
 703
 704
 705
 706
 707
 708
 709
<span class=3D"special"> 710</span>
 711
 712
 713
 714
 715
 716
 717
 718
 719
<span class=3D"special"> 720</span>
 721
 722
 723
 724
 725
 726
 727
 728
 729
<span class=3D"special"> 730</span>
 731
 732
 733
 734
 735
 736
 737
 738
 739
<span class=3D"special"> 740</span>
 741
 742
 743
 744
 745
 746
 747
 748
 749
<span class=3D"special"> 750</span>
 751
 752
 753
 754
 755
 756
 757
 758
 759
<span class=3D"special"> 760</span>
 761
 762
 763
 764
 765
 766
 767
 768
 769
<span class=3D"special"> 770</span>
 771
 772
 773
 774
 775
 776
 777
 778
 779
<span class=3D"special"> 780</span>
 781
 782
 783
 784
 785
 786
 787
 788
 789
<span class=3D"special"> 790</span>
 791
 792
 793
 794
 795
 796
 797
 798
 799
<span class=3D"special"> 800</span>
 801
 802
 803
 804
 805
 806
 807
 808
 809
<span class=3D"special"> 810</span>
 811
 812
 813
 814
 815
 816
 817
 818
 819
<span class=3D"special"> 820</span>
 821
 822
 823
 824
 825
 826
 827
 828
 829
<span class=3D"special"> 830</span>
 831
 832
 833
 834
 835
 836
 837
 838
 839
<span class=3D"special"> 840</span>
 841
 842
 843
 844
 845
 846
 847
 848
 849
<span class=3D"special"> 850</span>
 851
 852
 853
 854
 855
 856
 857
 858
 859
<span class=3D"special"> 860</span>
 861
 862
 863
 864
 865
 866
 867
 868
 869
<span class=3D"special"> 870</span>
 871
 872
 873
 874
 875
 876
 877
 878
 879
<span class=3D"special"> 880</span>
 881
 882
 883
 884
 885
 886
 887
 888
 889
<span class=3D"special"> 890</span>
 891
 892
 893
 894
 895
 896
 897
 898
 899
<span class=3D"special"> 900</span>
 901
 902
 903
 904
 905
 906
 907
 908
 909
<span class=3D"special"> 910</span>
 911
 912
 913
 914
 915
 916
 917
 918
 919
<span class=3D"special"> 920</span>
 921
 922
 923
 924
 925
 926
 927
 928
 929
<span class=3D"special"> 930</span>
 931
 932
 933
 934
 935
 936
 937
 938
 939
<span class=3D"special"> 940</span>
 941
 942
 943
 944
 945
 946
 947
 948
 949
<span class=3D"special"> 950</span>
 951
 952
 953
 954
 955
 956
 957
 958
 959
<span class=3D"special"> 960</span>
 961
 962
 963
 964
 965
 966
 967
 968
 969
<span class=3D"special"> 970</span>
 971
 972
 973
 974
 975
 976
 977
 978
 979
<span class=3D"special"> 980</span>
 981
 982
 983
 984
 985
 986
 987
 988
 989
<span class=3D"special"> 990</span>
 991
 992
 993
 994
 995
 996
 997
 998
 999
<span class=3D"special">1000</span>
1001
1002
1003
1004
1005
1006
1007
1008
1009
<span class=3D"special">1010</span>
1011
1012
1013
1014
1015
1016
1017
1018
1019
<span class=3D"special">1020</span>
1021
1022
1023
1024
1025
1026
1027
1028
1029
<span class=3D"special">1030</span>
1031
1032
1033
1034
1035
1036
1037
1038
1039
<span class=3D"special">1040</span>
1041
1042
1043
1044
1045
1046
1047
1048
1049
<span class=3D"special">1050</span>
1051
1052
1053
1054
1055
1056
1057
1058
1059
<span class=3D"special">1060</span>
1061
1062
1063
1064
1065</pre></div></td><td class=3D"code"><div class=3D"paste"><pre><span cla=
ss=3D"cp">#include &lt;bits/stdc++.h&gt;</span>
<span class=3D"k">using</span> <span class=3D"k">namespace</span> <span cla=
ss=3D"n">std</span><span class=3D"p">;</span>
<span class=3D"k">typedef</span> <span class=3D"kt">long</span> <span class=
=3D"kt">long</span> <span class=3D"kt">int</span> <span class=3D"n">LL</spa=
n> <span class=3D"p">;</span>
<span class=3D"k">const</span> <span class=3D"kt">int</span> <span class=3D=
"n">N</span> <span class=3D"o">=3D</span> <span class=3D"mi">100000</span><=
span class=3D"o">+</span><span class=3D"mi">7</span><span class=3D"p">;</sp=
an>

<span class=3D"cp">#define abs(x)  (((x)&gt;0)?(x):-(x))</span>

<span class=3D"cm">/***************************************/</span>


<span class=3D"k">const</span> <span class=3D"kt">double</span> <span class=
=3D"n">PI</span>  <span class=3D"o">=3D</span> <span class=3D"n">acos</span=
><span class=3D"p">(</span><span class=3D"o">-</span><span class=3D"mf">1.0=
</span><span class=3D"p">);</span>
<span class=3D"k">const</span> <span class=3D"kt">double</span> <span class=
=3D"n">eps</span> <span class=3D"o">=3D</span> <span class=3D"mf">1e-8</spa=
n><span class=3D"p">;</span>
<span class=3D"k">const</span> <span class=3D"kt">double</span> <span class=
=3D"n">INF</span> <span class=3D"o">=3D</span> <span class=3D"mf">1e18</spa=
n><span class=3D"p">;</span>
<span class=3D"cp">#define pb push_back</span>
<span class=3D"cp">#define mp make_pair</span>

<span class=3D"c1">///*************=E5=9F=BA=E7=A1=80***********/</span>
<span class=3D"kt">double</span> <span class=3D"n">torad</span><span class=
=3D"p">(</span><span class=3D"kt">double</span> <span class=3D"n">deg</span=
><span class=3D"p">)</span> <span class=3D"p">{</span> <span class=3D"k">re=
turn</span> <span class=3D"n">deg</span> <span class=3D"o">/</span> <span c=
lass=3D"mi">180</span> <span class=3D"o">*</span> <span class=3D"n">PI</spa=
n><span class=3D"p">;</span> <span class=3D"p">}</span>
<span class=3D"kr">inline</span> <span class=3D"kt">int</span> <span class=
=3D"n">dcmp</span><span class=3D"p">(</span><span class=3D"kt">double</span=
> <span class=3D"n">x</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
fabs</span><span class=3D"p">(</span><span class=3D"n">x</span><span class=
=3D"p">)</span> <span class=3D"o">&lt;</span> <span class=3D"n">eps</span><=
span class=3D"p">)</span> <span class=3D"k">return</span> <span class=3D"mi=
">0</span><span class=3D"p">;</span>
    <span class=3D"k">else</span> <span class=3D"k">return</span> <span cla=
ss=3D"n">x</span> <span class=3D"o">&lt;</span> <span class=3D"mi">0</span>=
 <span class=3D"o">?</span> <span class=3D"o">-</span><span class=3D"mi">1<=
/span> <span class=3D"o">:</span> <span class=3D"mi">1</span><span class=3D=
"p">;</span>
<span class=3D"p">}</span>
<span class=3D"k">struct</span> <span class=3D"n">Point</span>
<span class=3D"p">{</span>
    <span class=3D"kt">double</span> <span class=3D"n">x</span><span class=
=3D"p">,</span> <span class=3D"n">y</span><span class=3D"p">;</span>
    <span class=3D"n">Point</span><span class=3D"p">(</span><span class=3D"=
kt">double</span> <span class=3D"n">x</span><span class=3D"o">=3D</span><sp=
an class=3D"mi">0</span><span class=3D"p">,</span> <span class=3D"kt">doubl=
e</span> <span class=3D"n">y</span><span class=3D"o">=3D</span><span class=
=3D"mi">0</span><span class=3D"p">)</span><span class=3D"o">:</span><span c=
lass=3D"n">x</span><span class=3D"p">(</span><span class=3D"n">x</span><spa=
n class=3D"p">),</span><span class=3D"n">y</span><span class=3D"p">(</span>=
<span class=3D"n">y</span><span class=3D"p">)</span> <span class=3D"p">{</s=
pan> <span class=3D"p">}</span>
    <span class=3D"kr">inline</span> <span class=3D"kt">void</span> <span c=
lass=3D"n">read</span><span class=3D"p">()</span>
    <span class=3D"p">{</span>
        <span class=3D"n">scanf</span><span class=3D"p">(</span><span class=
=3D"s">"%lf%lf"</span><span class=3D"p">,</span> <span class=3D"o">&amp;</s=
pan><span class=3D"n">x</span><span class=3D"p">,</span> <span class=3D"o">=
&amp;</span><span class=3D"n">y</span><span class=3D"p">);</span>
    <span class=3D"p">}</span>
<span class=3D"p">};</span>
<span class=3D"k">typedef</span> <span class=3D"n">vector</span><span class=
=3D"o">&lt;</span><span class=3D"n">Point</span><span class=3D"o">&gt;</spa=
n> <span class=3D"n">Polygon</span><span class=3D"p">;</span>
<span class=3D"k">typedef</span> <span class=3D"n">Point</span> <span class=
=3D"n">Vector</span><span class=3D"p">;</span>

<span class=3D"kr">inline</span> <span class=3D"n">Vector</span> <span clas=
s=3D"k">operator</span><span class=3D"o">+</span> <span class=3D"p">(</span=
><span class=3D"n">Vector</span> <span class=3D"n">A</span><span class=3D"p=
">,</span> <span class=3D"n">Vector</span> <span class=3D"n">B</span><span =
class=3D"p">)</span> <span class=3D"p">{</span> <span class=3D"k">return</s=
pan> <span class=3D"n">Vector</span><span class=3D"p">(</span><span class=
=3D"n">A</span><span class=3D"p">.</span><span class=3D"n">x</span> <span c=
lass=3D"o">+</span> <span class=3D"n">B</span><span class=3D"p">.</span><sp=
an class=3D"n">x</span><span class=3D"p">,</span> <span class=3D"n">A</span=
><span class=3D"p">.</span><span class=3D"n">y</span> <span class=3D"o">+</=
span> <span class=3D"n">B</span><span class=3D"p">.</span><span class=3D"n"=
>y</span><span class=3D"p">);</span> <span class=3D"p">}</span>
<span class=3D"kr">inline</span> <span class=3D"n">Vector</span> <span clas=
s=3D"k">operator</span><span class=3D"o">-</span> <span class=3D"p">(</span=
><span class=3D"n">Point</span> <span class=3D"n">A</span><span class=3D"p"=
>,</span> <span class=3D"n">Point</span> <span class=3D"n">B</span><span cl=
ass=3D"p">)</span> <span class=3D"p">{</span> <span class=3D"k">return</spa=
n> <span class=3D"n">Vector</span><span class=3D"p">(</span><span class=3D"=
n">A</span><span class=3D"p">.</span><span class=3D"n">x</span> <span class=
=3D"o">-</span> <span class=3D"n">B</span><span class=3D"p">.</span><span c=
lass=3D"n">x</span><span class=3D"p">,</span> <span class=3D"n">A</span><sp=
an class=3D"p">.</span><span class=3D"n">y</span> <span class=3D"o">-</span=
> <span class=3D"n">B</span><span class=3D"p">.</span><span class=3D"n">y</=
span><span class=3D"p">);</span> <span class=3D"p">}</span>
<span class=3D"kr">inline</span> <span class=3D"n">Vector</span> <span clas=
s=3D"k">operator</span><span class=3D"o">*</span> <span class=3D"p">(</span=
><span class=3D"n">Vector</span> <span class=3D"n">A</span><span class=3D"p=
">,</span> <span class=3D"kt">double</span> <span class=3D"n">p</span><span=
 class=3D"p">)</span> <span class=3D"p">{</span> <span class=3D"k">return</=
span> <span class=3D"n">Vector</span><span class=3D"p">(</span><span class=
=3D"n">A</span><span class=3D"p">.</span><span class=3D"n">x</span> <span c=
lass=3D"o">*</span> <span class=3D"n">p</span><span class=3D"p">,</span> <s=
pan class=3D"n">A</span><span class=3D"p">.</span><span class=3D"n">y</span=
> <span class=3D"o">*</span> <span class=3D"n">p</span><span class=3D"p">);=
</span> <span class=3D"p">}</span>
<span class=3D"kr">inline</span> <span class=3D"n">Vector</span> <span clas=
s=3D"k">operator</span><span class=3D"o">/</span> <span class=3D"p">(</span=
><span class=3D"n">Vector</span> <span class=3D"n">A</span><span class=3D"p=
">,</span> <span class=3D"kt">double</span> <span class=3D"n">p</span><span=
 class=3D"p">)</span> <span class=3D"p">{</span> <span class=3D"k">return</=
span> <span class=3D"n">Vector</span><span class=3D"p">(</span><span class=
=3D"n">A</span><span class=3D"p">.</span><span class=3D"n">x</span> <span c=
lass=3D"o">/</span> <span class=3D"n">p</span><span class=3D"p">,</span> <s=
pan class=3D"n">A</span><span class=3D"p">.</span><span class=3D"n">y</span=
> <span class=3D"o">/</span> <span class=3D"n">p</span><span class=3D"p">);=
</span> <span class=3D"p">}</span>

<span class=3D"kr">inline</span> <span class=3D"kt">bool</span> <span class=
=3D"k">operator</span> <span class=3D"o">&lt;</span> <span class=3D"p">(</s=
pan><span class=3D"n">Point</span> <span class=3D"n">a</span><span class=3D=
"p">,</span> <span class=3D"n">Point</span> <span class=3D"n">b</span><span=
 class=3D"p">)</span> <span class=3D"p">{</span> <span class=3D"k">return</=
span> <span class=3D"n">a</span><span class=3D"p">.</span><span class=3D"n"=
>x</span> <span class=3D"o">&lt;</span> <span class=3D"n">b</span><span cla=
ss=3D"p">.</span><span class=3D"n">x</span> <span class=3D"o">||</span> <sp=
an class=3D"p">(</span><span class=3D"n">a</span><span class=3D"p">.</span>=
<span class=3D"n">x</span> <span class=3D"o">=3D=3D</span> <span class=3D"n=
">b</span><span class=3D"p">.</span><span class=3D"n">x</span> <span class=
=3D"o">&amp;&amp;</span> <span class=3D"n">a</span><span class=3D"p">.</spa=
n><span class=3D"n">y</span> <span class=3D"o">&lt;</span> <span class=3D"n=
">b</span><span class=3D"p">.</span><span class=3D"n">y</span><span class=
=3D"p">);</span> <span class=3D"p">}</span>
<span class=3D"kr">inline</span> <span class=3D"kt">bool</span> <span class=
=3D"k">operator</span> <span class=3D"o">=3D=3D</span> <span class=3D"p">(<=
/span><span class=3D"n">Point</span> <span class=3D"n">a</span><span class=
=3D"p">,</span> <span class=3D"n">Point</span> <span class=3D"n">b</span><s=
pan class=3D"p">)</span> <span class=3D"p">{</span> <span class=3D"k">retur=
n</span> <span class=3D"n">dcmp</span><span class=3D"p">(</span><span class=
=3D"n">a</span><span class=3D"p">.</span><span class=3D"n">x</span> <span c=
lass=3D"o">-</span> <span class=3D"n">b</span><span class=3D"p">.</span><sp=
an class=3D"n">x</span><span class=3D"p">)</span> <span class=3D"o">=3D=3D<=
/span> <span class=3D"mi">0</span> <span class=3D"o">&amp;&amp;</span> <spa=
n class=3D"n">dcmp</span><span class=3D"p">(</span><span class=3D"n">a</spa=
n><span class=3D"p">.</span><span class=3D"n">y</span> <span class=3D"o">-<=
/span> <span class=3D"n">b</span><span class=3D"p">.</span><span class=3D"n=
">y</span><span class=3D"p">)</span> <span class=3D"o">=3D=3D</span> <span =
class=3D"mi">0</span><span class=3D"p">;</span> <span class=3D"p">}</span>

<span class=3D"kr">inline</span> <span class=3D"kt">double</span> <span cla=
ss=3D"n">Dot</span><span class=3D"p">(</span><span class=3D"n">Vector</span=
> <span class=3D"n">A</span><span class=3D"p">,</span> <span class=3D"n">Ve=
ctor</span> <span class=3D"n">B</span><span class=3D"p">){</span> <span cla=
ss=3D"k">return</span> <span class=3D"n">A</span><span class=3D"p">.</span>=
<span class=3D"n">x</span> <span class=3D"o">*</span> <span class=3D"n">B</=
span><span class=3D"p">.</span><span class=3D"n">x</span> <span class=3D"o"=
>+</span> <span class=3D"n">A</span><span class=3D"p">.</span><span class=
=3D"n">y</span> <span class=3D"o">*</span> <span class=3D"n">B</span><span =
class=3D"p">.</span><span class=3D"n">y</span><span class=3D"p">;}</span>
<span class=3D"kr">inline</span> <span class=3D"kt">double</span> <span cla=
ss=3D"n">Length</span><span class=3D"p">(</span><span class=3D"n">Vector</s=
pan> <span class=3D"n">A</span><span class=3D"p">)</span> <span class=3D"p"=
>{</span> <span class=3D"k">return</span> <span class=3D"n">sqrt</span><spa=
n class=3D"p">(</span><span class=3D"n">Dot</span><span class=3D"p">(</span=
><span class=3D"n">A</span><span class=3D"p">,</span> <span class=3D"n">A</=
span><span class=3D"p">));</span> <span class=3D"p">}</span>
<span class=3D"kr">inline</span> <span class=3D"kt">double</span> <span cla=
ss=3D"n">Angle</span><span class=3D"p">(</span><span class=3D"n">Vector</sp=
an> <span class=3D"n">A</span><span class=3D"p">,</span> <span class=3D"n">=
Vector</span> <span class=3D"n">B</span><span class=3D"p">)</span> <span cl=
ass=3D"p">{</span> <span class=3D"k">return</span> <span class=3D"n">acos</=
span><span class=3D"p">(</span><span class=3D"n">Dot</span><span class=3D"p=
">(</span><span class=3D"n">A</span><span class=3D"p">,</span> <span class=
=3D"n">B</span><span class=3D"p">)</span> <span class=3D"o">/</span> <span =
class=3D"n">Length</span><span class=3D"p">(</span><span class=3D"n">A</spa=
n><span class=3D"p">)</span> <span class=3D"o">/</span> <span class=3D"n">L=
ength</span><span class=3D"p">(</span><span class=3D"n">B</span><span class=
=3D"p">));</span> <span class=3D"p">}</span>
<span class=3D"kr">inline</span> <span class=3D"kt">double</span> <span cla=
ss=3D"n">angle</span><span class=3D"p">(</span><span class=3D"n">Vector</sp=
an> <span class=3D"n">v</span><span class=3D"p">)</span> <span class=3D"p">=
{</span> <span class=3D"k">return</span> <span class=3D"n">atan2</span><spa=
n class=3D"p">(</span><span class=3D"n">v</span><span class=3D"p">.</span><=
span class=3D"n">y</span><span class=3D"p">,</span> <span class=3D"n">v</sp=
an><span class=3D"p">.</span><span class=3D"n">x</span><span class=3D"p">);=
</span> <span class=3D"p">}</span>
<span class=3D"kr">inline</span> <span class=3D"kt">double</span> <span cla=
ss=3D"n">Cross</span><span class=3D"p">(</span><span class=3D"n">Vector</sp=
an> <span class=3D"n">A</span><span class=3D"p">,</span> <span class=3D"n">=
Vector</span> <span class=3D"n">B</span><span class=3D"p">)</span> <span cl=
ass=3D"p">{</span> <span class=3D"k">return</span> <span class=3D"n">A</spa=
n><span class=3D"p">.</span><span class=3D"n">x</span> <span class=3D"o">*<=
/span> <span class=3D"n">B</span><span class=3D"p">.</span><span class=3D"n=
">y</span> <span class=3D"o">-</span> <span class=3D"n">A</span><span class=
=3D"p">.</span><span class=3D"n">y</span> <span class=3D"o">*</span> <span =
class=3D"n">B</span><span class=3D"p">.</span><span class=3D"n">x</span><sp=
an class=3D"p">;</span> <span class=3D"p">}</span>
<span class=3D"kr">inline</span> <span class=3D"n">Vector</span> <span clas=
s=3D"n">Unit</span><span class=3D"p">(</span><span class=3D"n">Vector</span=
> <span class=3D"n">x</span><span class=3D"p">)</span> <span class=3D"p">{<=
/span> <span class=3D"k">return</span> <span class=3D"n">x</span> <span cla=
ss=3D"o">/</span> <span class=3D"n">Length</span><span class=3D"p">(</span>=
<span class=3D"n">x</span><span class=3D"p">);</span> <span class=3D"p">}</=
span>  <span class=3D"c1">//=E5=8D=95=E4=BD=8D=E5=90=91=E9=87=8F</span>
<span class=3D"kr">inline</span> <span class=3D"n">Vector</span> <span clas=
s=3D"n">Normal</span><span class=3D"p">(</span><span class=3D"n">Vector</sp=
an> <span class=3D"n">x</span><span class=3D"p">)</span> <span class=3D"p">=
{</span> <span class=3D"k">return</span> <span class=3D"n">Point</span><spa=
n class=3D"p">(</span><span class=3D"o">-</span><span class=3D"n">x</span><=
span class=3D"p">.</span><span class=3D"n">y</span><span class=3D"p">,</spa=
n> <span class=3D"n">x</span><span class=3D"p">.</span><span class=3D"n">x<=
/span><span class=3D"p">)</span> <span class=3D"o">/</span> <span class=3D"=
n">Length</span><span class=3D"p">(</span><span class=3D"n">x</span><span c=
lass=3D"p">);</span> <span class=3D"p">}</span> <span class=3D"c1">//=E5=9E=
=82=E7=9B=B4=E6=B3=95=E5=90=91=E9=87=8F</span>
<span class=3D"kr">inline</span> <span class=3D"kt">double</span> <span cla=
ss=3D"n">Area2</span><span class=3D"p">(</span><span class=3D"n">Point</spa=
n> <span class=3D"n">A</span><span class=3D"p">,</span> <span class=3D"n">P=
oint</span> <span class=3D"n">B</span><span class=3D"p">,</span> <span clas=
s=3D"n">Point</span> <span class=3D"n">C</span><span class=3D"p">)</span> <=
span class=3D"p">{</span> <span class=3D"k">return</span> <span class=3D"n"=
>Cross</span><span class=3D"p">(</span><span class=3D"n">B</span> <span cla=
ss=3D"o">-</span> <span class=3D"n">A</span><span class=3D"p">,</span> <spa=
n class=3D"n">C</span> <span class=3D"o">-</span> <span class=3D"n">A</span=
><span class=3D"p">);</span> <span class=3D"p">}</span>
<span class=3D"kr">inline</span> <span class=3D"n">Vector</span> <span clas=
s=3D"n">Rotate</span><span class=3D"p">(</span><span class=3D"n">Vector</sp=
an> <span class=3D"n">A</span><span class=3D"p">,</span> <span class=3D"kt"=
>double</span> <span class=3D"n">rad</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"k">return</span> <span class=3D"n">Vector</span><span cl=
ass=3D"p">(</span><span class=3D"n">A</span><span class=3D"p">.</span><span=
 class=3D"n">x</span> <span class=3D"o">*</span> <span class=3D"n">cos</spa=
n><span class=3D"p">(</span><span class=3D"n">rad</span><span class=3D"p">)=
</span> <span class=3D"o">-</span> <span class=3D"n">A</span><span class=3D=
"p">.</span><span class=3D"n">y</span><span class=3D"o">*</span><span class=
=3D"n">sin</span><span class=3D"p">(</span><span class=3D"n">rad</span><spa=
n class=3D"p">),</span> <span class=3D"n">A</span><span class=3D"p">.</span=
><span class=3D"n">x</span><span class=3D"o">*</span><span class=3D"n">sin<=
/span><span class=3D"p">(</span><span class=3D"n">rad</span><span class=3D"=
p">)</span> <span class=3D"o">+</span> <span class=3D"n">A</span><span clas=
s=3D"p">.</span><span class=3D"n">y</span> <span class=3D"o">*</span> <span=
 class=3D"n">cos</span><span class=3D"p">(</span><span class=3D"n">rad</spa=
n><span class=3D"p">));</span>
<span class=3D"p">}</span>

<span class=3D"cm">/****************=E7=9B=B4=E7=BA=BF=E4=B8=8E=E7=BA=BF=E6=
=AE=B5**************/</span>


<span class=3D"c1">//=E6=B1=82=E7=9B=B4=E7=BA=BFp+tv=E5=92=8Cq+tw=E7=9A=84=
=E4=BA=A4=E7=82=B9 Cross(v, w) =3D=3D 0=E6=97=A0=E4=BA=A4=E7=82=B9</span>
<span class=3D"n">Point</span> <span class=3D"n">GetLineIntersection</span>=
<span class=3D"p">(</span><span class=3D"n">Point</span> <span class=3D"n">=
p</span><span class=3D"p">,</span> <span class=3D"n">Vector</span> <span cl=
ass=3D"n">v</span><span class=3D"p">,</span> <span class=3D"n">Point</span>=
 <span class=3D"n">q</span><span class=3D"p">,</span> <span class=3D"n">Vec=
tor</span> <span class=3D"n">w</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"n">Vector</span> <span class=3D"n">u</span> <span class=
=3D"o">=3D</span> <span class=3D"n">p</span> <span class=3D"o">-</span> <sp=
an class=3D"n">q</span><span class=3D"p">;</span>
    <span class=3D"kt">double</span> <span class=3D"n">t</span> <span class=
=3D"o">=3D</span> <span class=3D"n">Cross</span><span class=3D"p">(</span><=
span class=3D"n">w</span><span class=3D"p">,</span> <span class=3D"n">u</sp=
an><span class=3D"p">)</span> <span class=3D"o">/</span> <span class=3D"n">=
Cross</span><span class=3D"p">(</span><span class=3D"n">v</span><span class=
=3D"p">,</span> <span class=3D"n">w</span><span class=3D"p">);</span>
    <span class=3D"k">return</span> <span class=3D"n">p</span> <span class=
=3D"o">+</span> <span class=3D"n">v</span> <span class=3D"o">*</span> <span=
 class=3D"n">t</span><span class=3D"p">;</span>
<span class=3D"p">}</span>


<span class=3D"c1">//=E7=82=B9p=E5=9C=A8=E7=9B=B4=E7=BA=BFab=E7=9A=84=E6=8A=
=95=E5=BD=B1</span>
<span class=3D"kr">inline</span> <span class=3D"n">Point</span> <span class=
=3D"n">GetLineProjection</span><span class=3D"p">(</span><span class=3D"n">=
Point</span> <span class=3D"n">P</span><span class=3D"p">,</span> <span cla=
ss=3D"n">Point</span> <span class=3D"n">A</span><span class=3D"p">,</span> =
<span class=3D"n">Point</span> <span class=3D"n">B</span><span class=3D"p">=
)</span>
<span class=3D"p">{</span>
    <span class=3D"n">Vector</span> <span class=3D"n">v</span> <span class=
=3D"o">=3D</span> <span class=3D"n">B</span> <span class=3D"o">-</span> <sp=
an class=3D"n">A</span><span class=3D"p">;</span>
    <span class=3D"k">return</span> <span class=3D"n">A</span> <span class=
=3D"o">+</span> <span class=3D"n">v</span> <span class=3D"o">*</span> <span=
 class=3D"p">(</span><span class=3D"n">Dot</span><span class=3D"p">(</span>=
<span class=3D"n">v</span><span class=3D"p">,</span> <span class=3D"n">P</s=
pan> <span class=3D"o">-</span> <span class=3D"n">A</span><span class=3D"p"=
>)</span> <span class=3D"o">/</span> <span class=3D"n">Dot</span><span clas=
s=3D"p">(</span><span class=3D"n">v</span><span class=3D"p">,</span> <span =
class=3D"n">v</span><span class=3D"p">));</span>
<span class=3D"p">}</span>


<span class=3D"c1">//=E7=82=B9=E5=88=B0=E7=9B=B4=E7=BA=BF=E8=B7=9D=E7=A6=BB=
</span>
<span class=3D"kr">inline</span> <span class=3D"kt">double</span> <span cla=
ss=3D"n">DistanceToLine</span><span class=3D"p">(</span><span class=3D"n">P=
oint</span> <span class=3D"n">P</span><span class=3D"p">,</span> <span clas=
s=3D"n">Point</span> <span class=3D"n">A</span><span class=3D"p">,</span> <=
span class=3D"n">Point</span> <span class=3D"n">B</span><span class=3D"p">)=
</span>
<span class=3D"p">{</span>
    <span class=3D"n">Vector</span> <span class=3D"n">v1</span> <span class=
=3D"o">=3D</span> <span class=3D"n">B</span> <span class=3D"o">-</span> <sp=
an class=3D"n">A</span><span class=3D"p">,</span> <span class=3D"n">v2</spa=
n> <span class=3D"o">=3D</span> <span class=3D"n">P</span> <span class=3D"o=
">-</span> <span class=3D"n">A</span><span class=3D"p">;</span>
    <span class=3D"k">return</span> <span class=3D"n">fabs</span><span clas=
s=3D"p">(</span><span class=3D"n">Cross</span><span class=3D"p">(</span><sp=
an class=3D"n">v1</span><span class=3D"p">,</span> <span class=3D"n">v2</sp=
an><span class=3D"p">))</span> <span class=3D"o">/</span> <span class=3D"n"=
>Length</span><span class=3D"p">(</span><span class=3D"n">v1</span><span cl=
ass=3D"p">);</span> <span class=3D"c1">// =E5=A6=82=E6=9E=9C=E4=B8=8D=E5=8F=
=96=E7=BB=9D=E5=AF=B9=E5=80=BC=EF=BC=8C=E5=BE=97=E5=88=B0=E7=9A=84=E6=98=AF=
=E6=9C=89=E5=90=91=E8=B7=9D=E7=A6=BB</span>
<span class=3D"p">}</span>
<span class=3D"c1">//=E7=82=B9=E5=9C=A8p=E7=BA=BF=E6=AE=B5=E4=B8=8A(=E5=8C=
=85=E6=8B=AC=E7=AB=AF=E7=82=B9)</span>
<span class=3D"kr">inline</span> <span class=3D"kt">bool</span> <span class=
=3D"n">OnSegment</span><span class=3D"p">(</span><span class=3D"n">Point</s=
pan> <span class=3D"n">p</span><span class=3D"p">,</span> <span class=3D"n"=
>Point</span> <span class=3D"n">a1</span><span class=3D"p">,</span> <span c=
lass=3D"n">Point</span> <span class=3D"n">a2</span><span class=3D"p">)</spa=
n>
<span class=3D"p">{</span>
    <span class=3D"k">return</span> <span class=3D"n">dcmp</span><span clas=
s=3D"p">(</span><span class=3D"n">Cross</span><span class=3D"p">(</span><sp=
an class=3D"n">a1</span><span class=3D"o">-</span><span class=3D"n">p</span=
><span class=3D"p">,</span> <span class=3D"n">a2</span><span class=3D"o">-<=
/span><span class=3D"n">p</span><span class=3D"p">))</span> <span class=3D"=
o">=3D=3D</span> <span class=3D"mi">0</span> <span class=3D"o">&amp;&amp;</=
span> <span class=3D"n">dcmp</span><span class=3D"p">(</span><span class=3D=
"n">Dot</span><span class=3D"p">(</span><span class=3D"n">a1</span><span cl=
ass=3D"o">-</span><span class=3D"n">p</span><span class=3D"p">,</span> <spa=
n class=3D"n">a2</span><span class=3D"o">-</span><span class=3D"n">p</span>=
<span class=3D"p">))</span> <span class=3D"o">&lt;=3D</span> <span class=3D=
"mi">0</span><span class=3D"p">;</span>
<span class=3D"p">}</span>
<span class=3D"c1">// =E8=BF=87=E4=B8=A4=E7=82=B9p1, p2=E7=9A=84=E7=9B=B4=
=E7=BA=BF=E4=B8=80=E8=88=AC=E6=96=B9=E7=A8=8Bax+by+c=3D0</span>
<span class=3D"c1">// (x2-x1)(y-y1) =3D (y2-y1)(x-x1)</span>
<span class=3D"kr">inline</span> <span class=3D"kt">void</span> <span class=
=3D"n">getLineGeneralEquation</span><span class=3D"p">(</span><span class=
=3D"n">Point</span> <span class=3D"n">p1</span><span class=3D"p">,</span> <=
span class=3D"n">Point</span> <span class=3D"n">p2</span><span class=3D"p">=
,</span> <span class=3D"kt">double</span><span class=3D"o">&amp;</span> <sp=
an class=3D"n">a</span><span class=3D"p">,</span> <span class=3D"kt">double=
</span><span class=3D"o">&amp;</span> <span class=3D"n">b</span><span class=
=3D"p">,</span> <span class=3D"kt">double</span> <span class=3D"o">&amp;</s=
pan><span class=3D"n">c</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"n">a</span> <span class=3D"o">=3D</span> <span class=3D"=
n">p2</span><span class=3D"p">.</span><span class=3D"n">y</span> <span clas=
s=3D"o">-</span> <span class=3D"n">p1</span><span class=3D"p">.</span><span=
 class=3D"n">y</span><span class=3D"p">;</span>
    <span class=3D"n">b</span> <span class=3D"o">=3D</span> <span class=3D"=
n">p1</span><span class=3D"p">.</span><span class=3D"n">x</span> <span clas=
s=3D"o">-</span> <span class=3D"n">p2</span><span class=3D"p">.</span><span=
 class=3D"n">x</span><span class=3D"p">;</span>
    <span class=3D"n">c</span> <span class=3D"o">=3D</span> <span class=3D"=
o">-</span><span class=3D"n">a</span> <span class=3D"o">*</span> <span clas=
s=3D"n">p1</span><span class=3D"p">.</span><span class=3D"n">x</span> <span=
 class=3D"o">-</span> <span class=3D"n">b</span> <span class=3D"o">*</span>=
 <span class=3D"n">p1</span><span class=3D"p">.</span><span class=3D"n">y</=
span><span class=3D"p">;</span>
<span class=3D"p">}</span>
<span class=3D"c1">//=E7=82=B9=E5=88=B0=E7=BA=BF=E6=AE=B5=E8=B7=9D=E7=A6=BB=
</span>
<span class=3D"kt">double</span> <span class=3D"n">DistanceToSegment</span>=
<span class=3D"p">(</span><span class=3D"n">Point</span> <span class=3D"n">=
p</span><span class=3D"p">,</span> <span class=3D"n">Point</span> <span cla=
ss=3D"n">a</span><span class=3D"p">,</span> <span class=3D"n">Point</span> =
<span class=3D"n">b</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
a</span> <span class=3D"o">=3D=3D</span> <span class=3D"n">b</span><span cl=
ass=3D"p">)</span> <span class=3D"k">return</span> <span class=3D"n">Length=
</span><span class=3D"p">(</span><span class=3D"n">p</span> <span class=3D"=
o">-</span> <span class=3D"n">a</span><span class=3D"p">);</span>
    <span class=3D"n">Vector</span> <span class=3D"n">v1</span> <span class=
=3D"o">=3D</span> <span class=3D"n">b</span> <span class=3D"o">-</span> <sp=
an class=3D"n">a</span><span class=3D"p">,</span> <span class=3D"n">v2</spa=
n> <span class=3D"o">=3D</span> <span class=3D"n">p</span> <span class=3D"o=
">-</span> <span class=3D"n">a</span><span class=3D"p">,</span> <span class=
=3D"n">v3</span> <span class=3D"o">=3D</span> <span class=3D"n">p</span> <s=
pan class=3D"o">-</span> <span class=3D"n">b</span><span class=3D"p">;</spa=
n>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
dcmp</span><span class=3D"p">(</span><span class=3D"n">Dot</span><span clas=
s=3D"p">(</span><span class=3D"n">v1</span><span class=3D"p">,</span> <span=
 class=3D"n">v2</span><span class=3D"p">))</span> <span class=3D"o">&lt;</s=
pan> <span class=3D"mi">0</span><span class=3D"p">)</span> <span class=3D"k=
">return</span> <span class=3D"n">Length</span><span class=3D"p">(</span><s=
pan class=3D"n">v2</span><span class=3D"p">);</span>
    <span class=3D"k">else</span> <span class=3D"k">if</span><span class=3D=
"p">(</span><span class=3D"n">dcmp</span><span class=3D"p">(</span><span cl=
ass=3D"n">Dot</span><span class=3D"p">(</span><span class=3D"n">v1</span><s=
pan class=3D"p">,</span> <span class=3D"n">v3</span><span class=3D"p">))</s=
pan> <span class=3D"o">&gt;</span> <span class=3D"mi">0</span><span class=
=3D"p">)</span> <span class=3D"k">return</span> <span class=3D"n">Length</s=
pan><span class=3D"p">(</span><span class=3D"n">v3</span><span class=3D"p">=
);</span>
    <span class=3D"k">else</span> <span class=3D"k">return</span> <span cla=
ss=3D"n">fabs</span><span class=3D"p">(</span><span class=3D"n">Cross</span=
><span class=3D"p">(</span><span class=3D"n">v1</span><span class=3D"p">,</=
span> <span class=3D"n">v2</span><span class=3D"p">))</span> <span class=3D=
"o">/</span> <span class=3D"n">Length</span><span class=3D"p">(</span><span=
 class=3D"n">v1</span><span class=3D"p">);</span>
<span class=3D"p">}</span>
<span class=3D"c1">//=E4=B8=A4=E7=BA=BF=E6=AE=B5=E6=9C=80=E8=BF=91=E8=B7=9D=
=E7=A6=BB</span>
<span class=3D"kr">inline</span> <span class=3D"kt">double</span> <span cla=
ss=3D"n">dis_pair_seg</span><span class=3D"p">(</span><span class=3D"n">Poi=
nt</span> <span class=3D"n">p1</span><span class=3D"p">,</span> <span class=
=3D"n">Point</span> <span class=3D"n">p2</span><span class=3D"p">,</span> <=
span class=3D"n">Point</span> <span class=3D"n">p3</span><span class=3D"p">=
,</span> <span class=3D"n">Point</span> <span class=3D"n">p4</span><span cl=
ass=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"k">return</span> <span class=3D"n">min</span><span class=
=3D"p">(</span><span class=3D"n">min</span><span class=3D"p">(</span><span =
class=3D"n">DistanceToSegment</span><span class=3D"p">(</span><span class=
=3D"n">p1</span><span class=3D"p">,</span> <span class=3D"n">p3</span><span=
 class=3D"p">,</span> <span class=3D"n">p4</span><span class=3D"p">),</span=
> <span class=3D"n">DistanceToSegment</span><span class=3D"p">(</span><span=
 class=3D"n">p2</span><span class=3D"p">,</span> <span class=3D"n">p3</span=
><span class=3D"p">,</span> <span class=3D"n">p4</span><span class=3D"p">))=
,</span>
               <span class=3D"n">min</span><span class=3D"p">(</span><span =
class=3D"n">DistanceToSegment</span><span class=3D"p">(</span><span class=
=3D"n">p3</span><span class=3D"p">,</span> <span class=3D"n">p1</span><span=
 class=3D"p">,</span> <span class=3D"n">p2</span><span class=3D"p">),</span=
> <span class=3D"n">DistanceToSegment</span><span class=3D"p">(</span><span=
 class=3D"n">p4</span><span class=3D"p">,</span> <span class=3D"n">p1</span=
><span class=3D"p">,</span> <span class=3D"n">p2</span><span class=3D"p">))=
);</span>
<span class=3D"p">}</span>
<span class=3D"c1">//=E7=BA=BF=E6=AE=B5=E7=9B=B8=E4=BA=A4=E5=88=A4=E5=AE=9A=
</span>
<span class=3D"kr">inline</span> <span class=3D"kt">bool</span> <span class=
=3D"n">SegmentProperIntersection</span><span class=3D"p">(</span><span clas=
s=3D"n">Point</span> <span class=3D"n">a1</span><span class=3D"p">,</span> =
<span class=3D"n">Point</span> <span class=3D"n">a2</span><span class=3D"p"=
>,</span> <span class=3D"n">Point</span> <span class=3D"n">b1</span><span c=
lass=3D"p">,</span> <span class=3D"n">Point</span> <span class=3D"n">b2</sp=
an><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">double</span> <span class=3D"n">c1</span> <span clas=
s=3D"o">=3D</span> <span class=3D"n">Cross</span><span class=3D"p">(</span>=
<span class=3D"n">a2</span> <span class=3D"o">-</span> <span class=3D"n">a1=
</span><span class=3D"p">,</span> <span class=3D"n">b1</span> <span class=
=3D"o">-</span> <span class=3D"n">a1</span><span class=3D"p">),</span> <spa=
n class=3D"n">c2</span> <span class=3D"o">=3D</span> <span class=3D"n">Cros=
s</span><span class=3D"p">(</span><span class=3D"n">a2</span> <span class=
=3D"o">-</span> <span class=3D"n">a1</span><span class=3D"p">,</span> <span=
 class=3D"n">b2</span> <span class=3D"o">-</span> <span class=3D"n">a1</spa=
n><span class=3D"p">),</span>
           <span class=3D"n">c3</span> <span class=3D"o">=3D</span> <span c=
lass=3D"n">Cross</span><span class=3D"p">(</span><span class=3D"n">b2</span=
> <span class=3D"o">-</span> <span class=3D"n">b1</span><span class=3D"p">,=
</span> <span class=3D"n">a1</span> <span class=3D"o">-</span> <span class=
=3D"n">b1</span><span class=3D"p">),</span> <span class=3D"n">c4</span> <sp=
an class=3D"o">=3D</span> <span class=3D"n">Cross</span><span class=3D"p">(=
</span><span class=3D"n">b2</span> <span class=3D"o">-</span> <span class=
=3D"n">b1</span><span class=3D"p">,</span> <span class=3D"n">a2</span> <spa=
n class=3D"o">-</span> <span class=3D"n">b1</span><span class=3D"p">);</spa=
n>
    <span class=3D"k">return</span> <span class=3D"n">dcmp</span><span clas=
s=3D"p">(</span><span class=3D"n">c1</span><span class=3D"p">)</span> <span=
 class=3D"o">*</span> <span class=3D"n">dcmp</span><span class=3D"p">(</spa=
n><span class=3D"n">c2</span><span class=3D"p">)</span> <span class=3D"o">&=
lt;</span> <span class=3D"mi">0</span> <span class=3D"o">&amp;&amp;</span> =
<span class=3D"n">dcmp</span><span class=3D"p">(</span><span class=3D"n">c3=
</span><span class=3D"p">)</span> <span class=3D"o">*</span> <span class=3D=
"n">dcmp</span><span class=3D"p">(</span><span class=3D"n">c4</span><span c=
lass=3D"p">)</span> <span class=3D"o">&lt;</span> <span class=3D"mi">0</spa=
n><span class=3D"p">;</span>
<span class=3D"p">}</span>
<span class=3D"c1">// =E6=9C=89=E5=90=91=E7=9B=B4=E7=BA=BF=E3=80=82=E5=AE=
=83=E7=9A=84=E5=B7=A6=E8=BE=B9=E5=B0=B1=E6=98=AF=E5=AF=B9=E5=BA=94=E7=9A=84=
=E5=8D=8A=E5=B9=B3=E9=9D=A2</span>
<span class=3D"k">struct</span> <span class=3D"n">Line</span>
<span class=3D"p">{</span>
    <span class=3D"n">Point</span> <span class=3D"n">p</span><span class=3D=
"p">,</span> <span class=3D"n">q</span><span class=3D"p">;</span>    <span =
class=3D"c1">// =E7=9B=B4=E7=BA=BF=E4=B8=8A=E4=BB=BB=E6=84=8F=E4=B8=80=E7=
=82=B9,p=E4=BD=9C=E4=B8=BA=E8=B5=B7=E7=82=B9</span>
    <span class=3D"n">Vector</span> <span class=3D"n">v</span><span class=
=3D"p">;</span>   <span class=3D"c1">// =E6=96=B9=E5=90=91=E5=90=91=E9=87=
=8F</span>
    <span class=3D"kt">double</span> <span class=3D"n">ang</span><span clas=
s=3D"p">;</span> <span class=3D"c1">// =E6=9E=81=E8=A7=92=EF=BC=8C=E5=8D=B3=
=E4=BB=8Ex=E6=AD=A3=E5=8D=8A=E8=BD=B4=E6=97=8B=E8=BD=AC=E5=88=B0=E5=90=91=
=E9=87=8Fv=E6=89=80=E9=9C=80=E8=A6=81=E7=9A=84=E8=A7=92=EF=BC=88=E5=BC=A7=
=E5=BA=A6=EF=BC=89</span>
    <span class=3D"n">Line</span><span class=3D"p">()</span> <span class=3D=
"p">{}</span>
<span class=3D"c1">//    Line(Point P, Vector v):p(P),v(v)</span>
<span class=3D"c1">//    {</span>
<span class=3D"c1">//        ang =3D atan2(v.y, v.x);</span>
<span class=3D"c1">//    }</span>
    <span class=3D"n">Line</span><span class=3D"p">(</span><span class=3D"n=
">Point</span> <span class=3D"n">P</span><span class=3D"p">,</span> <span c=
lass=3D"n">Point</span> <span class=3D"n">Q</span><span class=3D"p">)</span=
><span class=3D"o">:</span><span class=3D"n">p</span><span class=3D"p">(</s=
pan><span class=3D"n">P</span><span class=3D"p">),</span> <span class=3D"n"=
>q</span><span class=3D"p">(</span><span class=3D"n">Q</span><span class=3D=
"p">)</span>
    <span class=3D"p">{</span>
        <span class=3D"n">v</span> <span class=3D"o">=3D</span> <span class=
=3D"n">q</span> <span class=3D"o">-</span> <span class=3D"n">p</span><span =
class=3D"p">;</span>
        <span class=3D"n">ang</span> <span class=3D"o">=3D</span> <span cla=
ss=3D"n">atan2</span><span class=3D"p">(</span><span class=3D"n">v</span><s=
pan class=3D"p">.</span><span class=3D"n">y</span><span class=3D"p">,</span=
> <span class=3D"n">v</span><span class=3D"p">.</span><span class=3D"n">x</=
span><span class=3D"p">);</span>
    <span class=3D"p">}</span>
    <span class=3D"kr">inline</span> <span class=3D"kt">bool</span> <span c=
lass=3D"k">operator</span> <span class=3D"o">&lt;</span> <span class=3D"p">=
(</span><span class=3D"k">const</span> <span class=3D"n">Line</span><span c=
lass=3D"o">&amp;</span> <span class=3D"n">L</span><span class=3D"p">)</span=
> <span class=3D"k">const</span>
    <span class=3D"p">{</span>
        <span class=3D"k">return</span> <span class=3D"n">ang</span> <span =
class=3D"o">&lt;</span> <span class=3D"n">L</span><span class=3D"p">.</span=
><span class=3D"n">ang</span><span class=3D"p">;</span>
    <span class=3D"p">}</span>
    <span class=3D"kr">inline</span> <span class=3D"n">Point</span> <span c=
lass=3D"n">point</span><span class=3D"p">(</span><span class=3D"kt">double<=
/span> <span class=3D"n">t</span><span class=3D"p">)</span>
    <span class=3D"p">{</span>
        <span class=3D"k">return</span> <span class=3D"n">p</span> <span cl=
ass=3D"o">+</span> <span class=3D"n">v</span> <span class=3D"o">*</span> <s=
pan class=3D"n">t</span><span class=3D"p">;</span>
    <span class=3D"p">}</span>
    <span class=3D"kr">inline</span> <span class=3D"n">Line</span> <span cl=
ass=3D"n">move</span><span class=3D"p">(</span><span class=3D"kt">double</s=
pan> <span class=3D"n">d</span><span class=3D"p">)</span>
    <span class=3D"p">{</span>
        <span class=3D"k">return</span> <span class=3D"n">Line</span><span =
class=3D"p">(</span><span class=3D"n">p</span> <span class=3D"o">+</span> <=
span class=3D"n">Normal</span><span class=3D"p">(</span><span class=3D"n">v=
</span><span class=3D"p">)</span> <span class=3D"o">*</span> <span class=3D=
"n">d</span><span class=3D"p">,</span> <span class=3D"n">v</span><span clas=
s=3D"p">);</span>
    <span class=3D"p">}</span>
    <span class=3D"kr">inline</span> <span class=3D"kt">void</span> <span c=
lass=3D"n">read</span><span class=3D"p">()</span>
    <span class=3D"p">{</span>
        <span class=3D"n">Point</span> <span class=3D"n">q</span><span clas=
s=3D"p">;</span>
        <span class=3D"n">p</span><span class=3D"p">.</span><span class=3D"=
n">read</span><span class=3D"p">(),</span> <span class=3D"n">q</span><span =
class=3D"p">.</span><span class=3D"n">read</span><span class=3D"p">();</spa=
n>
        <span class=3D"n">v</span> <span class=3D"o">=3D</span> <span class=
=3D"n">q</span> <span class=3D"o">-</span> <span class=3D"n">p</span><span =
class=3D"p">;</span>
        <span class=3D"n">ang</span> <span class=3D"o">=3D</span> <span cla=
ss=3D"n">atan2</span><span class=3D"p">(</span><span class=3D"n">v</span><s=
pan class=3D"p">.</span><span class=3D"n">y</span><span class=3D"p">,</span=
> <span class=3D"n">v</span><span class=3D"p">.</span><span class=3D"n">x</=
span><span class=3D"p">);</span>
    <span class=3D"p">}</span>
<span class=3D"p">};</span>
<span class=3D"c1">//=E4=B8=A4=E7=9B=B4=E7=BA=BF=E4=BA=A4=E7=82=B9</span>
<span class=3D"kr">inline</span> <span class=3D"n">Point</span> <span class=
=3D"n">GetLineIntersection</span><span class=3D"p">(</span><span class=3D"n=
">Line</span> <span class=3D"n">a</span><span class=3D"p">,</span> <span cl=
ass=3D"n">Line</span> <span class=3D"n">b</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"k">return</span> <span class=3D"n">GetLineIntersection</=
span><span class=3D"p">(</span><span class=3D"n">a</span><span class=3D"p">=
.</span><span class=3D"n">p</span><span class=3D"p">,</span> <span class=3D=
"n">a</span><span class=3D"p">.</span><span class=3D"n">v</span><span class=
=3D"p">,</span> <span class=3D"n">b</span><span class=3D"p">.</span><span c=
lass=3D"n">p</span><span class=3D"p">,</span> <span class=3D"n">b</span><sp=
an class=3D"p">.</span><span class=3D"n">v</span><span class=3D"p">);</span=
>
<span class=3D"p">}</span>


<span class=3D"c1">// =E7=82=B9p=E5=9C=A8=E6=9C=89=E5=90=91=E7=9B=B4=E7=BA=
=BFL=E7=9A=84=E5=B7=A6=E8=BE=B9=EF=BC=88=E7=BA=BF=E4=B8=8A=E4=B8=8D=E7=AE=
=97=EF=BC=89</span>
<span class=3D"kr">inline</span> <span class=3D"kt">bool</span> <span class=
=3D"n">OnLeft</span><span class=3D"p">(</span><span class=3D"k">const</span=
> <span class=3D"n">Line</span><span class=3D"o">&amp;</span> <span class=
=3D"n">L</span><span class=3D"p">,</span> <span class=3D"k">const</span> <s=
pan class=3D"n">Point</span><span class=3D"o">&amp;</span> <span class=3D"n=
">p</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"k">return</span> <span class=3D"n">Cross</span><span cla=
ss=3D"p">(</span><span class=3D"n">L</span><span class=3D"p">.</span><span =
class=3D"n">v</span><span class=3D"p">,</span> <span class=3D"n">p</span> <=
span class=3D"o">-</span> <span class=3D"n">L</span><span class=3D"p">.</sp=
an><span class=3D"n">p</span><span class=3D"p">)</span> <span class=3D"o">&=
gt;</span> <span class=3D"mi">0</span><span class=3D"p">;</span>
<span class=3D"p">}</span>


<span class=3D"c1">//// =E4=BA=8C=E7=9B=B4=E7=BA=BF=E4=BA=A4=E7=82=B9=EF=BC=
=8C=E5=81=87=E5=AE=9A=E4=BA=A4=E7=82=B9=E6=83=9F=E4=B8=80=E5=AD=98=E5=9C=A8=
</span>
<span class=3D"c1">//Point GetLineIntersection(const Line&amp; a, const Lin=
e&amp; b) {</span>
<span class=3D"c1">//  Vector u =3D a.P-b.P;</span>
<span class=3D"c1">//  double t =3D Cross(b.v, u) / Cross(a.v, b.v);</span>
<span class=3D"c1">//  return a.P+a.v*t;</span>
<span class=3D"c1">//}</span>


<span class=3D"c1">// =E5=8D=8A=E5=B9=B3=E9=9D=A2=E4=BA=A4=E4=B8=BB=E8=BF=
=87=E7=A8=8B</span>
<span class=3D"n">vector</span><span class=3D"o">&lt;</span><span class=3D"=
n">Point</span><span class=3D"o">&gt;</span> <span class=3D"n">HalfplaneInt=
ersection</span><span class=3D"p">(</span><span class=3D"n">vector</span><s=
pan class=3D"o">&lt;</span><span class=3D"n">Line</span><span class=3D"o">&=
gt;</span> <span class=3D"n">L</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">int</span> <span class=3D"n">n</span> <span class=3D=
"o">=3D</span> <span class=3D"n">L</span><span class=3D"p">.</span><span cl=
ass=3D"n">size</span><span class=3D"p">();</span>
    <span class=3D"n">sort</span><span class=3D"p">(</span><span class=3D"n=
">L</span><span class=3D"p">.</span><span class=3D"n">begin</span><span cla=
ss=3D"p">(),</span> <span class=3D"n">L</span><span class=3D"p">.</span><sp=
an class=3D"n">end</span><span class=3D"p">());</span> <span class=3D"c1">/=
/ =E6=8C=89=E6=9E=81=E8=A7=92=E6=8E=92=E5=BA=8F</span>


    <span class=3D"kt">int</span> <span class=3D"n">first</span><span class=
=3D"p">,</span> <span class=3D"n">last</span><span class=3D"p">;</span>    =
     <span class=3D"c1">// =E5=8F=8C=E7=AB=AF=E9=98=9F=E5=88=97=E7=9A=84=E7=
=AC=AC=E4=B8=80=E4=B8=AA=E5=85=83=E7=B4=A0=E5=92=8C=E6=9C=80=E5=90=8E=E4=B8=
=80=E4=B8=AA=E5=85=83=E7=B4=A0=E7=9A=84=E4=B8=8B=E6=A0=87</span>
    <span class=3D"n">vector</span><span class=3D"o">&lt;</span><span class=
=3D"n">Point</span><span class=3D"o">&gt;</span> <span class=3D"n">p</span>=
<span class=3D"p">(</span><span class=3D"n">n</span><span class=3D"p">);</s=
pan>      <span class=3D"c1">// p[i]=E4=B8=BAq[i]=E5=92=8Cq[i+1]=E7=9A=84=
=E4=BA=A4=E7=82=B9</span>
    <span class=3D"n">vector</span><span class=3D"o">&lt;</span><span class=
=3D"n">Line</span><span class=3D"o">&gt;</span> <span class=3D"n">q</span><=
span class=3D"p">(</span><span class=3D"n">n</span><span class=3D"p">);</sp=
an>       <span class=3D"c1">// =E5=8F=8C=E7=AB=AF=E9=98=9F=E5=88=97</span>
    <span class=3D"n">vector</span><span class=3D"o">&lt;</span><span class=
=3D"n">Point</span><span class=3D"o">&gt;</span> <span class=3D"n">ans</spa=
n><span class=3D"p">;</span>       <span class=3D"c1">// =E7=BB=93=E6=9E=9C=
</span>


    <span class=3D"n">q</span><span class=3D"p">[</span><span class=3D"n">f=
irst</span><span class=3D"o">=3D</span><span class=3D"n">last</span><span c=
lass=3D"o">=3D</span><span class=3D"mi">0</span><span class=3D"p">]</span> =
<span class=3D"o">=3D</span> <span class=3D"n">L</span><span class=3D"p">[<=
/span><span class=3D"mi">0</span><span class=3D"p">];</span>  <span class=
=3D"c1">// =E5=8F=8C=E7=AB=AF=E9=98=9F=E5=88=97=E5=88=9D=E5=A7=8B=E5=8C=96=
=E4=B8=BA=E5=8F=AA=E6=9C=89=E4=B8=80=E4=B8=AA=E5=8D=8A=E5=B9=B3=E9=9D=A2L[0=
]</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span> <span class=3D"o">=3D</span> <span =
class=3D"mi">1</span><span class=3D"p">;</span> <span class=3D"n">i</span> =
<span class=3D"o">&lt;</span> <span class=3D"n">n</span><span class=3D"p">;=
</span> <span class=3D"n">i</span><span class=3D"o">++</span><span class=3D=
"p">)</span>
    <span class=3D"p">{</span>
        <span class=3D"k">while</span><span class=3D"p">(</span><span class=
=3D"n">first</span> <span class=3D"o">&lt;</span> <span class=3D"n">last</s=
pan> <span class=3D"o">&amp;&amp;</span> <span class=3D"o">!</span><span cl=
ass=3D"n">OnLeft</span><span class=3D"p">(</span><span class=3D"n">L</span>=
<span class=3D"p">[</span><span class=3D"n">i</span><span class=3D"p">],</s=
pan> <span class=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">=
last</span><span class=3D"o">-</span><span class=3D"mi">1</span><span class=
=3D"p">]))</span> <span class=3D"n">last</span><span class=3D"o">--</span><=
span class=3D"p">;</span>
        <span class=3D"k">while</span><span class=3D"p">(</span><span class=
=3D"n">first</span> <span class=3D"o">&lt;</span> <span class=3D"n">last</s=
pan> <span class=3D"o">&amp;&amp;</span> <span class=3D"o">!</span><span cl=
ass=3D"n">OnLeft</span><span class=3D"p">(</span><span class=3D"n">L</span>=
<span class=3D"p">[</span><span class=3D"n">i</span><span class=3D"p">],</s=
pan> <span class=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">=
first</span><span class=3D"p">]))</span> <span class=3D"n">first</span><spa=
n class=3D"o">++</span><span class=3D"p">;</span>
        <span class=3D"n">q</span><span class=3D"p">[</span><span class=3D"=
o">++</span><span class=3D"n">last</span><span class=3D"p">]</span> <span c=
lass=3D"o">=3D</span> <span class=3D"n">L</span><span class=3D"p">[</span><=
span class=3D"n">i</span><span class=3D"p">];</span>
        <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D=
"n">fabs</span><span class=3D"p">(</span><span class=3D"n">Cross</span><spa=
n class=3D"p">(</span><span class=3D"n">q</span><span class=3D"p">[</span><=
span class=3D"n">last</span><span class=3D"p">].</span><span class=3D"n">v<=
/span><span class=3D"p">,</span> <span class=3D"n">q</span><span class=3D"p=
">[</span><span class=3D"n">last</span><span class=3D"o">-</span><span clas=
s=3D"mi">1</span><span class=3D"p">].</span><span class=3D"n">v</span><span=
 class=3D"p">))</span> <span class=3D"o">&lt;</span> <span class=3D"n">eps<=
/span><span class=3D"p">)</span>   <span class=3D"c1">// =E4=B8=A4=E5=90=91=
=E9=87=8F=E5=B9=B3=E8=A1=8C=E4=B8=94=E5=90=8C=E5=90=91=EF=BC=8C=E5=8F=96=E5=
=86=85=E4=BE=A7=E7=9A=84=E4=B8=80=E4=B8=AA</span>
        <span class=3D"p">{</span>
            <span class=3D"n">last</span><span class=3D"o">--</span><span c=
lass=3D"p">;</span>
            <span class=3D"k">if</span><span class=3D"p">(</span><span clas=
s=3D"n">OnLeft</span><span class=3D"p">(</span><span class=3D"n">q</span><s=
pan class=3D"p">[</span><span class=3D"n">last</span><span class=3D"p">],</=
span> <span class=3D"n">L</span><span class=3D"p">[</span><span class=3D"n"=
>i</span><span class=3D"p">].</span><span class=3D"n">p</span><span class=
=3D"p">))</span> <span class=3D"n">q</span><span class=3D"p">[</span><span =
class=3D"n">last</span><span class=3D"p">]</span> <span class=3D"o">=3D</sp=
an> <span class=3D"n">L</span><span class=3D"p">[</span><span class=3D"n">i=
</span><span class=3D"p">];</span>
        <span class=3D"p">}</span>
        <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D=
"n">first</span> <span class=3D"o">&lt;</span> <span class=3D"n">last</span=
><span class=3D"p">)</span> <span class=3D"n">p</span><span class=3D"p">[</=
span><span class=3D"n">last</span><span class=3D"o">-</span><span class=3D"=
mi">1</span><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span c=
lass=3D"n">GetLineIntersection</span><span class=3D"p">(</span><span class=
=3D"n">q</span><span class=3D"p">[</span><span class=3D"n">last</span><span=
 class=3D"o">-</span><span class=3D"mi">1</span><span class=3D"p">],</span>=
 <span class=3D"n">q</span><span class=3D"p">[</span><span class=3D"n">last=
</span><span class=3D"p">]);</span>
    <span class=3D"p">}</span>
    <span class=3D"k">while</span><span class=3D"p">(</span><span class=3D"=
n">first</span> <span class=3D"o">&lt;</span> <span class=3D"n">last</span>=
 <span class=3D"o">&amp;&amp;</span> <span class=3D"o">!</span><span class=
=3D"n">OnLeft</span><span class=3D"p">(</span><span class=3D"n">q</span><sp=
an class=3D"p">[</span><span class=3D"n">first</span><span class=3D"p">],</=
span> <span class=3D"n">p</span><span class=3D"p">[</span><span class=3D"n"=
>last</span><span class=3D"o">-</span><span class=3D"mi">1</span><span clas=
s=3D"p">]))</span> <span class=3D"n">last</span><span class=3D"o">--</span>=
<span class=3D"p">;</span> <span class=3D"c1">// =E5=88=A0=E9=99=A4=E6=97=
=A0=E7=94=A8=E5=B9=B3=E9=9D=A2</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
last</span> <span class=3D"o">-</span> <span class=3D"n">first</span> <span=
 class=3D"o">&lt;=3D</span> <span class=3D"mi">1</span><span class=3D"p">)<=
/span> <span class=3D"k">return</span> <span class=3D"n">ans</span><span cl=
ass=3D"p">;</span> <span class=3D"c1">// =E7=A9=BA=E9=9B=86</span>
    <span class=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">l=
ast</span><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span cla=
ss=3D"n">GetLineIntersection</span><span class=3D"p">(</span><span class=3D=
"n">q</span><span class=3D"p">[</span><span class=3D"n">last</span><span cl=
ass=3D"p">],</span> <span class=3D"n">q</span><span class=3D"p">[</span><sp=
an class=3D"n">first</span><span class=3D"p">]);</span> <span class=3D"c1">=
// =E8=AE=A1=E7=AE=97=E9=A6=96=E5=B0=BE=E4=B8=A4=E4=B8=AA=E5=8D=8A=E5=B9=B3=
=E9=9D=A2=E7=9A=84=E4=BA=A4=E7=82=B9</span>


    <span class=3D"c1">// =E4=BB=8Edeque=E5=A4=8D=E5=88=B6=E5=88=B0=E8=BE=
=93=E5=87=BA=E4=B8=AD</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span> <span class=3D"o">=3D</span> <span =
class=3D"n">first</span><span class=3D"p">;</span> <span class=3D"n">i</spa=
n> <span class=3D"o">&lt;=3D</span> <span class=3D"n">last</span><span clas=
s=3D"p">;</span> <span class=3D"n">i</span><span class=3D"o">++</span><span=
 class=3D"p">)</span> <span class=3D"n">ans</span><span class=3D"p">.</span=
><span class=3D"n">push_back</span><span class=3D"p">(</span><span class=3D=
"n">p</span><span class=3D"p">[</span><span class=3D"n">i</span><span class=
=3D"p">]);</span>
    <span class=3D"k">return</span> <span class=3D"n">ans</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>


<span class=3D"cm">/***********=E5=A4=9A=E8=BE=B9=E5=BD=A2**************/</=
span>
<span class=3D"kt">double</span> <span class=3D"n">PolygonArea</span><span =
class=3D"p">(</span><span class=3D"n">vector</span><span class=3D"o">&lt;</=
span><span class=3D"n">Point</span><span class=3D"o">&gt;</span> <span clas=
s=3D"n">p</span><span class=3D"p">)</span> <span class=3D"p">{</span>
  <span class=3D"kt">int</span> <span class=3D"n">n</span> <span class=3D"o=
">=3D</span> <span class=3D"n">p</span><span class=3D"p">.</span><span clas=
s=3D"n">size</span><span class=3D"p">();</span>
  <span class=3D"kt">double</span> <span class=3D"n">area</span> <span clas=
s=3D"o">=3D</span> <span class=3D"mi">0</span><span class=3D"p">;</span>
  <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt">=
int</span> <span class=3D"n">i</span> <span class=3D"o">=3D</span> <span cl=
ass=3D"mi">1</span><span class=3D"p">;</span> <span class=3D"n">i</span> <s=
pan class=3D"o">&lt;</span> <span class=3D"n">n</span> <span class=3D"o">-<=
/span> <span class=3D"mi">1</span><span class=3D"p">;</span> <span class=3D=
"n">i</span><span class=3D"o">++</span><span class=3D"p">)</span>
    <span class=3D"n">area</span> <span class=3D"o">+=3D</span> <span class=
=3D"n">Cross</span><span class=3D"p">(</span><span class=3D"n">p</span><spa=
n class=3D"p">[</span><span class=3D"n">i</span><span class=3D"p">]</span><=
span class=3D"o">-</span><span class=3D"n">p</span><span class=3D"p">[</spa=
n><span class=3D"mi">0</span><span class=3D"p">],</span> <span class=3D"n">=
p</span><span class=3D"p">[</span><span class=3D"n">i</span><span class=3D"=
o">+</span><span class=3D"mi">1</span><span class=3D"p">]</span><span class=
=3D"o">-</span><span class=3D"n">p</span><span class=3D"p">[</span><span cl=
ass=3D"mi">0</span><span class=3D"p">]);</span>
  <span class=3D"k">return</span> <span class=3D"n">area</span> <span class=
=3D"o">/</span> <span class=3D"mi">2</span><span class=3D"p">;</span>
<span class=3D"p">}</span>

<span class=3D"c1">//=E5=88=A4=E6=96=AD=E7=82=B9=E6=98=AF=E5=90=A6=E5=9C=A8=
=E5=A4=9A=E8=BE=B9=E5=BD=A2=E5=86=85</span>
<span class=3D"kt">int</span> <span class=3D"n">isPointInPolygon</span><spa=
n class=3D"p">(</span><span class=3D"n">Point</span> <span class=3D"n">p</s=
pan><span class=3D"p">,</span> <span class=3D"n">Polygon</span> <span class=
=3D"n">poly</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">int</span> <span class=3D"n">wn</span> <span class=
=3D"o">=3D</span> <span class=3D"mi">0</span><span class=3D"p">;</span>
    <span class=3D"kt">int</span> <span class=3D"n">n</span> <span class=3D=
"o">=3D</span> <span class=3D"n">poly</span><span class=3D"p">.</span><span=
 class=3D"n">size</span><span class=3D"p">();</span>
    <span class=3D"k">for</span> <span class=3D"p">(</span><span class=3D"k=
t">int</span> <span class=3D"n">i</span> <span class=3D"o">=3D</span> <span=
 class=3D"mi">0</span><span class=3D"p">;</span> <span class=3D"n">i</span>=
 <span class=3D"o">&lt;</span> <span class=3D"n">n</span><span class=3D"p">=
;</span> <span class=3D"n">i</span><span class=3D"o">++</span><span class=
=3D"p">)</span>
    <span class=3D"p">{</span>
        <span class=3D"k">if</span> <span class=3D"p">(</span><span class=
=3D"n">OnSegment</span><span class=3D"p">(</span><span class=3D"n">p</span>=
<span class=3D"p">,</span> <span class=3D"n">poly</span><span class=3D"p">[=
</span><span class=3D"n">i</span><span class=3D"p">],</span> <span class=3D=
"n">poly</span><span class=3D"p">[(</span><span class=3D"n">i</span> <span =
class=3D"o">+</span> <span class=3D"mi">1</span><span class=3D"p">)</span> =
<span class=3D"o">%</span> <span class=3D"n">n</span><span class=3D"p">]))<=
/span> <span class=3D"k">return</span> <span class=3D"o">-</span><span clas=
s=3D"mi">1</span><span class=3D"p">;</span>    <span class=3D"c1">//=E8=BE=
=B9=E7=95=8C</span>
        <span class=3D"kt">int</span> <span class=3D"n">k</span> <span clas=
s=3D"o">=3D</span> <span class=3D"n">dcmp</span><span class=3D"p">(</span><=
span class=3D"n">Cross</span><span class=3D"p">(</span><span class=3D"n">po=
ly</span><span class=3D"p">[(</span><span class=3D"n">i</span> <span class=
=3D"o">+</span> <span class=3D"mi">1</span><span class=3D"p">)</span> <span=
 class=3D"o">%</span> <span class=3D"n">n</span><span class=3D"p">]</span> =
<span class=3D"o">-</span> <span class=3D"n">poly</span><span class=3D"p">[=
</span><span class=3D"n">i</span><span class=3D"p">],</span> <span class=3D=
"n">p</span> <span class=3D"o">-</span> <span class=3D"n">poly</span><span =
class=3D"p">[</span><span class=3D"n">i</span><span class=3D"p">]));</span>
        <span class=3D"kt">int</span> <span class=3D"n">d1</span> <span cla=
ss=3D"o">=3D</span> <span class=3D"n">dcmp</span><span class=3D"p">(</span>=
<span class=3D"n">poly</span><span class=3D"p">[</span><span class=3D"n">i<=
/span><span class=3D"p">].</span><span class=3D"n">y</span> <span class=3D"=
o">-</span> <span class=3D"n">p</span><span class=3D"p">.</span><span class=
=3D"n">y</span><span class=3D"p">);</span>
        <span class=3D"kt">int</span> <span class=3D"n">d2</span> <span cla=
ss=3D"o">=3D</span> <span class=3D"n">dcmp</span><span class=3D"p">(</span>=
<span class=3D"n">poly</span><span class=3D"p">[(</span><span class=3D"n">i=
</span> <span class=3D"o">+</span> <span class=3D"mi">1</span><span class=
=3D"p">)</span> <span class=3D"o">%</span> <span class=3D"n">n</span><span =
class=3D"p">].</span><span class=3D"n">y</span> <span class=3D"o">-</span> =
<span class=3D"n">p</span><span class=3D"p">.</span><span class=3D"n">y</sp=
an><span class=3D"p">);</span>
        <span class=3D"k">if</span> <span class=3D"p">(</span><span class=
=3D"n">k</span> <span class=3D"o">&gt;</span> <span class=3D"mi">0</span> <=
span class=3D"o">&amp;&amp;</span> <span class=3D"n">d1</span> <span class=
=3D"o">&lt;=3D</span> <span class=3D"mi">0</span> <span class=3D"o">&amp;&a=
mp;</span> <span class=3D"n">d2</span> <span class=3D"o">&gt;</span> <span =
class=3D"mi">0</span><span class=3D"p">)</span> <span class=3D"n">wn</span>=
<span class=3D"o">++</span><span class=3D"p">;</span>
        <span class=3D"k">if</span> <span class=3D"p">(</span><span class=
=3D"n">k</span> <span class=3D"o">&lt;</span> <span class=3D"mi">0</span> <=
span class=3D"o">&amp;&amp;</span> <span class=3D"n">d2</span> <span class=
=3D"o">&lt;=3D</span> <span class=3D"mi">0</span> <span class=3D"o">&amp;&a=
mp;</span> <span class=3D"n">d1</span> <span class=3D"o">&gt;</span> <span =
class=3D"mi">0</span><span class=3D"p">)</span> <span class=3D"n">wn</span>=
<span class=3D"o">--</span><span class=3D"p">;</span>
    <span class=3D"p">}</span>
    <span class=3D"k">if</span> <span class=3D"p">(</span><span class=3D"n"=
>wn</span> <span class=3D"o">!=3D</span> <span class=3D"mi">0</span><span c=
lass=3D"p">)</span> <span class=3D"k">return</span> <span class=3D"mi">1</s=
pan><span class=3D"p">;</span>  <span class=3D"c1">//=E5=86=85=E9=83=A8</sp=
an>
    <span class=3D"k">return</span> <span class=3D"mi">0</span><span class=
=3D"p">;</span>   <span class=3D"c1">//=E5=A4=96=E9=83=A8</span>
<span class=3D"p">}</span>


<span class=3D"c1">//=E5=A4=9A=E8=BE=B9=E5=BD=A2=E9=87=8D=E5=BF=83 =E7=82=
=B9=E9=9B=86=E9=80=86=E6=97=B6=E9=92=88=E7=BB=99=E5=87=BA</span>
<span class=3D"n">Point</span> <span class=3D"n">PolyGravity</span><span cl=
ass=3D"p">(</span><span class=3D"n">Point</span> <span class=3D"o">*</span>=
<span class=3D"n">p</span><span class=3D"p">,</span> <span class=3D"kt">int=
</span> <span class=3D"n">n</span><span class=3D"p">)</span> <span class=3D=
"p">{</span>
    <span class=3D"n">Point</span> <span class=3D"n">tmp</span><span class=
=3D"p">,</span> <span class=3D"n">g</span> <span class=3D"o">=3D</span> <sp=
an class=3D"n">Point</span><span class=3D"p">(</span><span class=3D"mi">0</=
span><span class=3D"p">,</span> <span class=3D"mi">0</span><span class=3D"p=
">);</span>
    <span class=3D"kt">double</span> <span class=3D"n">sumArea</span> <span=
 class=3D"o">=3D</span> <span class=3D"mi">0</span><span class=3D"p">,</spa=
n> <span class=3D"n">area</span><span class=3D"p">;</span>
    <span class=3D"k">for</span> <span class=3D"p">(</span><span class=3D"k=
t">int</span> <span class=3D"n">i</span><span class=3D"o">=3D</span><span c=
lass=3D"mi">2</span><span class=3D"p">;</span> <span class=3D"n">i</span><s=
pan class=3D"o">&lt;</span><span class=3D"n">n</span><span class=3D"p">;</s=
pan> <span class=3D"o">++</span><span class=3D"n">i</span><span class=3D"p"=
>)</span> <span class=3D"p">{</span>
        <span class=3D"n">area</span> <span class=3D"o">=3D</span> <span cl=
ass=3D"n">Cross</span><span class=3D"p">(</span><span class=3D"n">p</span><=
span class=3D"p">[</span><span class=3D"n">i</span><span class=3D"o">-</spa=
n><span class=3D"mi">1</span><span class=3D"p">]</span><span class=3D"o">-<=
/span><span class=3D"n">p</span><span class=3D"p">[</span><span class=3D"mi=
">0</span><span class=3D"p">],</span> <span class=3D"n">p</span><span class=
=3D"p">[</span><span class=3D"n">i</span><span class=3D"p">]</span><span cl=
ass=3D"o">-</span><span class=3D"n">p</span><span class=3D"p">[</span><span=
 class=3D"mi">0</span><span class=3D"p">]);</span>
        <span class=3D"n">sumArea</span> <span class=3D"o">+=3D</span> <spa=
n class=3D"n">area</span><span class=3D"p">;</span>
        <span class=3D"n">tmp</span><span class=3D"p">.</span><span class=
=3D"n">x</span> <span class=3D"o">=3D</span> <span class=3D"n">p</span><spa=
n class=3D"p">[</span><span class=3D"mi">0</span><span class=3D"p">].</span=
><span class=3D"n">x</span> <span class=3D"o">+</span> <span class=3D"n">p<=
/span><span class=3D"p">[</span><span class=3D"n">i</span><span class=3D"o"=
>-</span><span class=3D"mi">1</span><span class=3D"p">].</span><span class=
=3D"n">x</span> <span class=3D"o">+</span> <span class=3D"n">p</span><span =
class=3D"p">[</span><span class=3D"n">i</span><span class=3D"p">].</span><s=
pan class=3D"n">x</span><span class=3D"p">;</span>
        <span class=3D"n">tmp</span><span class=3D"p">.</span><span class=
=3D"n">y</span> <span class=3D"o">=3D</span> <span class=3D"n">p</span><spa=
n class=3D"p">[</span><span class=3D"mi">0</span><span class=3D"p">].</span=
><span class=3D"n">y</span> <span class=3D"o">+</span> <span class=3D"n">p<=
/span><span class=3D"p">[</span><span class=3D"n">i</span><span class=3D"o"=
>-</span><span class=3D"mi">1</span><span class=3D"p">].</span><span class=
=3D"n">y</span> <span class=3D"o">+</span> <span class=3D"n">p</span><span =
class=3D"p">[</span><span class=3D"n">i</span><span class=3D"p">].</span><s=
pan class=3D"n">y</span><span class=3D"p">;</span>
        <span class=3D"n">g</span><span class=3D"p">.</span><span class=3D"=
n">x</span> <span class=3D"o">+=3D</span> <span class=3D"n">tmp</span><span=
 class=3D"p">.</span><span class=3D"n">x</span> <span class=3D"o">*</span> =
<span class=3D"n">area</span><span class=3D"p">;</span>
        <span class=3D"n">g</span><span class=3D"p">.</span><span class=3D"=
n">y</span> <span class=3D"o">+=3D</span> <span class=3D"n">tmp</span><span=
 class=3D"p">.</span><span class=3D"n">y</span> <span class=3D"o">*</span> =
<span class=3D"n">area</span><span class=3D"p">;</span>
    <span class=3D"p">}</span>
    <span class=3D"n">g</span><span class=3D"p">.</span><span class=3D"n">x=
</span> <span class=3D"o">/=3D</span> <span class=3D"p">(</span><span class=
=3D"n">sumArea</span> <span class=3D"o">*</span> <span class=3D"mf">3.0</sp=
an><span class=3D"p">);</span> <span class=3D"n">g</span><span class=3D"p">=
.</span><span class=3D"n">y</span> <span class=3D"o">/=3D</span> <span clas=
s=3D"p">(</span><span class=3D"n">sumArea</span> <span class=3D"o">*</span>=
 <span class=3D"mf">3.0</span><span class=3D"p">);</span>
    <span class=3D"k">return</span> <span class=3D"n">g</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>


<span class=3D"c1">//=E5=A4=9A=E8=BE=B9=E5=BD=A2=E9=87=8D=E5=BF=83=E8=AE=A1=
=E7=AE=97=E6=A8=A1=E6=9D=BF</span>
<span class=3D"n">Point</span> <span class=3D"n">bcenter</span><span class=
=3D"p">(</span><span class=3D"n">vector</span><span class=3D"o">&lt;</span>=
<span class=3D"n">Point</span><span class=3D"o">&gt;</span> <span class=3D"=
n">pnt</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">int</span> <span class=3D"n">n</span> <span class=3D=
"o">=3D</span> <span class=3D"n">pnt</span><span class=3D"p">.</span><span =
class=3D"n">size</span><span class=3D"p">();</span>
    <span class=3D"n">Point</span> <span class=3D"n">p</span><span class=3D=
"p">,</span> <span class=3D"n">s</span><span class=3D"p">;</span>
    <span class=3D"kt">double</span> <span class=3D"n">tp</span><span class=
=3D"p">,</span> <span class=3D"n">area</span> <span class=3D"o">=3D</span> =
<span class=3D"mi">0</span><span class=3D"p">,</span> <span class=3D"n">tpx=
</span> <span class=3D"o">=3D</span> <span class=3D"mi">0</span><span class=
=3D"p">,</span> <span class=3D"n">tpy</span> <span class=3D"o">=3D</span> <=
span class=3D"mi">0</span><span class=3D"p">;</span>
    <span class=3D"n">p</span><span class=3D"p">.</span><span class=3D"n">x=
</span> <span class=3D"o">=3D</span> <span class=3D"n">pnt</span><span clas=
s=3D"p">[</span><span class=3D"mi">0</span><span class=3D"p">].</span><span=
 class=3D"n">x</span><span class=3D"p">;</span>
    <span class=3D"n">p</span><span class=3D"p">.</span><span class=3D"n">y=
</span> <span class=3D"o">=3D</span> <span class=3D"n">pnt</span><span clas=
s=3D"p">[</span><span class=3D"mi">0</span><span class=3D"p">].</span><span=
 class=3D"n">y</span><span class=3D"p">;</span>
    <span class=3D"c1">//FE(i, 1, n)</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span><span class=3D"o">=3D</span><span cl=
ass=3D"mi">1</span><span class=3D"p">;</span><span class=3D"n">i</span><spa=
n class=3D"o">&lt;=3D</span><span class=3D"n">n</span><span class=3D"p">;</=
span><span class=3D"n">i</span><span class=3D"o">++</span><span class=3D"p"=
>)</span>
    <span class=3D"p">{</span>
        <span class=3D"n">s</span><span class=3D"p">.</span><span class=3D"=
n">x</span> <span class=3D"o">=3D</span> <span class=3D"n">pnt</span><span =
class=3D"p">[(</span><span class=3D"n">i</span> <span class=3D"o">=3D=3D</s=
pan> <span class=3D"n">n</span><span class=3D"p">)</span> <span class=3D"o"=
>?</span> <span class=3D"mi">0</span> <span class=3D"o">:</span> <span clas=
s=3D"n">i</span><span class=3D"p">].</span><span class=3D"n">x</span><span =
class=3D"p">;</span>
        <span class=3D"n">s</span><span class=3D"p">.</span><span class=3D"=
n">y</span> <span class=3D"o">=3D</span> <span class=3D"n">pnt</span><span =
class=3D"p">[(</span><span class=3D"n">i</span> <span class=3D"o">=3D=3D</s=
pan> <span class=3D"n">n</span><span class=3D"p">)</span> <span class=3D"o"=
>?</span> <span class=3D"mi">0</span> <span class=3D"o">:</span> <span clas=
s=3D"n">i</span><span class=3D"p">].</span><span class=3D"n">y</span><span =
class=3D"p">;</span>
        <span class=3D"n">tp</span> <span class=3D"o">=3D</span> <span clas=
s=3D"p">(</span><span class=3D"n">p</span><span class=3D"p">.</span><span c=
lass=3D"n">x</span> <span class=3D"o">*</span> <span class=3D"n">s</span><s=
pan class=3D"p">.</span><span class=3D"n">y</span> <span class=3D"o">-</spa=
n> <span class=3D"n">s</span><span class=3D"p">.</span><span class=3D"n">x<=
/span> <span class=3D"o">*</span> <span class=3D"n">p</span><span class=3D"=
p">.</span><span class=3D"n">y</span><span class=3D"p">);</span>
        <span class=3D"n">area</span> <span class=3D"o">+=3D</span> <span c=
lass=3D"n">tp</span> <span class=3D"o">/</span> <span class=3D"mi">2</span>=
<span class=3D"p">;</span>
        <span class=3D"n">tpx</span> <span class=3D"o">+=3D</span> <span cl=
ass=3D"p">(</span><span class=3D"n">p</span><span class=3D"p">.</span><span=
 class=3D"n">x</span> <span class=3D"o">+</span> <span class=3D"n">s</span>=
<span class=3D"p">.</span><span class=3D"n">x</span><span class=3D"p">)</sp=
an> <span class=3D"o">*</span> <span class=3D"n">tp</span><span class=3D"p"=
>;</span>
        <span class=3D"n">tpy</span> <span class=3D"o">+=3D</span> <span cl=
ass=3D"p">(</span><span class=3D"n">p</span><span class=3D"p">.</span><span=
 class=3D"n">y</span> <span class=3D"o">+</span> <span class=3D"n">s</span>=
<span class=3D"p">.</span><span class=3D"n">y</span><span class=3D"p">)</sp=
an> <span class=3D"o">*</span> <span class=3D"n">tp</span><span class=3D"p"=
>;</span>
        <span class=3D"n">p</span><span class=3D"p">.</span><span class=3D"=
n">x</span> <span class=3D"o">=3D</span> <span class=3D"n">s</span><span cl=
ass=3D"p">.</span><span class=3D"n">x</span><span class=3D"p">;</span>
        <span class=3D"n">p</span><span class=3D"p">.</span><span class=3D"=
n">y</span> <span class=3D"o">=3D</span> <span class=3D"n">s</span><span cl=
ass=3D"p">.</span><span class=3D"n">y</span><span class=3D"p">;</span>
    <span class=3D"p">}</span>
    <span class=3D"n">s</span><span class=3D"p">.</span><span class=3D"n">x=
</span> <span class=3D"o">=3D</span> <span class=3D"n">tpx</span> <span cla=
ss=3D"o">/</span> <span class=3D"p">(</span><span class=3D"mi">6</span> <sp=
an class=3D"o">*</span> <span class=3D"n">area</span><span class=3D"p">);</=
span>
    <span class=3D"n">s</span><span class=3D"p">.</span><span class=3D"n">y=
</span> <span class=3D"o">=3D</span> <span class=3D"n">tpy</span> <span cla=
ss=3D"o">/</span> <span class=3D"p">(</span><span class=3D"mi">6</span> <sp=
an class=3D"o">*</span> <span class=3D"n">area</span><span class=3D"p">);</=
span>
    <span class=3D"k">return</span> <span class=3D"n">s</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>

<span class=3D"c1">// =E7=82=B9=E9=9B=86=E5=87=B8=E5=8C=85</span>
<span class=3D"c1">// =E5=A6=82=E6=9E=9C=E5=B8=8C=E6=9C=9B=E5=9C=A8=E5=87=
=B8=E5=8C=85=E7=9A=84=E8=BE=B9=E4=B8=8A=E6=9C=89=E8=BE=93=E5=85=A5=E7=82=B9=
=EF=BC=8C=E6=8A=8A=E4=B8=A4=E4=B8=AA &lt;=3D =E6=94=B9=E6=88=90 &lt;</span>
<span class=3D"c1">// =E6=B3=A8=E6=84=8F=EF=BC=9A=E8=BE=93=E5=85=A5=E7=82=
=B9=E9=9B=86=E4=BC=9A=E8=A2=AB=E4=BF=AE=E6=94=B9</span>
<span class=3D"n">vector</span><span class=3D"o">&lt;</span><span class=3D"=
n">Point</span><span class=3D"o">&gt;</span> <span class=3D"n">ConvexHull</=
span><span class=3D"p">(</span><span class=3D"n">vector</span><span class=
=3D"o">&lt;</span><span class=3D"n">Point</span><span class=3D"o">&gt;&amp;=
</span> <span class=3D"n">p</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"c1">// =E9=A2=84=E5=A4=84=E7=90=86=EF=BC=8C=E5=88=A0=E9=
=99=A4=E9=87=8D=E5=A4=8D=E7=82=B9</span>
    <span class=3D"n">sort</span><span class=3D"p">(</span><span class=3D"n=
">p</span><span class=3D"p">.</span><span class=3D"n">begin</span><span cla=
ss=3D"p">(),</span> <span class=3D"n">p</span><span class=3D"p">.</span><sp=
an class=3D"n">end</span><span class=3D"p">());</span>
    <span class=3D"n">p</span><span class=3D"p">.</span><span class=3D"n">e=
rase</span><span class=3D"p">(</span><span class=3D"n">unique</span><span c=
lass=3D"p">(</span><span class=3D"n">p</span><span class=3D"p">.</span><spa=
n class=3D"n">begin</span><span class=3D"p">(),</span> <span class=3D"n">p<=
/span><span class=3D"p">.</span><span class=3D"n">end</span><span class=3D"=
p">()),</span> <span class=3D"n">p</span><span class=3D"p">.</span><span cl=
ass=3D"n">end</span><span class=3D"p">());</span>


    <span class=3D"kt">int</span> <span class=3D"n">n</span> <span class=3D=
"o">=3D</span> <span class=3D"n">p</span><span class=3D"p">.</span><span cl=
ass=3D"n">size</span><span class=3D"p">();</span>
    <span class=3D"kt">int</span> <span class=3D"n">m</span> <span class=3D=
"o">=3D</span> <span class=3D"mi">0</span><span class=3D"p">;</span>
    <span class=3D"n">vector</span><span class=3D"o">&lt;</span><span class=
=3D"n">Point</span><span class=3D"o">&gt;</span> <span class=3D"n">ch</span=
><span class=3D"p">(</span><span class=3D"n">n</span><span class=3D"o">+</s=
pan><span class=3D"mi">1</span><span class=3D"p">);</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span> <span class=3D"o">=3D</span> <span =
class=3D"mi">0</span><span class=3D"p">;</span> <span class=3D"n">i</span> =
<span class=3D"o">&lt;</span> <span class=3D"n">n</span><span class=3D"p">;=
</span> <span class=3D"n">i</span><span class=3D"o">++</span><span class=3D=
"p">)</span>
    <span class=3D"p">{</span>
        <span class=3D"k">while</span><span class=3D"p">(</span><span class=
=3D"n">m</span> <span class=3D"o">&gt;</span> <span class=3D"mi">1</span> <=
span class=3D"o">&amp;&amp;</span> <span class=3D"n">Cross</span><span clas=
s=3D"p">(</span><span class=3D"n">ch</span><span class=3D"p">[</span><span =
class=3D"n">m</span><span class=3D"o">-</span><span class=3D"mi">1</span><s=
pan class=3D"p">]</span><span class=3D"o">-</span><span class=3D"n">ch</spa=
n><span class=3D"p">[</span><span class=3D"n">m</span><span class=3D"o">-</=
span><span class=3D"mi">2</span><span class=3D"p">],</span> <span class=3D"=
n">p</span><span class=3D"p">[</span><span class=3D"n">i</span><span class=
=3D"p">]</span><span class=3D"o">-</span><span class=3D"n">ch</span><span c=
lass=3D"p">[</span><span class=3D"n">m</span><span class=3D"o">-</span><spa=
n class=3D"mi">2</span><span class=3D"p">])</span> <span class=3D"o">&lt;=
=3D</span> <span class=3D"mi">0</span><span class=3D"p">)</span> <span clas=
s=3D"n">m</span><span class=3D"o">--</span><span class=3D"p">;</span>
        <span class=3D"n">ch</span><span class=3D"p">[</span><span class=3D=
"n">m</span><span class=3D"o">++</span><span class=3D"p">]</span> <span cla=
ss=3D"o">=3D</span> <span class=3D"n">p</span><span class=3D"p">[</span><sp=
an class=3D"n">i</span><span class=3D"p">];</span>
    <span class=3D"p">}</span>
    <span class=3D"kt">int</span> <span class=3D"n">k</span> <span class=3D=
"o">=3D</span> <span class=3D"n">m</span><span class=3D"p">;</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span> <span class=3D"o">=3D</span> <span =
class=3D"n">n</span><span class=3D"o">-</span><span class=3D"mi">2</span><s=
pan class=3D"p">;</span> <span class=3D"n">i</span> <span class=3D"o">&gt;=
=3D</span> <span class=3D"mi">0</span><span class=3D"p">;</span> <span clas=
s=3D"n">i</span><span class=3D"o">--</span><span class=3D"p">)</span>
    <span class=3D"p">{</span>
        <span class=3D"k">while</span><span class=3D"p">(</span><span class=
=3D"n">m</span> <span class=3D"o">&gt;</span> <span class=3D"n">k</span> <s=
pan class=3D"o">&amp;&amp;</span> <span class=3D"n">Cross</span><span class=
=3D"p">(</span><span class=3D"n">ch</span><span class=3D"p">[</span><span c=
lass=3D"n">m</span><span class=3D"o">-</span><span class=3D"mi">1</span><sp=
an class=3D"p">]</span><span class=3D"o">-</span><span class=3D"n">ch</span=
><span class=3D"p">[</span><span class=3D"n">m</span><span class=3D"o">-</s=
pan><span class=3D"mi">2</span><span class=3D"p">],</span> <span class=3D"n=
">p</span><span class=3D"p">[</span><span class=3D"n">i</span><span class=
=3D"p">]</span><span class=3D"o">-</span><span class=3D"n">ch</span><span c=
lass=3D"p">[</span><span class=3D"n">m</span><span class=3D"o">-</span><spa=
n class=3D"mi">2</span><span class=3D"p">])</span> <span class=3D"o">&lt;=
=3D</span> <span class=3D"mi">0</span><span class=3D"p">)</span> <span clas=
s=3D"n">m</span><span class=3D"o">--</span><span class=3D"p">;</span>
        <span class=3D"n">ch</span><span class=3D"p">[</span><span class=3D=
"n">m</span><span class=3D"o">++</span><span class=3D"p">]</span> <span cla=
ss=3D"o">=3D</span> <span class=3D"n">p</span><span class=3D"p">[</span><sp=
an class=3D"n">i</span><span class=3D"p">];</span>
    <span class=3D"p">}</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
n</span> <span class=3D"o">&gt;</span> <span class=3D"mi">1</span><span cla=
ss=3D"p">)</span> <span class=3D"n">m</span><span class=3D"o">--</span><spa=
n class=3D"p">;</span>
    <span class=3D"n">ch</span><span class=3D"p">.</span><span class=3D"n">=
resize</span><span class=3D"p">(</span><span class=3D"n">m</span><span clas=
s=3D"p">);</span>
    <span class=3D"k">return</span> <span class=3D"n">ch</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>


<span class=3D"kr">inline</span> <span class=3D"kt">double</span> <span cla=
ss=3D"n">Dist2</span><span class=3D"p">(</span><span class=3D"n">Point</spa=
n> <span class=3D"n">a</span><span class=3D"p">,</span> <span class=3D"n">P=
oint</span> <span class=3D"n">b</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"k">return</span> <span class=3D"n">sqrt</span><span clas=
s=3D"p">(</span><span class=3D"n">a</span><span class=3D"p">.</span><span c=
lass=3D"n">x</span> <span class=3D"o">-</span> <span class=3D"n">b</span><s=
pan class=3D"p">.</span><span class=3D"n">x</span><span class=3D"p">)</span=
> <span class=3D"o">+</span> <span class=3D"n">sqrt</span><span class=3D"p"=
>(</span><span class=3D"n">a</span><span class=3D"p">.</span><span class=3D=
"n">y</span> <span class=3D"o">-</span> <span class=3D"n">b</span><span cla=
ss=3D"p">.</span><span class=3D"n">y</span><span class=3D"p">);</span>
<span class=3D"p">}</span>


<span class=3D"c1">// =E8=BF=94=E5=9B=9E=E7=82=B9=E9=9B=86=E7=9B=B4=E5=BE=
=84=E7=9A=84=E5=B9=B3=E6=96=B9</span>
<span class=3D"kt">double</span> <span class=3D"n">diameter2</span><span cl=
ass=3D"p">(</span><span class=3D"n">vector</span><span class=3D"o">&lt;</sp=
an><span class=3D"n">Point</span><span class=3D"o">&gt;&amp;</span> <span c=
lass=3D"n">points</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"n">vector</span><span class=3D"o">&lt;</span><span class=
=3D"n">Point</span><span class=3D"o">&gt;</span> <span class=3D"n">p</span>=
 <span class=3D"o">=3D</span> <span class=3D"n">ConvexHull</span><span clas=
s=3D"p">(</span><span class=3D"n">points</span><span class=3D"p">);</span>
    <span class=3D"kt">int</span> <span class=3D"n">n</span> <span class=3D=
"o">=3D</span> <span class=3D"n">p</span><span class=3D"p">.</span><span cl=
ass=3D"n">size</span><span class=3D"p">();</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
n</span> <span class=3D"o">=3D=3D</span> <span class=3D"mi">1</span><span c=
lass=3D"p">)</span> <span class=3D"k">return</span> <span class=3D"mi">0</s=
pan><span class=3D"p">;</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
n</span> <span class=3D"o">=3D=3D</span> <span class=3D"mi">2</span><span c=
lass=3D"p">)</span> <span class=3D"k">return</span> <span class=3D"n">Dist2=
</span><span class=3D"p">(</span><span class=3D"n">p</span><span class=3D"p=
">[</span><span class=3D"mi">0</span><span class=3D"p">],</span> <span clas=
s=3D"n">p</span><span class=3D"p">[</span><span class=3D"mi">1</span><span =
class=3D"p">]);</span>
    <span class=3D"n">p</span><span class=3D"p">.</span><span class=3D"n">p=
ush_back</span><span class=3D"p">(</span><span class=3D"n">p</span><span cl=
ass=3D"p">[</span><span class=3D"mi">0</span><span class=3D"p">]);</span> <=
span class=3D"c1">// =E5=85=8D=E5=BE=97=E5=8F=96=E6=A8=A1</span>
    <span class=3D"kt">double</span> <span class=3D"n">ans</span> <span cla=
ss=3D"o">=3D</span> <span class=3D"mi">0</span><span class=3D"p">;</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">u</span> <span class=3D"o">=3D</span> <span =
class=3D"mi">0</span><span class=3D"p">,</span> <span class=3D"n">v</span> =
<span class=3D"o">=3D</span> <span class=3D"mi">1</span><span class=3D"p">;=
</span> <span class=3D"n">u</span> <span class=3D"o">&lt;</span> <span clas=
s=3D"n">n</span><span class=3D"p">;</span> <span class=3D"n">u</span><span =
class=3D"o">++</span><span class=3D"p">)</span>
    <span class=3D"p">{</span>
        <span class=3D"c1">// =E4=B8=80=E6=9D=A1=E7=9B=B4=E7=BA=BF=E8=B4=B4=
=E4=BD=8F=E8=BE=B9p[u]-p[u+1]</span>
        <span class=3D"k">for</span><span class=3D"p">(;;)</span>
        <span class=3D"p">{</span>
            <span class=3D"c1">// =E5=BD=93Area(p[u], p[u+1], p[v+1]) &lt;=
=3D Area(p[u], p[u+1], p[v])=E6=97=B6=E5=81=9C=E6=AD=A2=E6=97=8B=E8=BD=AC</=
span>
            <span class=3D"c1">// =E5=8D=B3Cross(p[u+1]-p[u], p[v+1]-p[u]) =
- Cross(p[u+1]-p[u], p[v]-p[u]) &lt;=3D 0</span>
            <span class=3D"c1">// =E6=A0=B9=E6=8D=AECross(A,B) - Cross(A,C)=
 =3D Cross(A,B-C)</span>
            <span class=3D"c1">// =E5=8C=96=E7=AE=80=E5=BE=97Cross(p[u+1]-p=
[u], p[v+1]-p[v]) &lt;=3D 0</span>
            <span class=3D"kt">int</span> <span class=3D"n">diff</span> <sp=
an class=3D"o">=3D</span> <span class=3D"n">Cross</span><span class=3D"p">(=
</span><span class=3D"n">p</span><span class=3D"p">[</span><span class=3D"n=
">u</span><span class=3D"o">+</span><span class=3D"mi">1</span><span class=
=3D"p">]</span><span class=3D"o">-</span><span class=3D"n">p</span><span cl=
ass=3D"p">[</span><span class=3D"n">u</span><span class=3D"p">],</span> <sp=
an class=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">v</span>=
<span class=3D"o">+</span><span class=3D"mi">1</span><span class=3D"p">]</s=
pan><span class=3D"o">-</span><span class=3D"n">p</span><span class=3D"p">[=
</span><span class=3D"n">v</span><span class=3D"p">]);</span>
            <span class=3D"k">if</span><span class=3D"p">(</span><span clas=
s=3D"n">diff</span> <span class=3D"o">&lt;=3D</span> <span class=3D"mi">0</=
span><span class=3D"p">)</span>
            <span class=3D"p">{</span>
                <span class=3D"n">ans</span> <span class=3D"o">=3D</span> <=
span class=3D"n">max</span><span class=3D"p">(</span><span class=3D"n">ans<=
/span><span class=3D"p">,</span> <span class=3D"n">Dist2</span><span class=
=3D"p">(</span><span class=3D"n">p</span><span class=3D"p">[</span><span cl=
ass=3D"n">u</span><span class=3D"p">],</span> <span class=3D"n">p</span><sp=
an class=3D"p">[</span><span class=3D"n">v</span><span class=3D"p">]));</sp=
an> <span class=3D"c1">// u=E5=92=8Cv=E6=98=AF=E5=AF=B9=E8=B8=B5=E7=82=B9</=
span>
                <span class=3D"k">if</span><span class=3D"p">(</span><span =
class=3D"n">diff</span> <span class=3D"o">=3D=3D</span> <span class=3D"mi">=
0</span><span class=3D"p">)</span>
                    <span class=3D"n">ans</span> <span class=3D"o">=3D</spa=
n> <span class=3D"n">max</span><span class=3D"p">(</span><span class=3D"n">=
ans</span><span class=3D"p">,</span> <span class=3D"n">Dist2</span><span cl=
ass=3D"p">(</span><span class=3D"n">p</span><span class=3D"p">[</span><span=
 class=3D"n">u</span><span class=3D"p">],</span> <span class=3D"n">p</span>=
<span class=3D"p">[</span><span class=3D"n">v</span><span class=3D"o">+</sp=
an><span class=3D"mi">1</span><span class=3D"p">]));</span> <span class=3D"=
c1">// diff =3D=3D 0=E6=97=B6u=E5=92=8Cv+1=E4=B9=9F=E6=98=AF=E5=AF=B9=E8=B8=
=B5=E7=82=B9</span>
                <span class=3D"k">break</span><span class=3D"p">;</span>
            <span class=3D"p">}</span>
            <span class=3D"n">v</span> <span class=3D"o">=3D</span> <span c=
lass=3D"p">(</span><span class=3D"n">v</span> <span class=3D"o">+</span> <s=
pan class=3D"mi">1</span><span class=3D"p">)</span> <span class=3D"o">%</sp=
an> <span class=3D"n">n</span><span class=3D"p">;</span>
        <span class=3D"p">}</span>
    <span class=3D"p">}</span>
    <span class=3D"k">return</span> <span class=3D"n">ans</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>

<span class=3D"c1">//=E4=B8=A4=E5=87=B8=E5=8C=85=E6=9C=80=E8=BF=91=E8=B7=9D=
=E7=A6=BB</span>
<span class=3D"kt">double</span> <span class=3D"n">RC_Distance</span><span =
class=3D"p">(</span><span class=3D"n">Point</span> <span class=3D"o">*</spa=
n><span class=3D"n">ch1</span><span class=3D"p">,</span> <span class=3D"n">=
Point</span> <span class=3D"o">*</span><span class=3D"n">ch2</span><span cl=
ass=3D"p">,</span> <span class=3D"kt">int</span> <span class=3D"n">n</span>=
<span class=3D"p">,</span> <span class=3D"kt">int</span> <span class=3D"n">=
m</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">int</span> <span class=3D"n">q</span><span class=3D"=
o">=3D</span><span class=3D"mi">0</span><span class=3D"p">,</span> <span cl=
ass=3D"n">p</span><span class=3D"o">=3D</span><span class=3D"mi">0</span><s=
pan class=3D"p">;</span>
    <span class=3D"c1">//REP(i, n)</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span><span class=3D"o">=3D</span><span cl=
ass=3D"mi">1</span><span class=3D"p">;</span><span class=3D"n">i</span><spa=
n class=3D"o">&lt;=3D</span><span class=3D"n">n</span><span class=3D"p">;</=
span><span class=3D"n">i</span><span class=3D"o">++</span><span class=3D"p"=
>)</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
ch1</span><span class=3D"p">[</span><span class=3D"n">i</span><span class=
=3D"p">].</span><span class=3D"n">y</span><span class=3D"o">-</span><span c=
lass=3D"n">ch1</span><span class=3D"p">[</span><span class=3D"n">p</span><s=
pan class=3D"p">].</span><span class=3D"n">y</span> <span class=3D"o">&lt;<=
/span> <span class=3D"o">-</span><span class=3D"n">eps</span><span class=3D=
"p">)</span> <span class=3D"n">p</span><span class=3D"o">=3D</span><span cl=
ass=3D"n">i</span><span class=3D"p">;</span>
    <span class=3D"c1">//REP(i, m)</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span><span class=3D"o">=3D</span><span cl=
ass=3D"mi">1</span><span class=3D"p">;</span><span class=3D"n">i</span><spa=
n class=3D"o">&lt;=3D</span><span class=3D"n">m</span><span class=3D"p">;</=
span><span class=3D"n">i</span><span class=3D"o">++</span><span class=3D"p"=
>)</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
ch2</span><span class=3D"p">[</span><span class=3D"n">i</span><span class=
=3D"p">].</span><span class=3D"n">y</span><span class=3D"o">-</span><span c=
lass=3D"n">ch2</span><span class=3D"p">[</span><span class=3D"n">q</span><s=
pan class=3D"p">].</span><span class=3D"n">y</span> <span class=3D"o">&gt;<=
/span> <span class=3D"n">eps</span><span class=3D"p">)</span> <span class=
=3D"n">q</span><span class=3D"o">=3D</span><span class=3D"n">i</span><span =
class=3D"p">;</span>
    <span class=3D"n">ch1</span><span class=3D"p">[</span><span class=3D"n"=
>n</span><span class=3D"p">]</span><span class=3D"o">=3D</span><span class=
=3D"n">ch1</span><span class=3D"p">[</span><span class=3D"mi">0</span><span=
 class=3D"p">];</span>
    <span class=3D"n">ch2</span><span class=3D"p">[</span><span class=3D"n"=
>m</span><span class=3D"p">]</span><span class=3D"o">=3D</span><span class=
=3D"n">ch2</span><span class=3D"p">[</span><span class=3D"mi">0</span><span=
 class=3D"p">];</span>


    <span class=3D"kt">double</span> <span class=3D"n">tmp</span><span clas=
s=3D"p">,</span> <span class=3D"n">ans</span><span class=3D"o">=3D</span><s=
pan class=3D"mf">1e100</span><span class=3D"p">;</span>
    <span class=3D"c1">//REP(i, n)</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span><span class=3D"o">=3D</span><span cl=
ass=3D"mi">1</span><span class=3D"p">;</span><span class=3D"n">i</span><spa=
n class=3D"o">&lt;=3D</span><span class=3D"n">n</span><span class=3D"p">;</=
span><span class=3D"n">i</span><span class=3D"o">++</span><span class=3D"p"=
>)</span>
    <span class=3D"p">{</span>
        <span class=3D"k">while</span><span class=3D"p">((</span><span clas=
s=3D"n">tmp</span> <span class=3D"o">=3D</span> <span class=3D"n">Cross</sp=
an><span class=3D"p">(</span><span class=3D"n">ch1</span><span class=3D"p">=
[</span><span class=3D"n">p</span><span class=3D"o">+</span><span class=3D"=
mi">1</span><span class=3D"p">]</span><span class=3D"o">-</span><span class=
=3D"n">ch1</span><span class=3D"p">[</span><span class=3D"n">p</span><span =
class=3D"p">],</span> <span class=3D"n">ch2</span><span class=3D"p">[</span=
><span class=3D"n">q</span><span class=3D"o">+</span><span class=3D"mi">1</=
span><span class=3D"p">]</span><span class=3D"o">-</span><span class=3D"n">=
ch1</span><span class=3D"p">[</span><span class=3D"n">p</span><span class=
=3D"p">])</span> <span class=3D"o">-</span> <span class=3D"n">Cross</span><=
span class=3D"p">(</span><span class=3D"n">ch1</span><span class=3D"p">[</s=
pan><span class=3D"n">p</span><span class=3D"o">+</span><span class=3D"mi">=
1</span><span class=3D"p">]</span><span class=3D"o">-</span><span class=3D"=
n">ch1</span><span class=3D"p">[</span><span class=3D"n">p</span><span clas=
s=3D"p">],</span> <span class=3D"n">ch2</span><span class=3D"p">[</span><sp=
an class=3D"n">q</span><span class=3D"p">]</span><span class=3D"o">-</span>=
 <span class=3D"n">ch1</span><span class=3D"p">[</span><span class=3D"n">p<=
/span><span class=3D"p">]))</span> <span class=3D"o">&gt;</span> <span clas=
s=3D"n">eps</span><span class=3D"p">)</span>
            <span class=3D"n">q</span><span class=3D"o">=3D</span><span cla=
ss=3D"p">(</span><span class=3D"n">q</span><span class=3D"o">+</span><span =
class=3D"mi">1</span><span class=3D"p">)</span><span class=3D"o">%</span><s=
pan class=3D"n">m</span><span class=3D"p">;</span>
        <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D=
"n">tmp</span> <span class=3D"o">&lt;</span> <span class=3D"o">-</span><spa=
n class=3D"n">eps</span><span class=3D"p">)</span> <span class=3D"n">ans</s=
pan> <span class=3D"o">=3D</span> <span class=3D"n">min</span><span class=
=3D"p">(</span><span class=3D"n">ans</span><span class=3D"p">,</span><span =
class=3D"n">DistanceToSegment</span><span class=3D"p">(</span><span class=
=3D"n">ch2</span><span class=3D"p">[</span><span class=3D"n">q</span><span =
class=3D"p">],</span><span class=3D"n">ch1</span><span class=3D"p">[</span>=
<span class=3D"n">p</span><span class=3D"p">],</span><span class=3D"n">ch1<=
/span><span class=3D"p">[</span><span class=3D"n">p</span><span class=3D"o"=
>+</span><span class=3D"mi">1</span><span class=3D"p">]));</span>
        <span class=3D"k">else</span> <span class=3D"n">ans</span> <span cl=
ass=3D"o">=3D</span> <span class=3D"n">min</span><span class=3D"p">(</span>=
<span class=3D"n">ans</span><span class=3D"p">,</span><span class=3D"n">dis=
_pair_seg</span><span class=3D"p">(</span><span class=3D"n">ch1</span><span=
 class=3D"p">[</span><span class=3D"n">p</span><span class=3D"p">],</span><=
span class=3D"n">ch1</span><span class=3D"p">[</span><span class=3D"n">p</s=
pan><span class=3D"o">+</span><span class=3D"mi">1</span><span class=3D"p">=
],</span><span class=3D"n">ch2</span><span class=3D"p">[</span><span class=
=3D"n">q</span><span class=3D"p">],</span><span class=3D"n">ch2</span><span=
 class=3D"p">[</span><span class=3D"n">q</span><span class=3D"o">+</span><s=
pan class=3D"mi">1</span><span class=3D"p">]));</span>
        <span class=3D"n">p</span><span class=3D"o">=3D</span><span class=
=3D"p">(</span><span class=3D"n">p</span><span class=3D"o">+</span><span cl=
ass=3D"mi">1</span><span class=3D"p">)</span><span class=3D"o">%</span><spa=
n class=3D"n">n</span><span class=3D"p">;</span>
    <span class=3D"p">}</span>
    <span class=3D"k">return</span> <span class=3D"n">ans</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>

<span class=3D"c1">//=E4=B8=A4=E5=87=B8=E5=8C=85=E6=9C=80=E8=BF=91=E8=B7=9D=
=E7=A6=BB</span>
<span class=3D"c1">//=E4=BD=BF=E7=94=A8vector</span>
<span class=3D"kt">double</span> <span class=3D"n">RC_Distance</span><span =
class=3D"p">(</span><span class=3D"n">vector</span><span class=3D"o">&lt;</=
span><span class=3D"n">Point</span><span class=3D"o">&gt;</span> <span clas=
s=3D"n">ch1</span><span class=3D"p">,</span> <span class=3D"n">vector</span=
><span class=3D"o">&lt;</span><span class=3D"n">Point</span><span class=3D"=
o">&gt;</span> <span class=3D"n">ch2</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">int</span> <span class=3D"n">q</span> <span class=3D=
"o">=3D</span> <span class=3D"mi">0</span><span class=3D"p">,</span> <span =
class=3D"n">p</span> <span class=3D"o">=3D</span> <span class=3D"mi">0</spa=
n><span class=3D"p">,</span> <span class=3D"n">n</span> <span class=3D"o">=
=3D</span> <span class=3D"n">ch1</span><span class=3D"p">.</span><span clas=
s=3D"n">size</span><span class=3D"p">(),</span> <span class=3D"n">m</span> =
<span class=3D"o">=3D</span> <span class=3D"n">ch2</span><span class=3D"p">=
.</span><span class=3D"n">size</span><span class=3D"p">();</span>
    <span class=3D"c1">//REP(i, n)</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span><span class=3D"o">=3D</span><span cl=
ass=3D"mi">1</span><span class=3D"p">;</span><span class=3D"n">i</span><spa=
n class=3D"o">&lt;=3D</span><span class=3D"n">n</span><span class=3D"p">;</=
span><span class=3D"n">i</span><span class=3D"o">++</span><span class=3D"p"=
>)</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
ch1</span><span class=3D"p">[</span><span class=3D"n">i</span><span class=
=3D"p">].</span><span class=3D"n">y</span><span class=3D"o">-</span><span c=
lass=3D"n">ch1</span><span class=3D"p">[</span><span class=3D"n">p</span><s=
pan class=3D"p">].</span><span class=3D"n">y</span> <span class=3D"o">&lt;<=
/span> <span class=3D"o">-</span><span class=3D"n">eps</span><span class=3D=
"p">)</span> <span class=3D"n">p</span><span class=3D"o">=3D</span><span cl=
ass=3D"n">i</span><span class=3D"p">;</span>
    <span class=3D"c1">//REP(i, m)</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span><span class=3D"o">=3D</span><span cl=
ass=3D"mi">1</span><span class=3D"p">;</span><span class=3D"n">i</span><spa=
n class=3D"o">&lt;=3D</span><span class=3D"n">m</span><span class=3D"p">;</=
span><span class=3D"n">i</span><span class=3D"o">++</span><span class=3D"p"=
>)</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
ch2</span><span class=3D"p">[</span><span class=3D"n">i</span><span class=
=3D"p">].</span><span class=3D"n">y</span><span class=3D"o">-</span><span c=
lass=3D"n">ch2</span><span class=3D"p">[</span><span class=3D"n">q</span><s=
pan class=3D"p">].</span><span class=3D"n">y</span> <span class=3D"o">&gt;<=
/span> <span class=3D"n">eps</span><span class=3D"p">)</span> <span class=
=3D"n">q</span><span class=3D"o">=3D</span><span class=3D"n">i</span><span =
class=3D"p">;</span>
    <span class=3D"n">ch1</span><span class=3D"p">.</span><span class=3D"n"=
>push_back</span><span class=3D"p">(</span><span class=3D"n">ch1</span><spa=
n class=3D"p">[</span><span class=3D"mi">0</span><span class=3D"p">]),</spa=
n> <span class=3D"n">ch2</span><span class=3D"p">.</span><span class=3D"n">=
push_back</span><span class=3D"p">(</span><span class=3D"n">ch2</span><span=
 class=3D"p">[</span><span class=3D"mi">0</span><span class=3D"p">]);</span=
>


    <span class=3D"kt">double</span> <span class=3D"n">tmp</span><span clas=
s=3D"p">,</span> <span class=3D"n">ans</span><span class=3D"o">=3D</span><s=
pan class=3D"mf">1e100</span><span class=3D"p">;</span>
    <span class=3D"c1">//REP(i, n)</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span><span class=3D"o">=3D</span><span cl=
ass=3D"mi">1</span><span class=3D"p">;</span><span class=3D"n">i</span><spa=
n class=3D"o">&lt;=3D</span><span class=3D"n">n</span><span class=3D"p">;</=
span><span class=3D"n">i</span><span class=3D"o">++</span><span class=3D"p"=
>)</span>
    <span class=3D"p">{</span>
        <span class=3D"k">while</span><span class=3D"p">((</span><span clas=
s=3D"n">tmp</span> <span class=3D"o">=3D</span> <span class=3D"n">Cross</sp=
an><span class=3D"p">(</span><span class=3D"n">ch1</span><span class=3D"p">=
[</span><span class=3D"n">p</span><span class=3D"o">+</span><span class=3D"=
mi">1</span><span class=3D"p">]</span><span class=3D"o">-</span><span class=
=3D"n">ch1</span><span class=3D"p">[</span><span class=3D"n">p</span><span =
class=3D"p">],</span> <span class=3D"n">ch2</span><span class=3D"p">[</span=
><span class=3D"n">q</span><span class=3D"o">+</span><span class=3D"mi">1</=
span><span class=3D"p">]</span><span class=3D"o">-</span><span class=3D"n">=
ch1</span><span class=3D"p">[</span><span class=3D"n">p</span><span class=
=3D"p">])</span> <span class=3D"o">-</span> <span class=3D"n">Cross</span><=
span class=3D"p">(</span><span class=3D"n">ch1</span><span class=3D"p">[</s=
pan><span class=3D"n">p</span><span class=3D"o">+</span><span class=3D"mi">=
1</span><span class=3D"p">]</span><span class=3D"o">-</span><span class=3D"=
n">ch1</span><span class=3D"p">[</span><span class=3D"n">p</span><span clas=
s=3D"p">],</span> <span class=3D"n">ch2</span><span class=3D"p">[</span><sp=
an class=3D"n">q</span><span class=3D"p">]</span><span class=3D"o">-</span>=
 <span class=3D"n">ch1</span><span class=3D"p">[</span><span class=3D"n">p<=
/span><span class=3D"p">]))</span> <span class=3D"o">&gt;</span> <span clas=
s=3D"n">eps</span><span class=3D"p">)</span>
            <span class=3D"n">q</span><span class=3D"o">=3D</span><span cla=
ss=3D"p">(</span><span class=3D"n">q</span><span class=3D"o">+</span><span =
class=3D"mi">1</span><span class=3D"p">)</span><span class=3D"o">%</span><s=
pan class=3D"n">m</span><span class=3D"p">;</span>
        <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D=
"n">tmp</span> <span class=3D"o">&lt;</span> <span class=3D"o">-</span><spa=
n class=3D"n">eps</span><span class=3D"p">)</span> <span class=3D"n">ans</s=
pan> <span class=3D"o">=3D</span> <span class=3D"n">min</span><span class=
=3D"p">(</span><span class=3D"n">ans</span><span class=3D"p">,</span><span =
class=3D"n">DistanceToSegment</span><span class=3D"p">(</span><span class=
=3D"n">ch2</span><span class=3D"p">[</span><span class=3D"n">q</span><span =
class=3D"p">],</span><span class=3D"n">ch1</span><span class=3D"p">[</span>=
<span class=3D"n">p</span><span class=3D"p">],</span><span class=3D"n">ch1<=
/span><span class=3D"p">[</span><span class=3D"n">p</span><span class=3D"o"=
>+</span><span class=3D"mi">1</span><span class=3D"p">]));</span>
        <span class=3D"k">else</span> <span class=3D"n">ans</span> <span cl=
ass=3D"o">=3D</span> <span class=3D"n">min</span><span class=3D"p">(</span>=
<span class=3D"n">ans</span><span class=3D"p">,</span><span class=3D"n">dis=
_pair_seg</span><span class=3D"p">(</span><span class=3D"n">ch1</span><span=
 class=3D"p">[</span><span class=3D"n">p</span><span class=3D"p">],</span><=
span class=3D"n">ch1</span><span class=3D"p">[</span><span class=3D"n">p</s=
pan><span class=3D"o">+</span><span class=3D"mi">1</span><span class=3D"p">=
],</span><span class=3D"n">ch2</span><span class=3D"p">[</span><span class=
=3D"n">q</span><span class=3D"p">],</span><span class=3D"n">ch2</span><span=
 class=3D"p">[</span><span class=3D"n">q</span><span class=3D"o">+</span><s=
pan class=3D"mi">1</span><span class=3D"p">]));</span>
        <span class=3D"n">p</span><span class=3D"o">=3D</span><span class=
=3D"p">(</span><span class=3D"n">p</span><span class=3D"o">+</span><span cl=
ass=3D"mi">1</span><span class=3D"p">)</span><span class=3D"o">%</span><spa=
n class=3D"n">n</span><span class=3D"p">;</span>
    <span class=3D"p">}</span>
    <span class=3D"k">return</span> <span class=3D"n">ans</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>

<span class=3D"c1">//=E5=87=B8=E5=8C=85=E6=9C=80=E5=A4=A7=E5=86=85=E6=8E=A5=
=E4=B8=89=E8=A7=92=E5=BD=A2</span>
<span class=3D"kt">double</span> <span class=3D"n">RC_Triangle</span><span =
class=3D"p">(</span><span class=3D"n">Point</span><span class=3D"o">*</span=
> <span class=3D"n">res</span><span class=3D"p">,</span><span class=3D"kt">=
int</span> <span class=3D"n">n</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
n</span> <span class=3D"o">&lt;</span> <span class=3D"mi">3</span><span cla=
ss=3D"p">)</span>    <span class=3D"k">return</span> <span class=3D"mi">0</=
span><span class=3D"p">;</span>
    <span class=3D"kt">double</span> <span class=3D"n">ans</span> <span cla=
ss=3D"o">=3D</span> <span class=3D"mi">0</span><span class=3D"p">,</span> <=
span class=3D"n">tmp</span><span class=3D"p">;</span>
    <span class=3D"n">res</span><span class=3D"p">[</span><span class=3D"n"=
>n</span><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span clas=
s=3D"n">res</span><span class=3D"p">[</span><span class=3D"mi">0</span><spa=
n class=3D"p">];</span>
    <span class=3D"kt">int</span> <span class=3D"n">j</span><span class=3D"=
p">,</span> <span class=3D"n">k</span><span class=3D"p">;</span>
    <span class=3D"c1">//REP(i, n)</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span><span class=3D"o">=3D</span><span cl=
ass=3D"mi">1</span><span class=3D"p">;</span><span class=3D"n">i</span><spa=
n class=3D"o">&lt;=3D</span><span class=3D"n">n</span><span class=3D"p">;</=
span><span class=3D"n">i</span><span class=3D"o">++</span><span class=3D"p"=
>)</span>
    <span class=3D"p">{</span>
        <span class=3D"n">j</span> <span class=3D"o">=3D</span> <span class=
=3D"p">(</span><span class=3D"n">i</span><span class=3D"o">+</span><span cl=
ass=3D"mi">1</span><span class=3D"p">)</span><span class=3D"o">%</span><spa=
n class=3D"n">n</span><span class=3D"p">;</span>
        <span class=3D"n">k</span> <span class=3D"o">=3D</span> <span class=
=3D"p">(</span><span class=3D"n">j</span><span class=3D"o">+</span><span cl=
ass=3D"mi">1</span><span class=3D"p">)</span><span class=3D"o">%</span><spa=
n class=3D"n">n</span><span class=3D"p">;</span>
        <span class=3D"k">while</span><span class=3D"p">((</span><span clas=
s=3D"n">j</span> <span class=3D"o">!=3D</span> <span class=3D"n">k</span><s=
pan class=3D"p">)</span> <span class=3D"o">&amp;&amp;</span> <span class=3D=
"p">(</span><span class=3D"n">k</span> <span class=3D"o">!=3D</span> <span =
class=3D"n">i</span><span class=3D"p">))</span>
        <span class=3D"p">{</span>
            <span class=3D"k">while</span><span class=3D"p">(</span><span c=
lass=3D"n">Cross</span><span class=3D"p">(</span><span class=3D"n">res</spa=
n><span class=3D"p">[</span><span class=3D"n">j</span><span class=3D"p">]</=
span> <span class=3D"o">-</span> <span class=3D"n">res</span><span class=3D=
"p">[</span><span class=3D"n">i</span><span class=3D"p">],</span> <span cla=
ss=3D"n">res</span><span class=3D"p">[</span><span class=3D"n">k</span><spa=
n class=3D"o">+</span><span class=3D"mi">1</span><span class=3D"p">]</span>=
 <span class=3D"o">-</span> <span class=3D"n">res</span><span class=3D"p">[=
</span><span class=3D"n">i</span><span class=3D"p">])</span> <span class=3D=
"o">&gt;</span> <span class=3D"n">Cross</span><span class=3D"p">(</span><sp=
an class=3D"n">res</span><span class=3D"p">[</span><span class=3D"n">j</spa=
n><span class=3D"p">]</span> <span class=3D"o">-</span> <span class=3D"n">r=
es</span><span class=3D"p">[</span><span class=3D"n">i</span><span class=3D=
"p">],</span> <span class=3D"n">res</span><span class=3D"p">[</span><span c=
lass=3D"n">k</span><span class=3D"p">]</span> <span class=3D"o">-</span> <s=
pan class=3D"n">res</span><span class=3D"p">[</span><span class=3D"n">i</sp=
an><span class=3D"p">]))</span> <span class=3D"n">k</span><span class=3D"o"=
>=3D</span> <span class=3D"p">(</span><span class=3D"n">k</span><span class=
=3D"o">+</span><span class=3D"mi">1</span><span class=3D"p">)</span><span c=
lass=3D"o">%</span><span class=3D"n">n</span><span class=3D"p">;</span>
            <span class=3D"n">tmp</span> <span class=3D"o">=3D</span> <span=
 class=3D"n">Cross</span><span class=3D"p">(</span><span class=3D"n">res</s=
pan><span class=3D"p">[</span><span class=3D"n">j</span><span class=3D"p">]=
</span> <span class=3D"o">-</span> <span class=3D"n">res</span><span class=
=3D"p">[</span><span class=3D"n">i</span><span class=3D"p">],</span> <span =
class=3D"n">res</span><span class=3D"p">[</span><span class=3D"n">k</span><=
span class=3D"p">]</span> <span class=3D"o">-</span> <span class=3D"n">res<=
/span><span class=3D"p">[</span><span class=3D"n">i</span><span class=3D"p"=
>]);</span>
            <span class=3D"k">if</span><span class=3D"p">(</span><span clas=
s=3D"n">tmp</span> <span class=3D"o">&gt;</span> <span class=3D"n">ans</spa=
n><span class=3D"p">)</span> <span class=3D"n">ans</span> <span class=3D"o"=
>=3D</span> <span class=3D"n">tmp</span><span class=3D"p">;</span>
            <span class=3D"n">j</span> <span class=3D"o">=3D</span> <span c=
lass=3D"p">(</span><span class=3D"n">j</span><span class=3D"o">+</span><spa=
n class=3D"mi">1</span><span class=3D"p">)</span><span class=3D"o">%</span>=
<span class=3D"n">n</span><span class=3D"p">;</span>
        <span class=3D"p">}</span>
    <span class=3D"p">}</span>
    <span class=3D"k">return</span> <span class=3D"n">ans</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>

<span class=3D"c1">//=E5=87=B8=E5=8C=85=E6=9C=80=E5=A4=A7=E5=86=85=E6=8E=A5=
=E4=B8=89=E8=A7=92=E5=BD=A2</span>
<span class=3D"kt">double</span> <span class=3D"n">RC_Triangle</span><span =
class=3D"p">(</span><span class=3D"n">vector</span><span class=3D"o">&lt;</=
span><span class=3D"n">Point</span><span class=3D"o">&gt;</span> <span clas=
s=3D"n">res</span><span class=3D"p">,</span> <span class=3D"n">Point</span>=
<span class=3D"o">&amp;</span> <span class=3D"n">a</span><span class=3D"p">=
,</span> <span class=3D"n">Point</span><span class=3D"o">&amp;</span> <span=
 class=3D"n">b</span><span class=3D"p">,</span> <span class=3D"n">Point</sp=
an><span class=3D"o">&amp;</span> <span class=3D"n">c</span><span class=3D"=
p">)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">int</span> <span class=3D"n">n</span> <span class=3D=
"o">=3D</span> <span class=3D"n">res</span><span class=3D"p">.</span><span =
class=3D"n">size</span><span class=3D"p">();</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
n</span> <span class=3D"o">&lt;</span> <span class=3D"mi">3</span><span cla=
ss=3D"p">)</span>    <span class=3D"k">return</span> <span class=3D"mi">0</=
span><span class=3D"p">;</span>
    <span class=3D"kt">double</span> <span class=3D"n">ans</span><span clas=
s=3D"o">=3D</span><span class=3D"mi">0</span><span class=3D"p">,</span> <sp=
an class=3D"n">tmp</span><span class=3D"p">;</span>
    <span class=3D"n">res</span><span class=3D"p">.</span><span class=3D"n"=
>push_back</span><span class=3D"p">(</span><span class=3D"n">res</span><spa=
n class=3D"p">[</span><span class=3D"mi">0</span><span class=3D"p">]);</spa=
n>
    <span class=3D"kt">int</span> <span class=3D"n">j</span><span class=3D"=
p">,</span> <span class=3D"n">k</span><span class=3D"p">;</span>
    <span class=3D"c1">//REP(i, n)</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span><span class=3D"o">=3D</span><span cl=
ass=3D"mi">1</span><span class=3D"p">;</span><span class=3D"n">i</span><spa=
n class=3D"o">&lt;=3D</span><span class=3D"n">n</span><span class=3D"p">;</=
span><span class=3D"n">i</span><span class=3D"o">++</span><span class=3D"p"=
>)</span>
    <span class=3D"p">{</span>
        <span class=3D"n">j</span> <span class=3D"o">=3D</span> <span class=
=3D"p">(</span><span class=3D"n">i</span><span class=3D"o">+</span><span cl=
ass=3D"mi">1</span><span class=3D"p">)</span><span class=3D"o">%</span><spa=
n class=3D"n">n</span><span class=3D"p">;</span>
        <span class=3D"n">k</span> <span class=3D"o">=3D</span> <span class=
=3D"p">(</span><span class=3D"n">j</span><span class=3D"o">+</span><span cl=
ass=3D"mi">1</span><span class=3D"p">)</span><span class=3D"o">%</span><spa=
n class=3D"n">n</span><span class=3D"p">;</span>
        <span class=3D"k">while</span><span class=3D"p">((</span><span clas=
s=3D"n">j</span> <span class=3D"o">!=3D</span> <span class=3D"n">k</span><s=
pan class=3D"p">)</span> <span class=3D"o">&amp;&amp;</span> <span class=3D=
"p">(</span><span class=3D"n">k</span> <span class=3D"o">!=3D</span> <span =
class=3D"n">i</span><span class=3D"p">))</span>
        <span class=3D"p">{</span>
            <span class=3D"k">while</span><span class=3D"p">(</span><span c=
lass=3D"n">Cross</span><span class=3D"p">(</span><span class=3D"n">res</spa=
n><span class=3D"p">[</span><span class=3D"n">j</span><span class=3D"p">]</=
span> <span class=3D"o">-</span> <span class=3D"n">res</span><span class=3D=
"p">[</span><span class=3D"n">i</span><span class=3D"p">],</span> <span cla=
ss=3D"n">res</span><span class=3D"p">[</span><span class=3D"n">k</span><spa=
n class=3D"o">+</span><span class=3D"mi">1</span><span class=3D"p">]</span>=
 <span class=3D"o">-</span> <span class=3D"n">res</span><span class=3D"p">[=
</span><span class=3D"n">i</span><span class=3D"p">])</span> <span class=3D=
"o">&gt;</span> <span class=3D"n">Cross</span><span class=3D"p">(</span><sp=
an class=3D"n">res</span><span class=3D"p">[</span><span class=3D"n">j</spa=
n><span class=3D"p">]</span> <span class=3D"o">-</span> <span class=3D"n">r=
es</span><span class=3D"p">[</span><span class=3D"n">i</span><span class=3D=
"p">],</span> <span class=3D"n">res</span><span class=3D"p">[</span><span c=
lass=3D"n">k</span><span class=3D"p">]</span> <span class=3D"o">-</span> <s=
pan class=3D"n">res</span><span class=3D"p">[</span><span class=3D"n">i</sp=
an><span class=3D"p">]))</span> <span class=3D"n">k</span><span class=3D"o"=
>=3D</span> <span class=3D"p">(</span><span class=3D"n">k</span><span class=
=3D"o">+</span><span class=3D"mi">1</span><span class=3D"p">)</span><span c=
lass=3D"o">%</span><span class=3D"n">n</span><span class=3D"p">;</span>
            <span class=3D"n">tmp</span> <span class=3D"o">=3D</span> <span=
 class=3D"n">Cross</span><span class=3D"p">(</span><span class=3D"n">res</s=
pan><span class=3D"p">[</span><span class=3D"n">j</span><span class=3D"p">]=
</span> <span class=3D"o">-</span> <span class=3D"n">res</span><span class=
=3D"p">[</span><span class=3D"n">i</span><span class=3D"p">],</span> <span =
class=3D"n">res</span><span class=3D"p">[</span><span class=3D"n">k</span><=
span class=3D"p">]</span> <span class=3D"o">-</span> <span class=3D"n">res<=
/span><span class=3D"p">[</span><span class=3D"n">i</span><span class=3D"p"=
>]);</span>
            <span class=3D"k">if</span><span class=3D"p">(</span><span clas=
s=3D"n">tmp</span> <span class=3D"o">&gt;</span> <span class=3D"n">ans</spa=
n><span class=3D"p">)</span>
            <span class=3D"p">{</span>
                <span class=3D"n">a</span> <span class=3D"o">=3D</span> <sp=
an class=3D"n">res</span><span class=3D"p">[</span><span class=3D"n">i</spa=
n><span class=3D"p">],</span> <span class=3D"n">b</span> <span class=3D"o">=
=3D</span> <span class=3D"n">res</span><span class=3D"p">[</span><span clas=
s=3D"n">j</span><span class=3D"p">],</span> <span class=3D"n">c</span> <spa=
n class=3D"o">=3D</span> <span class=3D"n">res</span><span class=3D"p">[</s=
pan><span class=3D"n">k</span><span class=3D"p">];</span>
                <span class=3D"n">ans</span> <span class=3D"o">=3D</span> <=
span class=3D"n">tmp</span><span class=3D"p">;</span>
            <span class=3D"p">}</span>
            <span class=3D"n">j</span> <span class=3D"o">=3D</span> <span c=
lass=3D"p">(</span><span class=3D"n">j</span><span class=3D"o">+</span><spa=
n class=3D"mi">1</span><span class=3D"p">)</span><span class=3D"o">%</span>=
<span class=3D"n">n</span><span class=3D"p">;</span>
        <span class=3D"p">}</span>
    <span class=3D"p">}</span>
    <span class=3D"k">return</span> <span class=3D"n">ans</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>


<span class=3D"c1">//=E5=88=A4=E6=96=AD=E4=B8=A4=E5=87=B8=E5=8C=85=E6=98=AF=
=E5=90=A6=E6=9C=89=E4=BA=A4=E7=82=B9</span>
<span class=3D"kt">bool</span> <span class=3D"n">ConvexPolygonDisjoint</spa=
n><span class=3D"p">(</span><span class=3D"k">const</span> <span class=3D"n=
">vector</span><span class=3D"o">&lt;</span><span class=3D"n">Point</span><=
span class=3D"o">&gt;</span> <span class=3D"n">ch1</span><span class=3D"p">=
,</span> <span class=3D"k">const</span> <span class=3D"n">vector</span><spa=
n class=3D"o">&lt;</span><span class=3D"n">Point</span><span class=3D"o">&g=
t;</span> <span class=3D"n">ch2</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">int</span> <span class=3D"n">c1</span> <span class=
=3D"o">=3D</span> <span class=3D"n">ch1</span><span class=3D"p">.</span><sp=
an class=3D"n">size</span><span class=3D"p">();</span>
    <span class=3D"kt">int</span> <span class=3D"n">c2</span> <span class=
=3D"o">=3D</span> <span class=3D"n">ch2</span><span class=3D"p">.</span><sp=
an class=3D"n">size</span><span class=3D"p">();</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span> <span class=3D"o">=3D</span> <span =
class=3D"mi">0</span><span class=3D"p">;</span> <span class=3D"n">i</span> =
<span class=3D"o">&lt;</span> <span class=3D"n">c1</span><span class=3D"p">=
;</span> <span class=3D"n">i</span><span class=3D"o">++</span><span class=
=3D"p">)</span>
        <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D=
"n">isPointInPolygon</span><span class=3D"p">(</span><span class=3D"n">ch1<=
/span><span class=3D"p">[</span><span class=3D"n">i</span><span class=3D"p"=
>],</span> <span class=3D"n">ch2</span><span class=3D"p">)</span> <span cla=
ss=3D"o">!=3D</span> <span class=3D"mi">0</span><span class=3D"p">)</span>
            <span class=3D"k">return</span> <span class=3D"kc">false</span>=
<span class=3D"p">;</span> <span class=3D"c1">// =E5=86=85=E9=83=A8=E6=88=
=96=E8=BE=B9=E7=95=8C=E4=B8=8A</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span> <span class=3D"o">=3D</span> <span =
class=3D"mi">0</span><span class=3D"p">;</span> <span class=3D"n">i</span> =
<span class=3D"o">&lt;</span> <span class=3D"n">c2</span><span class=3D"p">=
;</span> <span class=3D"n">i</span><span class=3D"o">++</span><span class=
=3D"p">)</span>
        <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D=
"n">isPointInPolygon</span><span class=3D"p">(</span><span class=3D"n">ch2<=
/span><span class=3D"p">[</span><span class=3D"n">i</span><span class=3D"p"=
>],</span> <span class=3D"n">ch1</span><span class=3D"p">)</span> <span cla=
ss=3D"o">!=3D</span> <span class=3D"mi">0</span><span class=3D"p">)</span>
            <span class=3D"k">return</span> <span class=3D"kc">false</span>=
<span class=3D"p">;</span> <span class=3D"c1">// =E5=86=85=E9=83=A8=E6=88=
=96=E8=BE=B9=E7=95=8C=E4=B8=8A</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span> <span class=3D"o">=3D</span> <span =
class=3D"mi">0</span><span class=3D"p">;</span> <span class=3D"n">i</span> =
<span class=3D"o">&lt;</span> <span class=3D"n">c1</span><span class=3D"p">=
;</span> <span class=3D"n">i</span><span class=3D"o">++</span><span class=
=3D"p">)</span>
        <span class=3D"k">for</span><span class=3D"p">(</span><span class=
=3D"kt">int</span> <span class=3D"n">j</span> <span class=3D"o">=3D</span> =
<span class=3D"mi">0</span><span class=3D"p">;</span> <span class=3D"n">j</=
span> <span class=3D"o">&lt;</span> <span class=3D"n">c2</span><span class=
=3D"p">;</span> <span class=3D"n">j</span><span class=3D"o">++</span><span =
class=3D"p">)</span>
            <span class=3D"k">if</span><span class=3D"p">(</span><span clas=
s=3D"n">SegmentProperIntersection</span><span class=3D"p">(</span><span cla=
ss=3D"n">ch1</span><span class=3D"p">[</span><span class=3D"n">i</span><spa=
n class=3D"p">],</span> <span class=3D"n">ch1</span><span class=3D"p">[(</s=
pan><span class=3D"n">i</span><span class=3D"o">+</span><span class=3D"mi">=
1</span><span class=3D"p">)</span><span class=3D"o">%</span><span class=3D"=
n">c1</span><span class=3D"p">],</span> <span class=3D"n">ch2</span><span c=
lass=3D"p">[</span><span class=3D"n">j</span><span class=3D"p">],</span> <s=
pan class=3D"n">ch2</span><span class=3D"p">[(</span><span class=3D"n">j</s=
pan><span class=3D"o">+</span><span class=3D"mi">1</span><span class=3D"p">=
)</span><span class=3D"o">%</span><span class=3D"n">c2</span><span class=3D=
"p">]))</span>
                <span class=3D"k">return</span> <span class=3D"kc">false</s=
pan><span class=3D"p">;</span>
    <span class=3D"k">return</span> <span class=3D"kc">true</span><span cla=
ss=3D"p">;</span>
<span class=3D"p">}</span>

<span class=3D"kr">inline</span> <span class=3D"kt">double</span> <span cla=
ss=3D"n">dist</span><span class=3D"p">(</span><span class=3D"n">Point</span=
> <span class=3D"n">a</span><span class=3D"p">,</span> <span class=3D"n">Po=
int</span> <span class=3D"n">b</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"k">return</span> <span class=3D"n">Length</span><span cl=
ass=3D"p">(</span><span class=3D"n">a</span> <span class=3D"o">-</span> <sp=
an class=3D"n">b</span><span class=3D"p">);</span>
<span class=3D"p">}</span>

<span class=3D"c1">////=E6=A8=A1=E6=8B=9F=E9=80=80=E7=81=AB=E6=B1=82=E8=B4=
=B9=E9=A9=AC=E7=82=B9 =E4=BF=9D=E5=AD=98=E5=9C=A8ptres=E4=B8=AD</span>
<span class=3D"c1">//double fermat_point(Point *pt, int n, Point&amp; ptres=
)</span>
<span class=3D"c1">//{</span>
<span class=3D"c1">//    Point u, v;</span>
<span class=3D"c1">//    double step =3D 0.0, curlen, explen, minlen;</span=
>
<span class=3D"c1">//    int i, j, k;</span>
<span class=3D"c1">//    bool flag;</span>
<span class=3D"c1">//    u.x =3D u.y =3D v.x =3D v.y =3D 0.0;</span>
<span class=3D"c1">//    //REP(i, n)</span>
<span class=3D"c1">//    for(int i=3D1;i&lt;=3Dn;i++)</span>
<span class=3D"c1">//    {</span>
<span class=3D"c1">//        step +=3D fabs(pt[i].x) + fabs(pt[i].y);</span=
>
<span class=3D"c1">//        u.x +=3D pt[i].x;</span>
<span class=3D"c1">//        u.y +=3D pt[i].y;</span>
<span class=3D"c1">//    }</span>
<span class=3D"c1">//    u.x /=3D n;</span>
<span class=3D"c1">//    u.y /=3D n;</span>
<span class=3D"c1">//    flag =3D 0;</span>
<span class=3D"c1">//    while(step &gt; eps)</span>
<span class=3D"c1">//    {</span>
<span class=3D"c1">//        for(k =3D 0; k &lt; 10; step /=3D 2, ++k)</spa=
n>
<span class=3D"c1">//            for(i =3D -1; i &lt;=3D 1; ++i)</span>
<span class=3D"c1">//                for(j =3D -1; j &lt;=3D 1; ++j)</span>
<span class=3D"c1">//                {</span>
<span class=3D"c1">//                    v.x =3D u.x + step*i;</span>
<span class=3D"c1">//                    v.y =3D u.y + step*j;</span>
<span class=3D"c1">//                    curlen =3D explen =3D 0.0;</span>
<span class=3D"c1">//                    //REP(i, n)</span>
<span class=3D"c1">//                    for(int i=3D1;i&lt;=3Dn;i++)</span=
>
<span class=3D"c1">//                    {</span>
<span class=3D"c1">//                        curlen +=3D dist(u, pt[idx]);<=
/span>
<span class=3D"c1">//                        explen +=3D dist(v, pt[idx]);<=
/span>
<span class=3D"c1">//                    }</span>
<span class=3D"c1">//                    if(curlen &gt; explen)</span>
<span class=3D"c1">//                    {</span>
<span class=3D"c1">//                        u =3D v;</span>
<span class=3D"c1">//                        minlen =3D explen;</span>
<span class=3D"c1">//                        flag =3D 1;</span>
<span class=3D"c1">//                    }</span>
<span class=3D"c1">//                }</span>
<span class=3D"c1">//    }</span>
<span class=3D"c1">//    ptres =3D u;</span>
<span class=3D"c1">//    return flag ? minlen : curlen;</span>
<span class=3D"c1">//}</span>

<span class=3D"c1">//=E5=A4=9A=E8=BE=B9=E5=BD=A2=E8=B4=B9=E9=A9=AC=E7=82=B9=
</span>
<span class=3D"c1">//=E5=88=B0=E6=89=80=E6=9C=89=E9=A1=B6=E7=82=B9=E7=9A=84=
=E8=B7=9D=E7=A6=BB=E5=92=8C=E6=9C=80=E5=B0=8F</span>
<span class=3D"n">Point</span> <span class=3D"n">Fermat</span><span class=
=3D"p">(</span><span class=3D"kt">int</span> <span class=3D"n">np</span><sp=
an class=3D"p">,</span> <span class=3D"n">Point</span><span class=3D"o">*</=
span> <span class=3D"n">p</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">double</span> <span class=3D"n">nowx</span> <span cl=
ass=3D"o">=3D</span> <span class=3D"mi">0</span><span class=3D"p">,</span> =
<span class=3D"n">nowy</span> <span class=3D"o">=3D</span> <span class=3D"m=
i">0</span><span class=3D"p">;</span>
    <span class=3D"kt">double</span> <span class=3D"n">nextx</span> <span c=
lass=3D"o">=3D</span> <span class=3D"mi">0</span><span class=3D"p">,</span>=
 <span class=3D"n">nexty</span> <span class=3D"o">=3D</span> <span class=3D=
"mi">0</span><span class=3D"p">;</span>
    <span class=3D"c1">//REP(i, np)</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span><span class=3D"o">=3D</span><span cl=
ass=3D"mi">1</span><span class=3D"p">;</span><span class=3D"n">i</span><spa=
n class=3D"o">&lt;=3D</span><span class=3D"n">np</span><span class=3D"p">;<=
/span><span class=3D"n">i</span><span class=3D"o">++</span><span class=3D"p=
">)</span>
    <span class=3D"p">{</span>
        <span class=3D"n">nowx</span> <span class=3D"o">+=3D</span> <span c=
lass=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">i</span><spa=
n class=3D"p">].</span><span class=3D"n">x</span><span class=3D"p">;</span>
        <span class=3D"n">nowy</span> <span class=3D"o">+=3D</span> <span c=
lass=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">i</span><spa=
n class=3D"p">].</span><span class=3D"n">y</span><span class=3D"p">;</span>
    <span class=3D"p">}</span>
    <span class=3D"k">for</span> <span class=3D"p">(</span><span class=3D"n=
">nowx</span> <span class=3D"o">/=3D</span> <span class=3D"n">np</span><spa=
n class=3D"p">,</span> <span class=3D"n">nowy</span> <span class=3D"o">/=3D=
</span> <span class=3D"n">np</span><span class=3D"p">;;</span> <span class=
=3D"n">nowx</span> <span class=3D"o">=3D</span> <span class=3D"n">nextx</sp=
an><span class=3D"p">,</span> <span class=3D"n">nowy</span> <span class=3D"=
o">=3D</span> <span class=3D"n">nexty</span><span class=3D"p">)</span>
    <span class=3D"p">{</span>
        <span class=3D"kt">double</span> <span class=3D"n">topx</span> <spa=
n class=3D"o">=3D</span> <span class=3D"mi">0</span><span class=3D"p">,</sp=
an> <span class=3D"n">topy</span> <span class=3D"o">=3D</span> <span class=
=3D"mi">0</span><span class=3D"p">,</span> <span class=3D"n">bot</span> <sp=
an class=3D"o">=3D</span> <span class=3D"mi">0</span><span class=3D"p">;</s=
pan>
        <span class=3D"c1">//REP(i, np)</span>
        <span class=3D"k">for</span><span class=3D"p">(</span><span class=
=3D"kt">int</span> <span class=3D"n">i</span><span class=3D"o">=3D</span><s=
pan class=3D"mi">1</span><span class=3D"p">;</span><span class=3D"n">i</spa=
n><span class=3D"o">&lt;=3D</span><span class=3D"n">np</span><span class=3D=
"p">;</span><span class=3D"n">i</span><span class=3D"o">++</span><span clas=
s=3D"p">)</span>
        <span class=3D"p">{</span>
            <span class=3D"kt">double</span> <span class=3D"n">d</span> <sp=
an class=3D"o">=3D</span> <span class=3D"n">sqrt</span><span class=3D"p">(<=
/span><span class=3D"n">sqrt</span><span class=3D"p">(</span><span class=3D=
"n">nowx</span> <span class=3D"o">-</span> <span class=3D"n">p</span><span =
class=3D"p">[</span><span class=3D"n">i</span><span class=3D"p">].</span><s=
pan class=3D"n">x</span><span class=3D"p">)</span> <span class=3D"o">+</spa=
n> <span class=3D"n">sqrt</span><span class=3D"p">(</span><span class=3D"n"=
>nowy</span> <span class=3D"o">-</span> <span class=3D"n">p</span><span cla=
ss=3D"p">[</span><span class=3D"n">i</span><span class=3D"p">].</span><span=
 class=3D"n">y</span><span class=3D"p">));</span>
            <span class=3D"n">topx</span> <span class=3D"o">+=3D</span> <sp=
an class=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">i</span>=
<span class=3D"p">].</span><span class=3D"n">x</span> <span class=3D"o">/</=
span> <span class=3D"n">d</span><span class=3D"p">;</span>
            <span class=3D"n">topy</span> <span class=3D"o">+=3D</span> <sp=
an class=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">i</span>=
<span class=3D"p">].</span><span class=3D"n">y</span> <span class=3D"o">/</=
span> <span class=3D"n">d</span><span class=3D"p">;</span>
            <span class=3D"n">bot</span> <span class=3D"o">+=3D</span> <spa=
n class=3D"mi">1</span> <span class=3D"o">/</span> <span class=3D"n">d</spa=
n><span class=3D"p">;</span>
        <span class=3D"p">}</span>
        <span class=3D"n">nextx</span> <span class=3D"o">=3D</span> <span c=
lass=3D"n">topx</span> <span class=3D"o">/</span> <span class=3D"n">bot</sp=
an><span class=3D"p">;</span>
        <span class=3D"n">nexty</span> <span class=3D"o">=3D</span> <span c=
lass=3D"n">topy</span> <span class=3D"o">/</span> <span class=3D"n">bot</sp=
an><span class=3D"p">;</span>
        <span class=3D"k">if</span> <span class=3D"p">(</span><span class=
=3D"n">dcmp</span><span class=3D"p">(</span><span class=3D"n">nextx</span> =
<span class=3D"o">-</span> <span class=3D"n">nowx</span><span class=3D"p">)=
</span> <span class=3D"o">=3D=3D</span> <span class=3D"mi">0</span> <span c=
lass=3D"o">&amp;&amp;</span> <span class=3D"n">dcmp</span><span class=3D"p"=
>(</span><span class=3D"n">nexty</span> <span class=3D"o">-</span> <span cl=
ass=3D"n">nowy</span><span class=3D"p">)</span> <span class=3D"o">=3D=3D</s=
pan> <span class=3D"mi">0</span><span class=3D"p">)</span>
            <span class=3D"k">break</span><span class=3D"p">;</span>
    <span class=3D"p">}</span>
    <span class=3D"n">Point</span> <span class=3D"n">fp</span><span class=
=3D"p">;</span>
    <span class=3D"n">fp</span><span class=3D"p">.</span><span class=3D"n">=
x</span> <span class=3D"o">=3D</span> <span class=3D"n">nowx</span><span cl=
ass=3D"p">;</span>
    <span class=3D"n">fp</span><span class=3D"p">.</span><span class=3D"n">=
y</span> <span class=3D"o">=3D</span> <span class=3D"n">nowy</span><span cl=
ass=3D"p">;</span>
    <span class=3D"k">return</span> <span class=3D"n">fp</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>


<span class=3D"c1">//=E6=9C=80=E8=BF=91=E7=82=B9=E5=AF=B9</span>
<span class=3D"c1">//=E4=BD=BF=E7=94=A8=E5=89=8D=E5=85=88=E5=AF=B9=E8=BE=93=
=E5=85=A5=E7=9A=84point=E8=BF=9B=E8=A1=8C=E6=8E=92=E5=BA=8F,=E4=BD=BF=E7=94=
=A8cmpxy=E5=87=BD=E6=95=B0</span>
<span class=3D"n">Point</span> <span class=3D"n">point</span><span class=3D=
"p">[</span><span class=3D"n">N</span><span class=3D"p">];</span>
<span class=3D"kt">int</span> <span class=3D"n">tmpt</span><span class=3D"p=
">[</span><span class=3D"n">N</span><span class=3D"p">];</span>
<span class=3D"kr">inline</span> <span class=3D"kt">double</span> <span cla=
ss=3D"n">dist</span><span class=3D"p">(</span><span class=3D"kt">int</span>=
 <span class=3D"n">x</span><span class=3D"p">,</span> <span class=3D"kt">in=
t</span> <span class=3D"n">y</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"n">Point</span><span class=3D"o">&amp;</span> <span clas=
s=3D"n">a</span> <span class=3D"o">=3D</span> <span class=3D"n">point</span=
><span class=3D"p">[</span><span class=3D"n">x</span><span class=3D"p">];</=
span>
    <span class=3D"n">Point</span><span class=3D"o">&amp;</span> <span clas=
s=3D"n">b</span> <span class=3D"o">=3D</span> <span class=3D"n">point</span=
><span class=3D"p">[</span><span class=3D"n">y</span><span class=3D"p">];</=
span>
    <span class=3D"k">return</span> <span class=3D"n">sqrt</span><span clas=
s=3D"p">(</span><span class=3D"n">sqrt</span><span class=3D"p">(</span><spa=
n class=3D"n">a</span><span class=3D"p">.</span><span class=3D"n">x</span> =
<span class=3D"o">-</span> <span class=3D"n">b</span><span class=3D"p">.</s=
pan><span class=3D"n">x</span><span class=3D"p">)</span> <span class=3D"o">=
+</span> <span class=3D"n">sqrt</span><span class=3D"p">(</span><span class=
=3D"n">a</span><span class=3D"p">.</span><span class=3D"n">y</span> <span c=
lass=3D"o">-</span> <span class=3D"n">b</span><span class=3D"p">.</span><sp=
an class=3D"n">y</span><span class=3D"p">));</span>
<span class=3D"p">}</span>
<span class=3D"kr">inline</span> <span class=3D"kt">bool</span> <span class=
=3D"n">cmpxy</span><span class=3D"p">(</span><span class=3D"n">Point</span>=
 <span class=3D"n">a</span><span class=3D"p">,</span> <span class=3D"n">Poi=
nt</span> <span class=3D"n">b</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
a</span><span class=3D"p">.</span><span class=3D"n">x</span> <span class=3D=
"o">!=3D</span> <span class=3D"n">b</span><span class=3D"p">.</span><span c=
lass=3D"n">x</span><span class=3D"p">)</span>
        <span class=3D"k">return</span> <span class=3D"n">a</span><span cla=
ss=3D"p">.</span><span class=3D"n">x</span> <span class=3D"o">&lt;</span> <=
span class=3D"n">b</span><span class=3D"p">.</span><span class=3D"n">x</spa=
n><span class=3D"p">;</span>
    <span class=3D"k">return</span> <span class=3D"n">a</span><span class=
=3D"p">.</span><span class=3D"n">y</span> <span class=3D"o">&lt;</span> <sp=
an class=3D"n">b</span><span class=3D"p">.</span><span class=3D"n">y</span>=
<span class=3D"p">;</span>
<span class=3D"p">}</span>
<span class=3D"kr">inline</span> <span class=3D"kt">bool</span> <span class=
=3D"n">cmpy</span><span class=3D"p">(</span><span class=3D"kt">int</span> <=
span class=3D"n">a</span><span class=3D"p">,</span> <span class=3D"kt">int<=
/span> <span class=3D"n">b</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"k">return</span> <span class=3D"n">point</span><span cla=
ss=3D"p">[</span><span class=3D"n">a</span><span class=3D"p">].</span><span=
 class=3D"n">y</span> <span class=3D"o">&lt;</span> <span class=3D"n">point=
</span><span class=3D"p">[</span><span class=3D"n">b</span><span class=3D"p=
">].</span><span class=3D"n">y</span><span class=3D"p">;</span>
<span class=3D"p">}</span>
<span class=3D"kt">double</span> <span class=3D"n">Closest_Pair</span><span=
 class=3D"p">(</span><span class=3D"kt">int</span> <span class=3D"n">left</=
span><span class=3D"p">,</span> <span class=3D"kt">int</span> <span class=
=3D"n">right</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">double</span> <span class=3D"n">d</span> <span class=
=3D"o">=3D</span> <span class=3D"n">INF</span><span class=3D"p">;</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
left</span><span class=3D"o">=3D=3D</span><span class=3D"n">right</span><sp=
an class=3D"p">)</span>
        <span class=3D"k">return</span> <span class=3D"n">d</span><span cla=
ss=3D"p">;</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
left</span> <span class=3D"o">+</span> <span class=3D"mi">1</span> <span cl=
ass=3D"o">=3D=3D</span> <span class=3D"n">right</span><span class=3D"p">)</=
span>
        <span class=3D"k">return</span> <span class=3D"n">dist</span><span =
class=3D"p">(</span><span class=3D"n">left</span><span class=3D"p">,</span>=
 <span class=3D"n">right</span><span class=3D"p">);</span>
    <span class=3D"kt">int</span> <span class=3D"n">mid</span> <span class=
=3D"o">=3D</span> <span class=3D"p">(</span><span class=3D"n">left</span><s=
pan class=3D"o">+</span><span class=3D"n">right</span><span class=3D"p">)</=
span><span class=3D"o">&gt;&gt;</span><span class=3D"mi">1</span><span clas=
s=3D"p">;</span>
    <span class=3D"kt">double</span> <span class=3D"n">d1</span> <span clas=
s=3D"o">=3D</span> <span class=3D"n">Closest_Pair</span><span class=3D"p">(=
</span><span class=3D"n">left</span><span class=3D"p">,</span><span class=
=3D"n">mid</span><span class=3D"p">);</span>
    <span class=3D"kt">double</span> <span class=3D"n">d2</span> <span clas=
s=3D"o">=3D</span> <span class=3D"n">Closest_Pair</span><span class=3D"p">(=
</span><span class=3D"n">mid</span><span class=3D"o">+</span><span class=3D=
"mi">1</span><span class=3D"p">,</span><span class=3D"n">right</span><span =
class=3D"p">);</span>
    <span class=3D"n">d</span> <span class=3D"o">=3D</span> <span class=3D"=
n">min</span><span class=3D"p">(</span><span class=3D"n">d1</span><span cla=
ss=3D"p">,</span><span class=3D"n">d2</span><span class=3D"p">);</span>
    <span class=3D"kt">int</span> <span class=3D"n">k</span><span class=3D"=
o">=3D</span><span class=3D"mi">0</span><span class=3D"p">;</span>
    <span class=3D"c1">//=E5=88=86=E7=A6=BB=E5=87=BA=E5=AE=BD=E5=BA=A6=E4=
=B8=BAd=E7=9A=84=E5=8C=BA=E9=97=B4</span>
    <span class=3D"c1">//FE(i, left, right)</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span><span class=3D"o">=3D</span><span cl=
ass=3D"n">left</span><span class=3D"p">;</span><span class=3D"n">i</span><s=
pan class=3D"o">&lt;=3D</span><span class=3D"n">right</span><span class=3D"=
p">;</span><span class=3D"n">i</span><span class=3D"o">++</span><span class=
=3D"p">)</span>
    <span class=3D"p">{</span>
        <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D=
"n">fabs</span><span class=3D"p">(</span><span class=3D"n">point</span><spa=
n class=3D"p">[</span><span class=3D"n">mid</span><span class=3D"p">].</spa=
n><span class=3D"n">x</span><span class=3D"o">-</span><span class=3D"n">poi=
nt</span><span class=3D"p">[</span><span class=3D"n">i</span><span class=3D=
"p">].</span><span class=3D"n">x</span><span class=3D"p">)</span> <span cla=
ss=3D"o">&lt;=3D</span> <span class=3D"n">d</span><span class=3D"p">)</span=
>
            <span class=3D"n">tmpt</span><span class=3D"p">[</span><span cl=
ass=3D"n">k</span><span class=3D"o">++</span><span class=3D"p">]</span> <sp=
an class=3D"o">=3D</span> <span class=3D"n">i</span><span class=3D"p">;</sp=
an>
    <span class=3D"p">}</span>
    <span class=3D"n">sort</span><span class=3D"p">(</span><span class=3D"n=
">tmpt</span><span class=3D"p">,</span><span class=3D"n">tmpt</span><span c=
lass=3D"o">+</span><span class=3D"n">k</span><span class=3D"p">,</span><spa=
n class=3D"n">cmpy</span><span class=3D"p">);</span>
    <span class=3D"c1">//=E7=BA=BF=E6=80=A7=E6=89=AB=E6=8F=8F</span>
    <span class=3D"c1">//REP(i, k)</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span><span class=3D"o">=3D</span><span cl=
ass=3D"mi">0</span><span class=3D"p">;</span><span class=3D"n">i</span><spa=
n class=3D"o">&lt;</span><span class=3D"n">k</span><span class=3D"p">;</spa=
n><span class=3D"n">i</span><span class=3D"o">++</span><span class=3D"p">)<=
/span>
    <span class=3D"p">{</span>
        <span class=3D"k">for</span><span class=3D"p">(</span><span class=
=3D"kt">int</span> <span class=3D"n">j</span> <span class=3D"o">=3D</span> =
<span class=3D"n">i</span><span class=3D"o">+</span><span class=3D"mi">1</s=
pan><span class=3D"p">;</span> <span class=3D"n">j</span> <span class=3D"o"=
>&lt;</span> <span class=3D"n">k</span> <span class=3D"o">&amp;&amp;</span>=
 <span class=3D"n">point</span><span class=3D"p">[</span><span class=3D"n">=
tmpt</span><span class=3D"p">[</span><span class=3D"n">j</span><span class=
=3D"p">]].</span><span class=3D"n">y</span><span class=3D"o">-</span><span =
class=3D"n">point</span><span class=3D"p">[</span><span class=3D"n">tmpt</s=
pan><span class=3D"p">[</span><span class=3D"n">i</span><span class=3D"p">]=
].</span><span class=3D"n">y</span><span class=3D"o">&lt;</span><span class=
=3D"n">d</span><span class=3D"p">;</span> <span class=3D"n">j</span><span c=
lass=3D"o">++</span><span class=3D"p">)</span>
        <span class=3D"p">{</span>
            <span class=3D"kt">double</span> <span class=3D"n">d3</span> <s=
pan class=3D"o">=3D</span> <span class=3D"n">dist</span><span class=3D"p">(=
</span><span class=3D"n">tmpt</span><span class=3D"p">[</span><span class=
=3D"n">i</span><span class=3D"p">],</span><span class=3D"n">tmpt</span><spa=
n class=3D"p">[</span><span class=3D"n">j</span><span class=3D"p">]);</span=
>
            <span class=3D"k">if</span><span class=3D"p">(</span><span clas=
s=3D"n">d</span> <span class=3D"o">&gt;</span> <span class=3D"n">d3</span><=
span class=3D"p">)</span>
                <span class=3D"n">d</span> <span class=3D"o">=3D</span> <sp=
an class=3D"n">d3</span><span class=3D"p">;</span>
        <span class=3D"p">}</span>
    <span class=3D"p">}</span>
    <span class=3D"k">return</span> <span class=3D"n">d</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>


<span class=3D"cm">/************=E5=9C=86************/</span>
<span class=3D"k">struct</span> <span class=3D"n">Circle</span>
<span class=3D"p">{</span>
    <span class=3D"n">Point</span> <span class=3D"n">c</span><span class=3D=
"p">;</span>
    <span class=3D"kt">double</span> <span class=3D"n">r</span><span class=
=3D"p">;</span>
    <span class=3D"n">Circle</span><span class=3D"p">()</span> <span class=
=3D"p">{}</span>
    <span class=3D"n">Circle</span><span class=3D"p">(</span><span class=3D=
"n">Point</span> <span class=3D"n">c</span><span class=3D"p">,</span> <span=
 class=3D"kt">double</span> <span class=3D"n">r</span><span class=3D"p">)</=
span><span class=3D"o">:</span><span class=3D"n">c</span><span class=3D"p">=
(</span><span class=3D"n">c</span><span class=3D"p">),</span> <span class=
=3D"n">r</span><span class=3D"p">(</span><span class=3D"n">r</span><span cl=
ass=3D"p">)</span> <span class=3D"p">{}</span>
    <span class=3D"kr">inline</span> <span class=3D"n">Point</span> <span c=
lass=3D"n">point</span><span class=3D"p">(</span><span class=3D"kt">double<=
/span> <span class=3D"n">a</span><span class=3D"p">)</span> <span class=3D"=
c1">//=E6=A0=B9=E6=8D=AE=E5=9C=86=E5=BF=83=E8=A7=92=E6=B1=82=E7=82=B9=E5=9D=
=90=E6=A0=87</span>
    <span class=3D"p">{</span>
        <span class=3D"k">return</span> <span class=3D"n">Point</span><span=
 class=3D"p">(</span><span class=3D"n">c</span><span class=3D"p">.</span><s=
pan class=3D"n">x</span><span class=3D"o">+</span><span class=3D"n">cos</sp=
an><span class=3D"p">(</span><span class=3D"n">a</span><span class=3D"p">)<=
/span><span class=3D"o">*</span><span class=3D"n">r</span><span class=3D"p"=
>,</span> <span class=3D"n">c</span><span class=3D"p">.</span><span class=
=3D"n">y</span><span class=3D"o">+</span><span class=3D"n">sin</span><span =
class=3D"p">(</span><span class=3D"n">a</span><span class=3D"p">)</span><sp=
an class=3D"o">*</span><span class=3D"n">r</span><span class=3D"p">);</span=
>
    <span class=3D"p">}</span>
    <span class=3D"kr">inline</span> <span class=3D"kt">void</span> <span c=
lass=3D"n">read</span><span class=3D"p">()</span>
    <span class=3D"p">{</span>
        <span class=3D"n">scanf</span><span class=3D"p">(</span><span class=
=3D"s">"%lf%lf%lf"</span><span class=3D"p">,</span> <span class=3D"o">&amp;=
</span><span class=3D"n">c</span><span class=3D"p">.</span><span class=3D"n=
">x</span><span class=3D"p">,</span> <span class=3D"o">&amp;</span><span cl=
ass=3D"n">c</span><span class=3D"p">.</span><span class=3D"n">y</span><span=
 class=3D"p">,</span> <span class=3D"o">&amp;</span><span class=3D"n">r</sp=
an><span class=3D"p">);</span>
    <span class=3D"p">}</span>
<span class=3D"p">};</span>

<span class=3D"c1">//=E6=B1=82a=E7=82=B9=E5=88=B0b=E7=82=B9(=E9=80=86=E6=97=
=B6=E9=92=88)=E5=9C=A8=E7=9A=84=E5=9C=86=E4=B8=8A=E7=9A=84=E5=9C=86=E5=BC=
=A7=E9=95=BF=E5=BA=A6</span>
<span class=3D"kt">double</span> <span class=3D"n">DisOnCircle</span><span =
class=3D"p">(</span><span class=3D"n">Point</span> <span class=3D"n">a</spa=
n><span class=3D"p">,</span> <span class=3D"n">Point</span> <span class=3D"=
n">b</span><span class=3D"p">,</span> <span class=3D"n">Circle</span> <span=
 class=3D"n">C</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">double</span> <span class=3D"n">ang1</span> <span cl=
ass=3D"o">=3D</span> <span class=3D"n">angle</span><span class=3D"p">(</spa=
n><span class=3D"n">a</span> <span class=3D"o">-</span> <span class=3D"n">C=
</span><span class=3D"p">.</span><span class=3D"n">c</span><span class=3D"p=
">);</span>
    <span class=3D"kt">double</span> <span class=3D"n">ang2</span> <span cl=
ass=3D"o">=3D</span> <span class=3D"n">angle</span><span class=3D"p">(</spa=
n><span class=3D"n">b</span> <span class=3D"o">-</span> <span class=3D"n">C=
</span><span class=3D"p">.</span><span class=3D"n">c</span><span class=3D"p=
">);</span>
    <span class=3D"k">if</span> <span class=3D"p">(</span><span class=3D"n"=
>ang2</span> <span class=3D"o">&lt;</span> <span class=3D"n">ang1</span><sp=
an class=3D"p">)</span> <span class=3D"n">ang2</span> <span class=3D"o">+=
=3D</span> <span class=3D"mi">2</span> <span class=3D"o">*</span> <span cla=
ss=3D"n">PI</span><span class=3D"p">;</span>
    <span class=3D"k">return</span> <span class=3D"n">C</span><span class=
=3D"p">.</span><span class=3D"n">r</span> <span class=3D"o">*</span> <span =
class=3D"p">(</span><span class=3D"n">ang2</span> <span class=3D"o">-</span=
> <span class=3D"n">ang1</span><span class=3D"p">);</span>
<span class=3D"p">}</span>

<span class=3D"c1">//=E7=9B=B4=E7=BA=BF=E4=B8=8E=E5=9C=86=E4=BA=A4=E7=82=B9=
 =E8=BF=94=E5=9B=9E=E4=B8=AA=E6=95=B0</span>
<span class=3D"kt">int</span> <span class=3D"n">getLineCircleIntersection</=
span><span class=3D"p">(</span><span class=3D"n">Line</span> <span class=3D=
"n">L</span><span class=3D"p">,</span> <span class=3D"n">Circle</span> <spa=
n class=3D"n">C</span><span class=3D"p">,</span> <span class=3D"kt">double<=
/span><span class=3D"o">&amp;</span> <span class=3D"n">t1</span><span class=
=3D"p">,</span> <span class=3D"kt">double</span><span class=3D"o">&amp;</sp=
an> <span class=3D"n">t2</span><span class=3D"p">,</span> <span class=3D"n"=
>vector</span><span class=3D"o">&lt;</span><span class=3D"n">Point</span><s=
pan class=3D"o">&gt;&amp;</span> <span class=3D"n">sol</span><span class=3D=
"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">double</span> <span class=3D"n">a</span> <span class=
=3D"o">=3D</span> <span class=3D"n">L</span><span class=3D"p">.</span><span=
 class=3D"n">v</span><span class=3D"p">.</span><span class=3D"n">x</span><s=
pan class=3D"p">,</span> <span class=3D"n">b</span> <span class=3D"o">=3D</=
span> <span class=3D"n">L</span><span class=3D"p">.</span><span class=3D"n"=
>p</span><span class=3D"p">.</span><span class=3D"n">x</span> <span class=
=3D"o">-</span> <span class=3D"n">C</span><span class=3D"p">.</span><span c=
lass=3D"n">c</span><span class=3D"p">.</span><span class=3D"n">x</span><spa=
n class=3D"p">,</span> <span class=3D"n">c</span> <span class=3D"o">=3D</sp=
an> <span class=3D"n">L</span><span class=3D"p">.</span><span class=3D"n">v=
</span><span class=3D"p">.</span><span class=3D"n">y</span><span class=3D"p=
">,</span> <span class=3D"n">d</span> <span class=3D"o">=3D</span> <span cl=
ass=3D"n">L</span><span class=3D"p">.</span><span class=3D"n">p</span><span=
 class=3D"p">.</span><span class=3D"n">y</span> <span class=3D"o">-</span> =
<span class=3D"n">C</span><span class=3D"p">.</span><span class=3D"n">c</sp=
an><span class=3D"p">.</span><span class=3D"n">y</span><span class=3D"p">;<=
/span>
    <span class=3D"kt">double</span> <span class=3D"n">e</span> <span class=
=3D"o">=3D</span> <span class=3D"n">a</span><span class=3D"o">*</span><span=
 class=3D"n">a</span> <span class=3D"o">+</span> <span class=3D"n">c</span>=
<span class=3D"o">*</span><span class=3D"n">c</span><span class=3D"p">,</sp=
an> <span class=3D"n">f</span> <span class=3D"o">=3D</span> <span class=3D"=
mi">2</span><span class=3D"o">*</span><span class=3D"p">(</span><span class=
=3D"n">a</span><span class=3D"o">*</span><span class=3D"n">b</span> <span c=
lass=3D"o">+</span> <span class=3D"n">c</span><span class=3D"o">*</span><sp=
an class=3D"n">d</span><span class=3D"p">),</span> <span class=3D"n">g</spa=
n> <span class=3D"o">=3D</span> <span class=3D"n">b</span><span class=3D"o"=
>*</span><span class=3D"n">b</span> <span class=3D"o">+</span> <span class=
=3D"n">d</span><span class=3D"o">*</span><span class=3D"n">d</span> <span c=
lass=3D"o">-</span> <span class=3D"n">C</span><span class=3D"p">.</span><sp=
an class=3D"n">r</span><span class=3D"o">*</span><span class=3D"n">C</span>=
<span class=3D"p">.</span><span class=3D"n">r</span><span class=3D"p">;</sp=
an>
    <span class=3D"kt">double</span> <span class=3D"n">delta</span> <span c=
lass=3D"o">=3D</span> <span class=3D"n">f</span><span class=3D"o">*</span><=
span class=3D"n">f</span> <span class=3D"o">-</span> <span class=3D"mi">4</=
span><span class=3D"o">*</span><span class=3D"n">e</span><span class=3D"o">=
*</span><span class=3D"n">g</span><span class=3D"p">;</span> <span class=3D=
"c1">// =E5=88=A4=E5=88=AB=E5=BC=8F</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
dcmp</span><span class=3D"p">(</span><span class=3D"n">delta</span><span cl=
ass=3D"p">)</span> <span class=3D"o">&lt;</span> <span class=3D"mi">0</span=
><span class=3D"p">)</span> <span class=3D"k">return</span> <span class=3D"=
mi">0</span><span class=3D"p">;</span> <span class=3D"c1">// =E7=9B=B8=E7=
=A6=BB</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
dcmp</span><span class=3D"p">(</span><span class=3D"n">delta</span><span cl=
ass=3D"p">)</span> <span class=3D"o">=3D=3D</span> <span class=3D"mi">0</sp=
an><span class=3D"p">)</span>
    <span class=3D"p">{</span>
        <span class=3D"c1">// =E7=9B=B8=E5=88=87</span>
        <span class=3D"n">t1</span> <span class=3D"o">=3D</span> <span clas=
s=3D"n">t2</span> <span class=3D"o">=3D</span> <span class=3D"o">-</span><s=
pan class=3D"n">f</span> <span class=3D"o">/</span> <span class=3D"p">(</sp=
an><span class=3D"mi">2</span> <span class=3D"o">*</span> <span class=3D"n"=
>e</span><span class=3D"p">);</span>
        <span class=3D"n">sol</span><span class=3D"p">.</span><span class=
=3D"n">push_back</span><span class=3D"p">(</span><span class=3D"n">L</span>=
<span class=3D"p">.</span><span class=3D"n">point</span><span class=3D"p">(=
</span><span class=3D"n">t1</span><span class=3D"p">));</span>
        <span class=3D"k">return</span> <span class=3D"mi">1</span><span cl=
ass=3D"p">;</span>
    <span class=3D"p">}</span>
    <span class=3D"c1">// =E7=9B=B8=E4=BA=A4</span>
    <span class=3D"n">t1</span> <span class=3D"o">=3D</span> <span class=3D=
"p">(</span><span class=3D"o">-</span><span class=3D"n">f</span> <span clas=
s=3D"o">-</span> <span class=3D"n">sqrt</span><span class=3D"p">(</span><sp=
an class=3D"n">delta</span><span class=3D"p">))</span> <span class=3D"o">/<=
/span> <span class=3D"p">(</span><span class=3D"mi">2</span> <span class=3D=
"o">*</span> <span class=3D"n">e</span><span class=3D"p">);</span>
    <span class=3D"n">sol</span><span class=3D"p">.</span><span class=3D"n"=
>push_back</span><span class=3D"p">(</span><span class=3D"n">L</span><span =
class=3D"p">.</span><span class=3D"n">point</span><span class=3D"p">(</span=
><span class=3D"n">t1</span><span class=3D"p">));</span>
    <span class=3D"n">t2</span> <span class=3D"o">=3D</span> <span class=3D=
"p">(</span><span class=3D"o">-</span><span class=3D"n">f</span> <span clas=
s=3D"o">+</span> <span class=3D"n">sqrt</span><span class=3D"p">(</span><sp=
an class=3D"n">delta</span><span class=3D"p">))</span> <span class=3D"o">/<=
/span> <span class=3D"p">(</span><span class=3D"mi">2</span> <span class=3D=
"o">*</span> <span class=3D"n">e</span><span class=3D"p">);</span>
    <span class=3D"n">sol</span><span class=3D"p">.</span><span class=3D"n"=
>push_back</span><span class=3D"p">(</span><span class=3D"n">L</span><span =
class=3D"p">.</span><span class=3D"n">point</span><span class=3D"p">(</span=
><span class=3D"n">t2</span><span class=3D"p">));</span>
    <span class=3D"k">return</span> <span class=3D"mi">2</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>

<span class=3D"c1">//=E4=B8=A4=E5=9C=86=E4=BA=A4=E7=82=B9 =E8=BF=94=E5=9B=
=9E=E4=B8=AA=E6=95=B0</span>
<span class=3D"kt">int</span> <span class=3D"n">getCircleCircleIntersection=
</span><span class=3D"p">(</span><span class=3D"n">Circle</span> <span clas=
s=3D"n">C1</span><span class=3D"p">,</span> <span class=3D"n">Circle</span>=
 <span class=3D"n">C2</span><span class=3D"p">,</span> <span class=3D"n">ve=
ctor</span><span class=3D"o">&lt;</span><span class=3D"n">Point</span><span=
 class=3D"o">&gt;&amp;</span> <span class=3D"n">sol</span><span class=3D"p"=
>)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">double</span> <span class=3D"n">d</span> <span class=
=3D"o">=3D</span> <span class=3D"n">Length</span><span class=3D"p">(</span>=
<span class=3D"n">C1</span><span class=3D"p">.</span><span class=3D"n">c</s=
pan> <span class=3D"o">-</span> <span class=3D"n">C2</span><span class=3D"p=
">.</span><span class=3D"n">c</span><span class=3D"p">);</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
dcmp</span><span class=3D"p">(</span><span class=3D"n">d</span><span class=
=3D"p">)</span> <span class=3D"o">=3D=3D</span> <span class=3D"mi">0</span>=
<span class=3D"p">)</span>
    <span class=3D"p">{</span>
        <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D=
"n">dcmp</span><span class=3D"p">(</span><span class=3D"n">C1</span><span c=
lass=3D"p">.</span><span class=3D"n">r</span> <span class=3D"o">-</span> <s=
pan class=3D"n">C2</span><span class=3D"p">.</span><span class=3D"n">r</spa=
n><span class=3D"p">)</span> <span class=3D"o">=3D=3D</span> <span class=3D=
"mi">0</span><span class=3D"p">)</span> <span class=3D"k">return</span> <sp=
an class=3D"o">-</span><span class=3D"mi">1</span><span class=3D"p">;</span=
> <span class=3D"c1">// =E9=87=8D=E5=90=88=EF=BC=8C=E6=97=A0=E7=A9=B7=E5=A4=
=9A=E4=BA=A4=E7=82=B9</span>
        <span class=3D"k">return</span> <span class=3D"mi">0</span><span cl=
ass=3D"p">;</span>
    <span class=3D"p">}</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
dcmp</span><span class=3D"p">(</span><span class=3D"n">C1</span><span class=
=3D"p">.</span><span class=3D"n">r</span> <span class=3D"o">+</span> <span =
class=3D"n">C2</span><span class=3D"p">.</span><span class=3D"n">r</span> <=
span class=3D"o">-</span> <span class=3D"n">d</span><span class=3D"p">)</sp=
an> <span class=3D"o">&lt;</span> <span class=3D"mi">0</span><span class=3D=
"p">)</span> <span class=3D"k">return</span> <span class=3D"mi">0</span><sp=
an class=3D"p">;</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
dcmp</span><span class=3D"p">(</span><span class=3D"n">fabs</span><span cla=
ss=3D"p">(</span><span class=3D"n">C1</span><span class=3D"p">.</span><span=
 class=3D"n">r</span><span class=3D"o">-</span><span class=3D"n">C2</span><=
span class=3D"p">.</span><span class=3D"n">r</span><span class=3D"p">)</spa=
n> <span class=3D"o">-</span> <span class=3D"n">d</span><span class=3D"p">)=
</span> <span class=3D"o">&gt;</span> <span class=3D"mi">0</span><span clas=
s=3D"p">)</span> <span class=3D"k">return</span> <span class=3D"mi">0</span=
><span class=3D"p">;</span>


    <span class=3D"kt">double</span> <span class=3D"n">a</span> <span class=
=3D"o">=3D</span> <span class=3D"n">angle</span><span class=3D"p">(</span><=
span class=3D"n">C2</span><span class=3D"p">.</span><span class=3D"n">c</sp=
an> <span class=3D"o">-</span> <span class=3D"n">C1</span><span class=3D"p"=
>.</span><span class=3D"n">c</span><span class=3D"p">);</span>
    <span class=3D"kt">double</span> <span class=3D"n">da</span> <span clas=
s=3D"o">=3D</span> <span class=3D"n">acos</span><span class=3D"p">((</span>=
<span class=3D"n">C1</span><span class=3D"p">.</span><span class=3D"n">r</s=
pan><span class=3D"o">*</span><span class=3D"n">C1</span><span class=3D"p">=
.</span><span class=3D"n">r</span> <span class=3D"o">+</span> <span class=
=3D"n">d</span><span class=3D"o">*</span><span class=3D"n">d</span> <span c=
lass=3D"o">-</span> <span class=3D"n">C2</span><span class=3D"p">.</span><s=
pan class=3D"n">r</span><span class=3D"o">*</span><span class=3D"n">C2</spa=
n><span class=3D"p">.</span><span class=3D"n">r</span><span class=3D"p">)</=
span> <span class=3D"o">/</span> <span class=3D"p">(</span><span class=3D"m=
i">2</span><span class=3D"o">*</span><span class=3D"n">C1</span><span class=
=3D"p">.</span><span class=3D"n">r</span><span class=3D"o">*</span><span cl=
ass=3D"n">d</span><span class=3D"p">));</span>
    <span class=3D"n">Point</span> <span class=3D"n">p1</span> <span class=
=3D"o">=3D</span> <span class=3D"n">C1</span><span class=3D"p">.</span><spa=
n class=3D"n">point</span><span class=3D"p">(</span><span class=3D"n">a</sp=
an><span class=3D"o">-</span><span class=3D"n">da</span><span class=3D"p">)=
,</span> <span class=3D"n">p2</span> <span class=3D"o">=3D</span> <span cla=
ss=3D"n">C1</span><span class=3D"p">.</span><span class=3D"n">point</span><=
span class=3D"p">(</span><span class=3D"n">a</span><span class=3D"o">+</spa=
n><span class=3D"n">da</span><span class=3D"p">);</span>


    <span class=3D"n">sol</span><span class=3D"p">.</span><span class=3D"n"=
>push_back</span><span class=3D"p">(</span><span class=3D"n">p1</span><span=
 class=3D"p">);</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
p1</span> <span class=3D"o">=3D=3D</span> <span class=3D"n">p2</span><span =
class=3D"p">)</span> <span class=3D"k">return</span> <span class=3D"mi">1</=
span><span class=3D"p">;</span>
    <span class=3D"n">sol</span><span class=3D"p">.</span><span class=3D"n"=
>push_back</span><span class=3D"p">(</span><span class=3D"n">p2</span><span=
 class=3D"p">);</span>
    <span class=3D"k">return</span> <span class=3D"mi">2</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>

<span class=3D"c1">// =E8=BF=87=E7=82=B9p=E5=88=B0=E5=9C=86C=E7=9A=84=E5=88=
=87=E7=BA=BF=E3=80=82v[i]=E6=98=AF=E7=AC=ACi=E6=9D=A1=E5=88=87=E7=BA=BF=E7=
=9A=84=E5=90=91=E9=87=8F=E3=80=82=E8=BF=94=E5=9B=9E=E5=88=87=E7=BA=BF=E6=9D=
=A1=E6=95=B0</span>
<span class=3D"kt">int</span> <span class=3D"n">getTangents</span><span cla=
ss=3D"p">(</span><span class=3D"n">Point</span> <span class=3D"n">p</span><=
span class=3D"p">,</span> <span class=3D"n">Circle</span> <span class=3D"n"=
>C</span><span class=3D"p">,</span> <span class=3D"n">Vector</span><span cl=
ass=3D"o">*</span> <span class=3D"n">v</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"n">Vector</span> <span class=3D"n">u</span> <span class=
=3D"o">=3D</span> <span class=3D"n">C</span><span class=3D"p">.</span><span=
 class=3D"n">c</span> <span class=3D"o">-</span> <span class=3D"n">p</span>=
<span class=3D"p">;</span>
    <span class=3D"kt">double</span> <span class=3D"n">dist</span> <span cl=
ass=3D"o">=3D</span> <span class=3D"n">Length</span><span class=3D"p">(</sp=
an><span class=3D"n">u</span><span class=3D"p">);</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
dist</span> <span class=3D"o">&lt;</span> <span class=3D"n">C</span><span c=
lass=3D"p">.</span><span class=3D"n">r</span><span class=3D"p">)</span> <sp=
an class=3D"k">return</span> <span class=3D"mi">0</span><span class=3D"p">;=
</span>
    <span class=3D"k">else</span> <span class=3D"k">if</span><span class=3D=
"p">(</span><span class=3D"n">dcmp</span><span class=3D"p">(</span><span cl=
ass=3D"n">dist</span> <span class=3D"o">-</span> <span class=3D"n">C</span>=
<span class=3D"p">.</span><span class=3D"n">r</span><span class=3D"p">)</sp=
an> <span class=3D"o">=3D=3D</span> <span class=3D"mi">0</span><span class=
=3D"p">)</span>   <span class=3D"c1">// p=E5=9C=A8=E5=9C=86=E4=B8=8A=EF=BC=
=8C=E5=8F=AA=E6=9C=89=E4=B8=80=E6=9D=A1=E5=88=87=E7=BA=BF</span>
    <span class=3D"p">{</span>
        <span class=3D"n">v</span><span class=3D"p">[</span><span class=3D"=
mi">0</span><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span c=
lass=3D"n">Rotate</span><span class=3D"p">(</span><span class=3D"n">u</span=
><span class=3D"p">,</span> <span class=3D"n">PI</span><span class=3D"o">/<=
/span><span class=3D"mi">2</span><span class=3D"p">);</span>
        <span class=3D"k">return</span> <span class=3D"mi">1</span><span cl=
ass=3D"p">;</span>
    <span class=3D"p">}</span>
    <span class=3D"k">else</span>
    <span class=3D"p">{</span>
        <span class=3D"kt">double</span> <span class=3D"n">ang</span> <span=
 class=3D"o">=3D</span> <span class=3D"n">asin</span><span class=3D"p">(</s=
pan><span class=3D"n">C</span><span class=3D"p">.</span><span class=3D"n">r=
</span> <span class=3D"o">/</span> <span class=3D"n">dist</span><span class=
=3D"p">);</span>
        <span class=3D"n">v</span><span class=3D"p">[</span><span class=3D"=
mi">0</span><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span c=
lass=3D"n">Rotate</span><span class=3D"p">(</span><span class=3D"n">u</span=
><span class=3D"p">,</span> <span class=3D"o">-</span><span class=3D"n">ang=
</span><span class=3D"p">);</span>
        <span class=3D"n">v</span><span class=3D"p">[</span><span class=3D"=
mi">1</span><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span c=
lass=3D"n">Rotate</span><span class=3D"p">(</span><span class=3D"n">u</span=
><span class=3D"p">,</span> <span class=3D"o">+</span><span class=3D"n">ang=
</span><span class=3D"p">);</span>
        <span class=3D"k">return</span> <span class=3D"mi">2</span><span cl=
ass=3D"p">;</span>
    <span class=3D"p">}</span>
<span class=3D"p">}</span>


<span class=3D"c1">//=E4=B8=A4=E5=9C=86=E7=9A=84=E5=85=AC=E5=88=87=E7=BA=BF=
, -1=E8=A1=A8=E7=A4=BA=E6=97=A0=E7=A9=B7=E6=9D=A1=E5=88=87=E7=BA=BF</span>
<span class=3D"c1">//=E8=BF=94=E5=9B=9E=E5=88=87=E7=BA=BF=E7=9A=84=E6=9D=A1=
=E6=95=B0, -1=E8=A1=A8=E7=A4=BA=E6=97=A0=E7=A9=B7=E6=9D=A1=E5=88=87=E7=BA=
=BF</span>
<span class=3D"c1">//a[i]=E5=92=8Cb[i]=E5=88=86=E5=88=AB=E6=98=AF=E7=AC=ACi=
=E6=9D=A1=E5=88=87=E7=BA=BF=E5=9C=A8=E5=9C=86A=E5=92=8C=E5=9C=86B=E4=B8=8A=
=E7=9A=84=E5=88=87=E7=82=B9</span>
<span class=3D"kt">int</span> <span class=3D"n">getTangents</span><span cla=
ss=3D"p">(</span><span class=3D"n">Circle</span> <span class=3D"n">A</span>=
<span class=3D"p">,</span> <span class=3D"n">Circle</span> <span class=3D"n=
">B</span><span class=3D"p">,</span> <span class=3D"n">Point</span><span cl=
ass=3D"o">*</span> <span class=3D"n">a</span><span class=3D"p">,</span> <sp=
an class=3D"n">Point</span><span class=3D"o">*</span> <span class=3D"n">b</=
span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">int</span> <span class=3D"n">cnt</span> <span class=
=3D"o">=3D</span> <span class=3D"mi">0</span><span class=3D"p">;</span>
    <span class=3D"k">if</span> <span class=3D"p">(</span><span class=3D"n"=
>A</span><span class=3D"p">.</span><span class=3D"n">r</span> <span class=
=3D"o">&lt;</span> <span class=3D"n">B</span><span class=3D"p">.</span><spa=
n class=3D"n">r</span><span class=3D"p">)</span> <span class=3D"n">swap</sp=
an><span class=3D"p">(</span><span class=3D"n">A</span><span class=3D"p">,<=
/span> <span class=3D"n">B</span><span class=3D"p">),</span> <span class=3D=
"n">swap</span><span class=3D"p">(</span><span class=3D"n">a</span><span cl=
ass=3D"p">,</span> <span class=3D"n">b</span><span class=3D"p">);</span>
    <span class=3D"c1">///****************************</span>
    <span class=3D"kt">int</span> <span class=3D"n">d2</span> <span class=
=3D"o">=3D</span> <span class=3D"p">(</span><span class=3D"n">A</span><span=
 class=3D"p">.</span><span class=3D"n">c</span><span class=3D"p">.</span><s=
pan class=3D"n">x</span> <span class=3D"o">-</span> <span class=3D"n">B</sp=
an><span class=3D"p">.</span><span class=3D"n">c</span><span class=3D"p">.<=
/span><span class=3D"n">x</span><span class=3D"p">)</span> <span class=3D"o=
">*</span> <span class=3D"p">(</span><span class=3D"n">A</span><span class=
=3D"p">.</span><span class=3D"n">c</span><span class=3D"p">.</span><span cl=
ass=3D"n">x</span> <span class=3D"o">-</span> <span class=3D"n">B</span><sp=
an class=3D"p">.</span><span class=3D"n">c</span><span class=3D"p">.</span>=
<span class=3D"n">x</span><span class=3D"p">)</span> <span class=3D"o">+</s=
pan> <span class=3D"p">(</span><span class=3D"n">A</span><span class=3D"p">=
.</span><span class=3D"n">c</span><span class=3D"p">.</span><span class=3D"=
n">y</span> <span class=3D"o">-</span> <span class=3D"n">B</span><span clas=
s=3D"p">.</span><span class=3D"n">c</span><span class=3D"p">.</span><span c=
lass=3D"n">y</span><span class=3D"p">)</span> <span class=3D"o">*</span> <s=
pan class=3D"p">(</span><span class=3D"n">A</span><span class=3D"p">.</span=
><span class=3D"n">c</span><span class=3D"p">.</span><span class=3D"n">y</s=
pan> <span class=3D"o">-</span> <span class=3D"n">B</span><span class=3D"p"=
>.</span><span class=3D"n">c</span><span class=3D"p">.</span><span class=3D=
"n">y</span><span class=3D"p">);</span>
    <span class=3D"kt">int</span> <span class=3D"n">rdiff</span> <span clas=
s=3D"o">=3D</span> <span class=3D"n">A</span><span class=3D"p">.</span><spa=
n class=3D"n">r</span> <span class=3D"o">-</span> <span class=3D"n">B</span=
><span class=3D"p">.</span><span class=3D"n">r</span><span class=3D"p">;</s=
pan>
    <span class=3D"kt">int</span> <span class=3D"n">rsum</span> <span class=
=3D"o">=3D</span> <span class=3D"n">A</span><span class=3D"p">.</span><span=
 class=3D"n">r</span> <span class=3D"o">+</span> <span class=3D"n">B</span>=
<span class=3D"p">.</span><span class=3D"n">r</span><span class=3D"p">;</sp=
an>
    <span class=3D"k">if</span> <span class=3D"p">(</span><span class=3D"n"=
>d2</span> <span class=3D"o">&lt;</span> <span class=3D"n">rdiff</span> <sp=
an class=3D"o">*</span> <span class=3D"n">rdiff</span><span class=3D"p">)</=
span> <span class=3D"k">return</span> <span class=3D"mi">0</span><span clas=
s=3D"p">;</span>   <span class=3D"c1">//=E5=86=85=E5=90=AB</span>

    <span class=3D"c1">///***************************************</span>
    <span class=3D"kt">double</span> <span class=3D"n">base</span> <span cl=
ass=3D"o">=3D</span> <span class=3D"n">atan2</span><span class=3D"p">(</spa=
n><span class=3D"n">B</span><span class=3D"p">.</span><span class=3D"n">c</=
span><span class=3D"p">.</span><span class=3D"n">y</span> <span class=3D"o"=
>-</span> <span class=3D"n">A</span><span class=3D"p">.</span><span class=
=3D"n">c</span><span class=3D"p">.</span><span class=3D"n">y</span><span cl=
ass=3D"p">,</span> <span class=3D"n">B</span><span class=3D"p">.</span><spa=
n class=3D"n">c</span><span class=3D"p">.</span><span class=3D"n">x</span> =
<span class=3D"o">-</span> <span class=3D"n">A</span><span class=3D"p">.</s=
pan><span class=3D"n">c</span><span class=3D"p">.</span><span class=3D"n">x=
</span><span class=3D"p">);</span>
    <span class=3D"k">if</span> <span class=3D"p">(</span><span class=3D"n"=
>d2</span> <span class=3D"o">=3D=3D</span> <span class=3D"mi">0</span> <spa=
n class=3D"o">&amp;&amp;</span> <span class=3D"n">A</span><span class=3D"p"=
>.</span><span class=3D"n">r</span> <span class=3D"o">=3D=3D</span> <span c=
lass=3D"n">B</span><span class=3D"p">.</span><span class=3D"n">r</span><spa=
n class=3D"p">)</span> <span class=3D"k">return</span> <span class=3D"o">-<=
/span><span class=3D"mi">1</span><span class=3D"p">;</span>    <span class=
=3D"c1">//=E6=97=A0=E7=BA=BF=E5=A4=9A=E6=9D=A1=E5=88=87=E7=BA=BF</span>
    <span class=3D"k">if</span> <span class=3D"p">(</span><span class=3D"n"=
>d2</span> <span class=3D"o">=3D=3D</span> <span class=3D"n">rdiff</span> <=
span class=3D"o">*</span> <span class=3D"n">rdiff</span><span class=3D"p">)=
</span>    <span class=3D"c1">//=E5=86=85=E5=88=87, 1=E6=9D=A1=E5=88=87=E7=
=BA=BF</span>
    <span class=3D"p">{</span>
        <span class=3D"c1">///**********************</span>
        <span class=3D"n">a</span><span class=3D"p">[</span><span class=3D"=
n">cnt</span><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span =
class=3D"n">A</span><span class=3D"p">.</span><span class=3D"n">point</span=
><span class=3D"p">(</span><span class=3D"n">base</span><span class=3D"p">)=
;</span> <span class=3D"n">b</span><span class=3D"p">[</span><span class=3D=
"n">cnt</span><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span=
 class=3D"n">B</span><span class=3D"p">.</span><span class=3D"n">point</spa=
n><span class=3D"p">(</span><span class=3D"n">base</span><span class=3D"p">=
);</span> <span class=3D"n">cnt</span><span class=3D"o">++</span><span clas=
s=3D"p">;</span>
        <span class=3D"k">return</span> <span class=3D"mi">1</span><span cl=
ass=3D"p">;</span>
    <span class=3D"p">}</span>
    <span class=3D"c1">//=E6=9C=89=E5=A4=96=E5=85=AC=E5=88=87=E7=BA=BF</spa=
n>
    <span class=3D"kt">double</span> <span class=3D"n">ang</span> <span cla=
ss=3D"o">=3D</span> <span class=3D"n">acos</span><span class=3D"p">((</span=
><span class=3D"n">A</span><span class=3D"p">.</span><span class=3D"n">r</s=
pan> <span class=3D"o">-</span> <span class=3D"n">B</span><span class=3D"p"=
>.</span><span class=3D"n">r</span><span class=3D"p">)</span> <span class=
=3D"o">/</span> <span class=3D"n">sqrt</span><span class=3D"p">(</span><spa=
n class=3D"n">d2</span> <span class=3D"o">*</span> <span class=3D"mf">1.0</=
span><span class=3D"p">));</span>
    <span class=3D"n">a</span><span class=3D"p">[</span><span class=3D"n">c=
nt</span><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span clas=
s=3D"n">A</span><span class=3D"p">.</span><span class=3D"n">point</span><sp=
an class=3D"p">(</span><span class=3D"n">base</span> <span class=3D"o">+</s=
pan> <span class=3D"n">ang</span><span class=3D"p">);</span> <span class=3D=
"n">b</span><span class=3D"p">[</span><span class=3D"n">cnt</span><span cla=
ss=3D"p">]</span> <span class=3D"o">=3D</span> <span class=3D"n">B</span><s=
pan class=3D"p">.</span><span class=3D"n">point</span><span class=3D"p">(</=
span><span class=3D"n">base</span> <span class=3D"o">+</span> <span class=
=3D"n">ang</span><span class=3D"p">);</span> <span class=3D"n">cnt</span><s=
pan class=3D"o">++</span><span class=3D"p">;</span>
    <span class=3D"n">a</span><span class=3D"p">[</span><span class=3D"n">c=
nt</span><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span clas=
s=3D"n">A</span><span class=3D"p">.</span><span class=3D"n">point</span><sp=
an class=3D"p">(</span><span class=3D"n">base</span> <span class=3D"o">-</s=
pan> <span class=3D"n">ang</span><span class=3D"p">);</span> <span class=3D=
"n">b</span><span class=3D"p">[</span><span class=3D"n">cnt</span><span cla=
ss=3D"p">]</span> <span class=3D"o">=3D</span> <span class=3D"n">B</span><s=
pan class=3D"p">.</span><span class=3D"n">point</span><span class=3D"p">(</=
span><span class=3D"n">base</span> <span class=3D"o">-</span> <span class=
=3D"n">ang</span><span class=3D"p">);</span> <span class=3D"n">cnt</span><s=
pan class=3D"o">++</span><span class=3D"p">;</span>
    <span class=3D"k">if</span> <span class=3D"p">(</span><span class=3D"n"=
>d2</span> <span class=3D"o">=3D=3D</span> <span class=3D"n">rsum</span> <s=
pan class=3D"o">*</span> <span class=3D"n">rsum</span><span class=3D"p">)</=
span>  <span class=3D"c1">//=E4=B8=80=E6=9D=A1=E5=86=85=E5=85=AC=E5=88=87=
=E7=BA=BF</span>
    <span class=3D"p">{</span>
        <span class=3D"n">a</span><span class=3D"p">[</span><span class=3D"=
n">cnt</span><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span =
class=3D"n">A</span><span class=3D"p">.</span><span class=3D"n">point</span=
><span class=3D"p">(</span><span class=3D"n">base</span><span class=3D"p">)=
;</span> <span class=3D"n">b</span><span class=3D"p">[</span><span class=3D=
"n">cnt</span><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span=
 class=3D"n">B</span><span class=3D"p">.</span><span class=3D"n">point</spa=
n><span class=3D"p">(</span><span class=3D"n">PI</span> <span class=3D"o">+=
</span> <span class=3D"n">base</span><span class=3D"p">);</span> <span clas=
s=3D"n">cnt</span><span class=3D"o">++</span><span class=3D"p">;</span>
    <span class=3D"p">}</span>
    <span class=3D"k">else</span> <span class=3D"k">if</span> <span class=
=3D"p">(</span><span class=3D"n">d2</span> <span class=3D"o">&gt;</span> <s=
pan class=3D"n">rsum</span> <span class=3D"o">*</span> <span class=3D"n">rs=
um</span><span class=3D"p">)</span>  <span class=3D"c1">//=E4=B8=A4=E6=9D=
=A1=E5=86=85=E5=85=AC=E5=88=87=E7=BA=BF</span>
    <span class=3D"p">{</span>
        <span class=3D"kt">double</span> <span class=3D"n">ang</span> <span=
 class=3D"o">=3D</span> <span class=3D"n">acos</span><span class=3D"p">((</=
span><span class=3D"n">A</span><span class=3D"p">.</span><span class=3D"n">=
r</span> <span class=3D"o">+</span> <span class=3D"n">B</span><span class=
=3D"p">.</span><span class=3D"n">r</span><span class=3D"p">)</span> <span c=
lass=3D"o">/</span> <span class=3D"n">sqrt</span><span class=3D"p">(</span>=
<span class=3D"n">d2</span> <span class=3D"o">*</span> <span class=3D"mf">1=
.0</span><span class=3D"p">));</span>
        <span class=3D"n">a</span><span class=3D"p">[</span><span class=3D"=
n">cnt</span><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span =
class=3D"n">A</span><span class=3D"p">.</span><span class=3D"n">point</span=
><span class=3D"p">(</span><span class=3D"n">base</span> <span class=3D"o">=
+</span> <span class=3D"n">ang</span><span class=3D"p">);</span> <span clas=
s=3D"n">b</span><span class=3D"p">[</span><span class=3D"n">cnt</span><span=
 class=3D"p">]</span> <span class=3D"o">=3D</span> <span class=3D"n">B</spa=
n><span class=3D"p">.</span><span class=3D"n">point</span><span class=3D"p"=
>(</span><span class=3D"n">PI</span> <span class=3D"o">+</span> <span class=
=3D"n">base</span> <span class=3D"o">+</span> <span class=3D"n">ang</span><=
span class=3D"p">);</span> <span class=3D"n">cnt</span><span class=3D"o">++=
</span><span class=3D"p">;</span>
        <span class=3D"n">a</span><span class=3D"p">[</span><span class=3D"=
n">cnt</span><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span =
class=3D"n">A</span><span class=3D"p">.</span><span class=3D"n">point</span=
><span class=3D"p">(</span><span class=3D"n">base</span> <span class=3D"o">=
-</span> <span class=3D"n">ang</span><span class=3D"p">);</span> <span clas=
s=3D"n">b</span><span class=3D"p">[</span><span class=3D"n">cnt</span><span=
 class=3D"p">]</span> <span class=3D"o">=3D</span> <span class=3D"n">B</spa=
n><span class=3D"p">.</span><span class=3D"n">point</span><span class=3D"p"=
>(</span><span class=3D"n">PI</span> <span class=3D"o">+</span> <span class=
=3D"n">base</span> <span class=3D"o">-</span> <span class=3D"n">ang</span><=
span class=3D"p">);</span> <span class=3D"n">cnt</span><span class=3D"o">++=
</span><span class=3D"p">;</span>
    <span class=3D"p">}</span>
    <span class=3D"k">return</span> <span class=3D"n">cnt</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>


<span class=3D"c1">// =E8=BF=87=E7=82=B9p=E5=88=B0=E5=9C=86C=E7=9A=84=E5=88=
=87=E7=82=B9</span>
<span class=3D"kt">int</span> <span class=3D"n">getTangentPoints</span><spa=
n class=3D"p">(</span><span class=3D"n">Point</span> <span class=3D"n">p</s=
pan><span class=3D"p">,</span> <span class=3D"n">Circle</span> <span class=
=3D"n">C</span><span class=3D"p">,</span> <span class=3D"n">vector</span><s=
pan class=3D"o">&lt;</span><span class=3D"n">Point</span><span class=3D"o">=
&gt;&amp;</span> <span class=3D"n">v</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"n">Vector</span> <span class=3D"n">u</span> <span class=
=3D"o">=3D</span> <span class=3D"n">C</span><span class=3D"p">.</span><span=
 class=3D"n">c</span> <span class=3D"o">-</span> <span class=3D"n">p</span>=
<span class=3D"p">;</span>
    <span class=3D"kt">double</span> <span class=3D"n">dist</span> <span cl=
ass=3D"o">=3D</span> <span class=3D"n">Length</span><span class=3D"p">(</sp=
an><span class=3D"n">u</span><span class=3D"p">);</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
dist</span> <span class=3D"o">&lt;</span> <span class=3D"n">C</span><span c=
lass=3D"p">.</span><span class=3D"n">r</span><span class=3D"p">)</span> <sp=
an class=3D"k">return</span> <span class=3D"mi">0</span><span class=3D"p">;=
</span>
    <span class=3D"k">else</span> <span class=3D"k">if</span><span class=3D=
"p">(</span><span class=3D"n">dcmp</span><span class=3D"p">(</span><span cl=
ass=3D"n">dist</span> <span class=3D"o">-</span> <span class=3D"n">C</span>=
<span class=3D"p">.</span><span class=3D"n">r</span><span class=3D"p">)</sp=
an> <span class=3D"o">=3D=3D</span> <span class=3D"mi">0</span><span class=
=3D"p">)</span>   <span class=3D"c1">// p=E5=9C=A8=E5=9C=86=E4=B8=8A=EF=BC=
=8C=E5=8F=AA=E6=9C=89=E4=B8=80=E6=9D=A1=E5=88=87=E7=BA=BF</span>
    <span class=3D"p">{</span>
        <span class=3D"n">v</span><span class=3D"p">.</span><span class=3D"=
n">push_back</span><span class=3D"p">(</span><span class=3D"n">p</span><spa=
n class=3D"p">);</span>
        <span class=3D"k">return</span> <span class=3D"mi">1</span><span cl=
ass=3D"p">;</span>
    <span class=3D"p">}</span>
    <span class=3D"k">else</span>
    <span class=3D"p">{</span>
        <span class=3D"kt">double</span> <span class=3D"n">ang</span> <span=
 class=3D"o">=3D</span> <span class=3D"n">asin</span><span class=3D"p">(</s=
pan><span class=3D"n">C</span><span class=3D"p">.</span><span class=3D"n">r=
</span> <span class=3D"o">/</span> <span class=3D"n">dist</span><span class=
=3D"p">);</span>
        <span class=3D"kt">double</span> <span class=3D"n">d</span> <span c=
lass=3D"o">=3D</span> <span class=3D"n">sqrt</span><span class=3D"p">(</spa=
n><span class=3D"n">dist</span> <span class=3D"o">*</span> <span class=3D"n=
">dist</span> <span class=3D"o">-</span> <span class=3D"n">C</span><span cl=
ass=3D"p">.</span><span class=3D"n">r</span> <span class=3D"o">*</span> <sp=
an class=3D"n">C</span><span class=3D"p">.</span><span class=3D"n">r</span>=
<span class=3D"p">);</span>
        <span class=3D"n">v</span><span class=3D"p">.</span><span class=3D"=
n">push_back</span><span class=3D"p">(</span><span class=3D"n">p</span> <sp=
an class=3D"o">+</span> <span class=3D"n">Unit</span><span class=3D"p">(</s=
pan><span class=3D"n">Rotate</span><span class=3D"p">(</span><span class=3D=
"n">u</span><span class=3D"p">,</span> <span class=3D"o">-</span><span clas=
s=3D"n">ang</span><span class=3D"p">))</span> <span class=3D"o">*</span> <s=
pan class=3D"n">d</span><span class=3D"p">);</span>
        <span class=3D"n">v</span><span class=3D"p">.</span><span class=3D"=
n">push_back</span><span class=3D"p">(</span><span class=3D"n">p</span> <sp=
an class=3D"o">+</span> <span class=3D"n">Unit</span><span class=3D"p">(</s=
pan><span class=3D"n">Rotate</span><span class=3D"p">(</span><span class=3D=
"n">u</span><span class=3D"p">,</span> <span class=3D"o">+</span><span clas=
s=3D"n">ang</span><span class=3D"p">))</span> <span class=3D"o">*</span> <s=
pan class=3D"n">d</span><span class=3D"p">);</span>
        <span class=3D"k">return</span> <span class=3D"mi">2</span><span cl=
ass=3D"p">;</span>
    <span class=3D"p">}</span>
<span class=3D"p">}</span>

<span class=3D"c1">//=E5=9C=86A=E4=B8=8E=E5=9C=86B=E7=9A=84=E5=88=87=E7=82=
=B9</span>
<span class=3D"kt">void</span> <span class=3D"n">getTangentPoints</span><sp=
an class=3D"p">(</span><span class=3D"n">Circle</span> <span class=3D"n">A<=
/span><span class=3D"p">,</span> <span class=3D"n">Circle</span> <span clas=
s=3D"n">B</span><span class=3D"p">,</span> <span class=3D"n">vector</span><=
span class=3D"o">&lt;</span><span class=3D"n">Point</span><span class=3D"o"=
>&gt;&amp;</span> <span class=3D"n">a</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"k">if</span> <span class=3D"p">(</span><span class=3D"n"=
>A</span><span class=3D"p">.</span><span class=3D"n">r</span> <span class=
=3D"o">&lt;</span> <span class=3D"n">B</span><span class=3D"p">.</span><spa=
n class=3D"n">r</span><span class=3D"p">)</span> <span class=3D"n">swap</sp=
an><span class=3D"p">(</span><span class=3D"n">A</span><span class=3D"p">,<=
/span> <span class=3D"n">B</span><span class=3D"p">);</span>
    <span class=3D"c1">///****************************</span>
    <span class=3D"kt">int</span> <span class=3D"n">d2</span> <span class=
=3D"o">=3D</span> <span class=3D"n">sqrt</span><span class=3D"p">(</span><s=
pan class=3D"n">A</span><span class=3D"p">.</span><span class=3D"n">c</span=
><span class=3D"p">.</span><span class=3D"n">x</span> <span class=3D"o">-</=
span> <span class=3D"n">B</span><span class=3D"p">.</span><span class=3D"n"=
>c</span><span class=3D"p">.</span><span class=3D"n">x</span><span class=3D=
"p">)</span> <span class=3D"o">+</span> <span class=3D"n">sqrt</span><span =
class=3D"p">(</span><span class=3D"n">A</span><span class=3D"p">.</span><sp=
an class=3D"n">c</span><span class=3D"p">.</span><span class=3D"n">y</span>=
 <span class=3D"o">-</span> <span class=3D"n">B</span><span class=3D"p">.</=
span><span class=3D"n">c</span><span class=3D"p">.</span><span class=3D"n">=
y</span><span class=3D"p">);</span>
    <span class=3D"kt">int</span> <span class=3D"n">rdiff</span> <span clas=
s=3D"o">=3D</span> <span class=3D"n">A</span><span class=3D"p">.</span><spa=
n class=3D"n">r</span> <span class=3D"o">-</span> <span class=3D"n">B</span=
><span class=3D"p">.</span><span class=3D"n">r</span><span class=3D"p">,</s=
pan> <span class=3D"n">rsum</span> <span class=3D"o">=3D</span> <span class=
=3D"n">A</span><span class=3D"p">.</span><span class=3D"n">r</span> <span c=
lass=3D"o">+</span> <span class=3D"n">B</span><span class=3D"p">.</span><sp=
an class=3D"n">r</span><span class=3D"p">;</span>
    <span class=3D"k">if</span> <span class=3D"p">(</span><span class=3D"n"=
>d2</span> <span class=3D"o">&lt;</span> <span class=3D"n">rdiff</span> <sp=
an class=3D"o">*</span> <span class=3D"n">rdiff</span><span class=3D"p">)</=
span> <span class=3D"k">return</span><span class=3D"p">;</span>   <span cla=
ss=3D"c1">//=E5=86=85=E5=90=AB</span>

    <span class=3D"c1">///***************************************</span>
    <span class=3D"kt">double</span> <span class=3D"n">base</span> <span cl=
ass=3D"o">=3D</span> <span class=3D"n">atan2</span><span class=3D"p">(</spa=
n><span class=3D"n">B</span><span class=3D"p">.</span><span class=3D"n">c</=
span><span class=3D"p">.</span><span class=3D"n">y</span> <span class=3D"o"=
>-</span> <span class=3D"n">A</span><span class=3D"p">.</span><span class=
=3D"n">c</span><span class=3D"p">.</span><span class=3D"n">y</span><span cl=
ass=3D"p">,</span> <span class=3D"n">B</span><span class=3D"p">.</span><spa=
n class=3D"n">c</span><span class=3D"p">.</span><span class=3D"n">x</span> =
<span class=3D"o">-</span> <span class=3D"n">A</span><span class=3D"p">.</s=
pan><span class=3D"n">c</span><span class=3D"p">.</span><span class=3D"n">x=
</span><span class=3D"p">);</span>
    <span class=3D"k">if</span> <span class=3D"p">(</span><span class=3D"n"=
>d2</span> <span class=3D"o">=3D=3D</span> <span class=3D"mi">0</span> <spa=
n class=3D"o">&amp;&amp;</span> <span class=3D"n">A</span><span class=3D"p"=
>.</span><span class=3D"n">r</span> <span class=3D"o">=3D=3D</span> <span c=
lass=3D"n">B</span><span class=3D"p">.</span><span class=3D"n">r</span><spa=
n class=3D"p">)</span> <span class=3D"k">return</span><span class=3D"p">;</=
span>    <span class=3D"c1">//=E6=97=A0=E7=BA=BF=E5=A4=9A=E6=9D=A1=E5=88=87=
=E7=BA=BF</span>
    <span class=3D"k">if</span> <span class=3D"p">(</span><span class=3D"n"=
>d2</span> <span class=3D"o">=3D=3D</span> <span class=3D"n">rdiff</span> <=
span class=3D"o">*</span> <span class=3D"n">rdiff</span><span class=3D"p">)=
</span>    <span class=3D"c1">//=E5=86=85=E5=88=87, 1=E6=9D=A1=E5=88=87=E7=
=BA=BF</span>
    <span class=3D"p">{</span>
        <span class=3D"c1">///**********************</span>
        <span class=3D"n">a</span><span class=3D"p">.</span><span class=3D"=
n">push_back</span><span class=3D"p">(</span><span class=3D"n">A</span><spa=
n class=3D"p">.</span><span class=3D"n">point</span><span class=3D"p">(</sp=
an><span class=3D"n">base</span><span class=3D"p">));</span>
        <span class=3D"n">a</span><span class=3D"p">.</span><span class=3D"=
n">push_back</span><span class=3D"p">(</span><span class=3D"n">B</span><spa=
n class=3D"p">.</span><span class=3D"n">point</span><span class=3D"p">(</sp=
an><span class=3D"n">base</span><span class=3D"p">));</span>
        <span class=3D"k">return</span><span class=3D"p">;</span>
    <span class=3D"p">}</span>
    <span class=3D"c1">//=E6=9C=89=E5=A4=96=E5=85=AC=E5=88=87=E7=BA=BF</spa=
n>
    <span class=3D"kt">double</span> <span class=3D"n">ang</span> <span cla=
ss=3D"o">=3D</span> <span class=3D"n">acos</span><span class=3D"p">((</span=
><span class=3D"n">A</span><span class=3D"p">.</span><span class=3D"n">r</s=
pan> <span class=3D"o">-</span> <span class=3D"n">B</span><span class=3D"p"=
>.</span><span class=3D"n">r</span><span class=3D"p">)</span> <span class=
=3D"o">/</span> <span class=3D"n">sqrt</span><span class=3D"p">(</span><spa=
n class=3D"n">d2</span> <span class=3D"o">*</span> <span class=3D"mf">1.0</=
span><span class=3D"p">));</span>
    <span class=3D"n">a</span><span class=3D"p">.</span><span class=3D"n">p=
ush_back</span><span class=3D"p">(</span><span class=3D"n">A</span><span cl=
ass=3D"p">.</span><span class=3D"n">point</span><span class=3D"p">(</span><=
span class=3D"n">base</span> <span class=3D"o">+</span> <span class=3D"n">a=
ng</span><span class=3D"p">));</span> <span class=3D"n">a</span><span class=
=3D"p">.</span><span class=3D"n">push_back</span><span class=3D"p">(</span>=
<span class=3D"n">B</span><span class=3D"p">.</span><span class=3D"n">point=
</span><span class=3D"p">(</span><span class=3D"n">base</span> <span class=
=3D"o">+</span> <span class=3D"n">ang</span><span class=3D"p">));</span>
    <span class=3D"n">a</span><span class=3D"p">.</span><span class=3D"n">p=
ush_back</span><span class=3D"p">(</span><span class=3D"n">A</span><span cl=
ass=3D"p">.</span><span class=3D"n">point</span><span class=3D"p">(</span><=
span class=3D"n">base</span> <span class=3D"o">-</span> <span class=3D"n">a=
ng</span><span class=3D"p">));</span> <span class=3D"n">a</span><span class=
=3D"p">.</span><span class=3D"n">push_back</span><span class=3D"p">(</span>=
<span class=3D"n">B</span><span class=3D"p">.</span><span class=3D"n">point=
</span><span class=3D"p">(</span><span class=3D"n">base</span> <span class=
=3D"o">-</span> <span class=3D"n">ang</span><span class=3D"p">));</span>
    <span class=3D"k">if</span> <span class=3D"p">(</span><span class=3D"n"=
>d2</span> <span class=3D"o">=3D=3D</span> <span class=3D"n">rsum</span> <s=
pan class=3D"o">*</span> <span class=3D"n">rsum</span><span class=3D"p">)</=
span>  <span class=3D"c1">//=E4=B8=80=E6=9D=A1=E5=86=85=E5=85=AC=E5=88=87=
=E7=BA=BF</span>
    <span class=3D"p">{</span>
        <span class=3D"n">a</span><span class=3D"p">.</span><span class=3D"=
n">push_back</span><span class=3D"p">(</span><span class=3D"n">A</span><spa=
n class=3D"p">.</span><span class=3D"n">point</span><span class=3D"p">(</sp=
an><span class=3D"n">base</span><span class=3D"p">));</span>
        <span class=3D"n">a</span><span class=3D"p">.</span><span class=3D"=
n">push_back</span><span class=3D"p">(</span><span class=3D"n">B</span><spa=
n class=3D"p">.</span><span class=3D"n">point</span><span class=3D"p">(</sp=
an><span class=3D"n">PI</span> <span class=3D"o">+</span> <span class=3D"n"=
>base</span><span class=3D"p">));</span>
    <span class=3D"p">}</span>
    <span class=3D"k">else</span> <span class=3D"k">if</span> <span class=
=3D"p">(</span><span class=3D"n">d2</span> <span class=3D"o">&gt;</span> <s=
pan class=3D"n">rsum</span> <span class=3D"o">*</span> <span class=3D"n">rs=
um</span><span class=3D"p">)</span>  <span class=3D"c1">//=E4=B8=A4=E6=9D=
=A1=E5=86=85=E5=85=AC=E5=88=87=E7=BA=BF</span>
    <span class=3D"p">{</span>
        <span class=3D"kt">double</span> <span class=3D"n">ang</span> <span=
 class=3D"o">=3D</span> <span class=3D"n">acos</span><span class=3D"p">((</=
span><span class=3D"n">A</span><span class=3D"p">.</span><span class=3D"n">=
r</span> <span class=3D"o">+</span> <span class=3D"n">B</span><span class=
=3D"p">.</span><span class=3D"n">r</span><span class=3D"p">)</span> <span c=
lass=3D"o">/</span> <span class=3D"n">sqrt</span><span class=3D"p">(</span>=
<span class=3D"n">d2</span> <span class=3D"o">*</span> <span class=3D"mf">1=
.0</span><span class=3D"p">));</span>
        <span class=3D"n">a</span><span class=3D"p">.</span><span class=3D"=
n">push_back</span><span class=3D"p">(</span><span class=3D"n">A</span><spa=
n class=3D"p">.</span><span class=3D"n">point</span><span class=3D"p">(</sp=
an><span class=3D"n">base</span> <span class=3D"o">+</span> <span class=3D"=
n">ang</span><span class=3D"p">));</span>
        <span class=3D"n">a</span><span class=3D"p">.</span><span class=3D"=
n">push_back</span><span class=3D"p">(</span><span class=3D"n">B</span><spa=
n class=3D"p">.</span><span class=3D"n">point</span><span class=3D"p">(</sp=
an><span class=3D"n">PI</span> <span class=3D"o">+</span> <span class=3D"n"=
>base</span> <span class=3D"o">+</span> <span class=3D"n">ang</span><span c=
lass=3D"p">));</span>
        <span class=3D"n">a</span><span class=3D"p">.</span><span class=3D"=
n">push_back</span><span class=3D"p">(</span><span class=3D"n">A</span><spa=
n class=3D"p">.</span><span class=3D"n">point</span><span class=3D"p">(</sp=
an><span class=3D"n">base</span> <span class=3D"o">-</span> <span class=3D"=
n">ang</span><span class=3D"p">));</span>
        <span class=3D"n">a</span><span class=3D"p">.</span><span class=3D"=
n">push_back</span><span class=3D"p">(</span><span class=3D"n">B</span><spa=
n class=3D"p">.</span><span class=3D"n">point</span><span class=3D"p">(</sp=
an><span class=3D"n">PI</span> <span class=3D"o">+</span> <span class=3D"n"=
>base</span> <span class=3D"o">-</span> <span class=3D"n">ang</span><span c=
lass=3D"p">));</span>
    <span class=3D"p">}</span>
<span class=3D"p">}</span>


<span class=3D"c1">//=E4=B8=89=E8=A7=92=E5=BD=A2=E5=A4=96=E6=8E=A5=E5=9C=86=
</span>
<span class=3D"n">Circle</span> <span class=3D"n">CircumscribedCircle</span=
><span class=3D"p">(</span><span class=3D"n">Point</span> <span class=3D"n"=
>p1</span><span class=3D"p">,</span> <span class=3D"n">Point</span> <span c=
lass=3D"n">p2</span><span class=3D"p">,</span> <span class=3D"n">Point</spa=
n> <span class=3D"n">p3</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">double</span> <span class=3D"n">Bx</span> <span clas=
s=3D"o">=3D</span> <span class=3D"n">p2</span><span class=3D"p">.</span><sp=
an class=3D"n">x</span><span class=3D"o">-</span><span class=3D"n">p1</span=
><span class=3D"p">.</span><span class=3D"n">x</span><span class=3D"p">,</s=
pan> <span class=3D"n">By</span> <span class=3D"o">=3D</span> <span class=
=3D"n">p2</span><span class=3D"p">.</span><span class=3D"n">y</span><span c=
lass=3D"o">-</span><span class=3D"n">p1</span><span class=3D"p">.</span><sp=
an class=3D"n">y</span><span class=3D"p">;</span>
    <span class=3D"kt">double</span> <span class=3D"n">Cx</span> <span clas=
s=3D"o">=3D</span> <span class=3D"n">p3</span><span class=3D"p">.</span><sp=
an class=3D"n">x</span><span class=3D"o">-</span><span class=3D"n">p1</span=
><span class=3D"p">.</span><span class=3D"n">x</span><span class=3D"p">,</s=
pan> <span class=3D"n">Cy</span> <span class=3D"o">=3D</span> <span class=
=3D"n">p3</span><span class=3D"p">.</span><span class=3D"n">y</span><span c=
lass=3D"o">-</span><span class=3D"n">p1</span><span class=3D"p">.</span><sp=
an class=3D"n">y</span><span class=3D"p">;</span>
    <span class=3D"kt">double</span> <span class=3D"n">D</span> <span class=
=3D"o">=3D</span> <span class=3D"mi">2</span><span class=3D"o">*</span><spa=
n class=3D"p">(</span><span class=3D"n">Bx</span><span class=3D"o">*</span>=
<span class=3D"n">Cy</span><span class=3D"o">-</span><span class=3D"n">By</=
span><span class=3D"o">*</span><span class=3D"n">Cx</span><span class=3D"p"=
>);</span>
    <span class=3D"kt">double</span> <span class=3D"n">cx</span> <span clas=
s=3D"o">=3D</span> <span class=3D"p">(</span><span class=3D"n">Cy</span><sp=
an class=3D"o">*</span><span class=3D"p">(</span><span class=3D"n">Bx</span=
><span class=3D"o">*</span><span class=3D"n">Bx</span><span class=3D"o">+</=
span><span class=3D"n">By</span><span class=3D"o">*</span><span class=3D"n"=
>By</span><span class=3D"p">)</span> <span class=3D"o">-</span> <span class=
=3D"n">By</span><span class=3D"o">*</span><span class=3D"p">(</span><span c=
lass=3D"n">Cx</span><span class=3D"o">*</span><span class=3D"n">Cx</span><s=
pan class=3D"o">+</span><span class=3D"n">Cy</span><span class=3D"o">*</spa=
n><span class=3D"n">Cy</span><span class=3D"p">))</span><span class=3D"o">/=
</span><span class=3D"n">D</span> <span class=3D"o">+</span> <span class=3D=
"n">p1</span><span class=3D"p">.</span><span class=3D"n">x</span><span clas=
s=3D"p">;</span>
    <span class=3D"kt">double</span> <span class=3D"n">cy</span> <span clas=
s=3D"o">=3D</span> <span class=3D"p">(</span><span class=3D"n">Bx</span><sp=
an class=3D"o">*</span><span class=3D"p">(</span><span class=3D"n">Cx</span=
><span class=3D"o">*</span><span class=3D"n">Cx</span><span class=3D"o">+</=
span><span class=3D"n">Cy</span><span class=3D"o">*</span><span class=3D"n"=
>Cy</span><span class=3D"p">)</span> <span class=3D"o">-</span> <span class=
=3D"n">Cx</span><span class=3D"o">*</span><span class=3D"p">(</span><span c=
lass=3D"n">Bx</span><span class=3D"o">*</span><span class=3D"n">Bx</span><s=
pan class=3D"o">+</span><span class=3D"n">By</span><span class=3D"o">*</spa=
n><span class=3D"n">By</span><span class=3D"p">))</span><span class=3D"o">/=
</span><span class=3D"n">D</span> <span class=3D"o">+</span> <span class=3D=
"n">p1</span><span class=3D"p">.</span><span class=3D"n">y</span><span clas=
s=3D"p">;</span>
    <span class=3D"n">Point</span> <span class=3D"n">p</span> <span class=
=3D"o">=3D</span> <span class=3D"n">Point</span><span class=3D"p">(</span><=
span class=3D"n">cx</span><span class=3D"p">,</span> <span class=3D"n">cy</=
span><span class=3D"p">);</span>
    <span class=3D"k">return</span> <span class=3D"n">Circle</span><span cl=
ass=3D"p">(</span><span class=3D"n">p</span><span class=3D"p">,</span> <spa=
n class=3D"n">Length</span><span class=3D"p">(</span><span class=3D"n">p1</=
span><span class=3D"o">-</span><span class=3D"n">p</span><span class=3D"p">=
));</span>
<span class=3D"p">}</span>


<span class=3D"c1">//=E4=B8=89=E8=A7=92=E5=BD=A2=E5=86=85=E5=88=87=E5=9C=86=
</span>
<span class=3D"n">Circle</span> <span class=3D"n">InscribedCircle</span><sp=
an class=3D"p">(</span><span class=3D"n">Point</span> <span class=3D"n">p1<=
/span><span class=3D"p">,</span> <span class=3D"n">Point</span> <span class=
=3D"n">p2</span><span class=3D"p">,</span> <span class=3D"n">Point</span> <=
span class=3D"n">p3</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">double</span> <span class=3D"n">a</span> <span class=
=3D"o">=3D</span> <span class=3D"n">Length</span><span class=3D"p">(</span>=
<span class=3D"n">p2</span><span class=3D"o">-</span><span class=3D"n">p3</=
span><span class=3D"p">);</span>
    <span class=3D"kt">double</span> <span class=3D"n">b</span> <span class=
=3D"o">=3D</span> <span class=3D"n">Length</span><span class=3D"p">(</span>=
<span class=3D"n">p3</span><span class=3D"o">-</span><span class=3D"n">p1</=
span><span class=3D"p">);</span>
    <span class=3D"kt">double</span> <span class=3D"n">c</span> <span class=
=3D"o">=3D</span> <span class=3D"n">Length</span><span class=3D"p">(</span>=
<span class=3D"n">p1</span><span class=3D"o">-</span><span class=3D"n">p2</=
span><span class=3D"p">);</span>
    <span class=3D"n">Point</span> <span class=3D"n">p</span> <span class=
=3D"o">=3D</span> <span class=3D"p">(</span><span class=3D"n">p1</span><spa=
n class=3D"o">*</span><span class=3D"n">a</span><span class=3D"o">+</span><=
span class=3D"n">p2</span><span class=3D"o">*</span><span class=3D"n">b</sp=
an><span class=3D"o">+</span><span class=3D"n">p3</span><span class=3D"o">*=
</span><span class=3D"n">c</span><span class=3D"p">)</span><span class=3D"o=
">/</span><span class=3D"p">(</span><span class=3D"n">a</span><span class=
=3D"o">+</span><span class=3D"n">b</span><span class=3D"o">+</span><span cl=
ass=3D"n">c</span><span class=3D"p">);</span>
    <span class=3D"k">return</span> <span class=3D"n">Circle</span><span cl=
ass=3D"p">(</span><span class=3D"n">p</span><span class=3D"p">,</span> <spa=
n class=3D"n">DistanceToLine</span><span class=3D"p">(</span><span class=3D=
"n">p</span><span class=3D"p">,</span> <span class=3D"n">p1</span><span cla=
ss=3D"p">,</span> <span class=3D"n">p2</span><span class=3D"p">));</span>
<span class=3D"p">}</span>


<span class=3D"c1">//=E6=89=80=E6=9C=89=E7=BB=8F=E8=BF=87=E7=82=B9p =E5=8D=
=8A=E5=BE=84=E4=B8=BAr =E4=B8=94=E4=B8=8E=E7=9B=B4=E7=BA=BFL=E7=9B=B8=E5=88=
=87=E7=9A=84=E5=9C=86=E5=BF=83</span>
<span class=3D"n">vector</span><span class=3D"o">&lt;</span><span class=3D"=
n">Point</span><span class=3D"o">&gt;</span> <span class=3D"n">CircleThroug=
hPointTangentToLineGivenRadius</span><span class=3D"p">(</span><span class=
=3D"n">Point</span> <span class=3D"n">p</span><span class=3D"p">,</span> <s=
pan class=3D"n">Line</span> <span class=3D"n">L</span><span class=3D"p">,</=
span> <span class=3D"kt">double</span> <span class=3D"n">r</span><span clas=
s=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"n">vector</span><span class=3D"o">&lt;</span><span class=
=3D"n">Point</span><span class=3D"o">&gt;</span> <span class=3D"n">ans</spa=
n><span class=3D"p">;</span>
    <span class=3D"kt">double</span> <span class=3D"n">t1</span><span class=
=3D"p">,</span> <span class=3D"n">t2</span><span class=3D"p">;</span>
    <span class=3D"n">getLineCircleIntersection</span><span class=3D"p">(</=
span><span class=3D"n">L</span><span class=3D"p">.</span><span class=3D"n">=
move</span><span class=3D"p">(</span><span class=3D"o">-</span><span class=
=3D"n">r</span><span class=3D"p">),</span> <span class=3D"n">Circle</span><=
span class=3D"p">(</span><span class=3D"n">p</span><span class=3D"p">,</spa=
n> <span class=3D"n">r</span><span class=3D"p">),</span> <span class=3D"n">=
t1</span><span class=3D"p">,</span> <span class=3D"n">t2</span><span class=
=3D"p">,</span> <span class=3D"n">ans</span><span class=3D"p">);</span>
    <span class=3D"n">getLineCircleIntersection</span><span class=3D"p">(</=
span><span class=3D"n">L</span><span class=3D"p">.</span><span class=3D"n">=
move</span><span class=3D"p">(</span><span class=3D"n">r</span><span class=
=3D"p">),</span> <span class=3D"n">Circle</span><span class=3D"p">(</span><=
span class=3D"n">p</span><span class=3D"p">,</span> <span class=3D"n">r</sp=
an><span class=3D"p">),</span> <span class=3D"n">t1</span><span class=3D"p"=
>,</span> <span class=3D"n">t2</span><span class=3D"p">,</span> <span class=
=3D"n">ans</span><span class=3D"p">);</span>
    <span class=3D"k">return</span> <span class=3D"n">ans</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>


<span class=3D"c1">//=E5=8D=8A=E5=BE=84=E4=B8=BAr =E4=B8=8Ea b=E4=B8=A4=E7=
=9B=B4=E7=BA=BF=E7=9B=B8=E5=88=87=E7=9A=84=E5=9C=86=E5=BF=83</span>
<span class=3D"n">vector</span><span class=3D"o">&lt;</span><span class=3D"=
n">Point</span><span class=3D"o">&gt;</span> <span class=3D"n">CircleTangen=
tToLinesGivenRadius</span><span class=3D"p">(</span><span class=3D"n">Line<=
/span> <span class=3D"n">a</span><span class=3D"p">,</span> <span class=3D"=
n">Line</span> <span class=3D"n">b</span><span class=3D"p">,</span> <span c=
lass=3D"kt">double</span> <span class=3D"n">r</span><span class=3D"p">)</sp=
an>
<span class=3D"p">{</span>
    <span class=3D"n">vector</span><span class=3D"o">&lt;</span><span class=
=3D"n">Point</span><span class=3D"o">&gt;</span> <span class=3D"n">ans</spa=
n><span class=3D"p">;</span>
    <span class=3D"n">Line</span> <span class=3D"n">L1</span> <span class=
=3D"o">=3D</span> <span class=3D"n">a</span><span class=3D"p">.</span><span=
 class=3D"n">move</span><span class=3D"p">(</span><span class=3D"o">-</span=
><span class=3D"n">r</span><span class=3D"p">),</span> <span class=3D"n">L2=
</span> <span class=3D"o">=3D</span> <span class=3D"n">a</span><span class=
=3D"p">.</span><span class=3D"n">move</span><span class=3D"p">(</span><span=
 class=3D"n">r</span><span class=3D"p">);</span>
    <span class=3D"n">Line</span> <span class=3D"n">L3</span> <span class=
=3D"o">=3D</span> <span class=3D"n">b</span><span class=3D"p">.</span><span=
 class=3D"n">move</span><span class=3D"p">(</span><span class=3D"o">-</span=
><span class=3D"n">r</span><span class=3D"p">),</span> <span class=3D"n">L4=
</span> <span class=3D"o">=3D</span> <span class=3D"n">b</span><span class=
=3D"p">.</span><span class=3D"n">move</span><span class=3D"p">(</span><span=
 class=3D"n">r</span><span class=3D"p">);</span>
    <span class=3D"n">ans</span><span class=3D"p">.</span><span class=3D"n"=
>push_back</span><span class=3D"p">(</span><span class=3D"n">GetLineInterse=
ction</span><span class=3D"p">(</span><span class=3D"n">L1</span><span clas=
s=3D"p">,</span> <span class=3D"n">L3</span><span class=3D"p">));</span>
    <span class=3D"n">ans</span><span class=3D"p">.</span><span class=3D"n"=
>push_back</span><span class=3D"p">(</span><span class=3D"n">GetLineInterse=
ction</span><span class=3D"p">(</span><span class=3D"n">L1</span><span clas=
s=3D"p">,</span> <span class=3D"n">L4</span><span class=3D"p">));</span>
    <span class=3D"n">ans</span><span class=3D"p">.</span><span class=3D"n"=
>push_back</span><span class=3D"p">(</span><span class=3D"n">GetLineInterse=
ction</span><span class=3D"p">(</span><span class=3D"n">L2</span><span clas=
s=3D"p">,</span> <span class=3D"n">L3</span><span class=3D"p">));</span>
    <span class=3D"n">ans</span><span class=3D"p">.</span><span class=3D"n"=
>push_back</span><span class=3D"p">(</span><span class=3D"n">GetLineInterse=
ction</span><span class=3D"p">(</span><span class=3D"n">L2</span><span clas=
s=3D"p">,</span> <span class=3D"n">L4</span><span class=3D"p">));</span>
    <span class=3D"k">return</span> <span class=3D"n">ans</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>


<span class=3D"c1">//=E4=B8=8E=E4=B8=A4=E5=9C=86=E7=9B=B8=E5=88=87 =E5=8D=
=8A=E5=BE=84=E4=B8=BAr=E7=9A=84=E6=89=80=E6=9C=89=E5=9C=86=E5=BF=83</span>
<span class=3D"n">vector</span><span class=3D"o">&lt;</span><span class=3D"=
n">Point</span><span class=3D"o">&gt;</span> <span class=3D"n">CircleTangen=
tToTwoDisjointCirclesWithRadius</span><span class=3D"p">(</span><span class=
=3D"n">Circle</span> <span class=3D"n">c1</span><span class=3D"p">,</span> =
<span class=3D"n">Circle</span> <span class=3D"n">c2</span><span class=3D"p=
">,</span> <span class=3D"kt">double</span> <span class=3D"n">r</span><span=
 class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"n">vector</span><span class=3D"o">&lt;</span><span class=
=3D"n">Point</span><span class=3D"o">&gt;</span> <span class=3D"n">ans</spa=
n><span class=3D"p">;</span>
    <span class=3D"n">Vector</span> <span class=3D"n">v</span> <span class=
=3D"o">=3D</span> <span class=3D"n">c2</span><span class=3D"p">.</span><spa=
n class=3D"n">c</span> <span class=3D"o">-</span> <span class=3D"n">c1</spa=
n><span class=3D"p">.</span><span class=3D"n">c</span><span class=3D"p">;</=
span>
    <span class=3D"kt">double</span> <span class=3D"n">dist</span> <span cl=
ass=3D"o">=3D</span> <span class=3D"n">Length</span><span class=3D"p">(</sp=
an><span class=3D"n">v</span><span class=3D"p">);</span>
    <span class=3D"kt">int</span> <span class=3D"n">d</span> <span class=3D=
"o">=3D</span> <span class=3D"n">dcmp</span><span class=3D"p">(</span><span=
 class=3D"n">dist</span> <span class=3D"o">-</span> <span class=3D"n">c1</s=
pan><span class=3D"p">.</span><span class=3D"n">r</span> <span class=3D"o">=
-</span><span class=3D"n">c2</span><span class=3D"p">.</span><span class=3D=
"n">r</span> <span class=3D"o">-</span> <span class=3D"n">r</span><span cla=
ss=3D"o">*</span><span class=3D"mi">2</span><span class=3D"p">);</span>
    <span class=3D"k">if</span><span class=3D"p">(</span><span class=3D"n">=
d</span> <span class=3D"o">&gt;</span> <span class=3D"mi">0</span><span cla=
ss=3D"p">)</span> <span class=3D"k">return</span> <span class=3D"n">ans</sp=
an><span class=3D"p">;</span>
    <span class=3D"n">getCircleCircleIntersection</span><span class=3D"p">(=
</span><span class=3D"n">Circle</span><span class=3D"p">(</span><span class=
=3D"n">c1</span><span class=3D"p">.</span><span class=3D"n">c</span><span c=
lass=3D"p">,</span> <span class=3D"n">c1</span><span class=3D"p">.</span><s=
pan class=3D"n">r</span><span class=3D"o">+</span><span class=3D"n">r</span=
><span class=3D"p">),</span> <span class=3D"n">Circle</span><span class=3D"=
p">(</span><span class=3D"n">c2</span><span class=3D"p">.</span><span class=
=3D"n">c</span><span class=3D"p">,</span> <span class=3D"n">c2</span><span =
class=3D"p">.</span><span class=3D"n">r</span><span class=3D"o">+</span><sp=
an class=3D"n">r</span><span class=3D"p">),</span> <span class=3D"n">ans</s=
pan><span class=3D"p">);</span>
    <span class=3D"k">return</span> <span class=3D"n">ans</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>


<span class=3D"c1">//=E5=A4=9A=E8=BE=B9=E5=BD=A2=E4=B8=8E=E5=9C=86=E7=9B=B8=
=E4=BA=A4=E9=9D=A2=E7=A7=AF</span>
<span class=3D"n">Point</span> <span class=3D"n">GetIntersection</span><spa=
n class=3D"p">(</span><span class=3D"n">Line</span> <span class=3D"n">a</sp=
an><span class=3D"p">,</span> <span class=3D"n">Line</span> <span class=3D"=
n">b</span><span class=3D"p">)</span> <span class=3D"c1">//=E7=BA=BF=E6=AE=
=B5=E4=BA=A4=E7=82=B9</span>
<span class=3D"p">{</span>
    <span class=3D"n">Vector</span> <span class=3D"n">u</span> <span class=
=3D"o">=3D</span> <span class=3D"n">a</span><span class=3D"p">.</span><span=
 class=3D"n">p</span><span class=3D"o">-</span><span class=3D"n">b</span><s=
pan class=3D"p">.</span><span class=3D"n">p</span><span class=3D"p">;</span=
>
    <span class=3D"kt">double</span> <span class=3D"n">t</span> <span class=
=3D"o">=3D</span> <span class=3D"n">Cross</span><span class=3D"p">(</span><=
span class=3D"n">b</span><span class=3D"p">.</span><span class=3D"n">v</spa=
n><span class=3D"p">,</span> <span class=3D"n">u</span><span class=3D"p">)<=
/span> <span class=3D"o">/</span> <span class=3D"n">Cross</span><span class=
=3D"p">(</span><span class=3D"n">a</span><span class=3D"p">.</span><span cl=
ass=3D"n">v</span><span class=3D"p">,</span> <span class=3D"n">b</span><spa=
n class=3D"p">.</span><span class=3D"n">v</span><span class=3D"p">);</span>
    <span class=3D"k">return</span> <span class=3D"n">a</span><span class=
=3D"p">.</span><span class=3D"n">p</span> <span class=3D"o">+</span> <span =
class=3D"n">a</span><span class=3D"p">.</span><span class=3D"n">v</span><sp=
an class=3D"o">*</span><span class=3D"n">t</span><span class=3D"p">;</span>
<span class=3D"p">}</span>


<span class=3D"kr">inline</span> <span class=3D"kt">bool</span> <span class=
=3D"n">InCircle</span><span class=3D"p">(</span><span class=3D"n">Point</sp=
an> <span class=3D"n">x</span><span class=3D"p">,</span> <span class=3D"n">=
Circle</span> <span class=3D"n">c</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"k">return</span> <span class=3D"n">dcmp</span><span clas=
s=3D"p">(</span><span class=3D"n">c</span><span class=3D"p">.</span><span c=
lass=3D"n">r</span> <span class=3D"o">-</span> <span class=3D"n">Length</sp=
an><span class=3D"p">(</span><span class=3D"n">c</span><span class=3D"p">.<=
/span><span class=3D"n">c</span> <span class=3D"o">-</span> <span class=3D"=
n">x</span><span class=3D"p">))</span> <span class=3D"o">&gt;=3D</span> <sp=
an class=3D"mi">0</span><span class=3D"p">;</span>
<span class=3D"p">}</span>

<span class=3D"kr">inline</span> <span class=3D"kt">bool</span> <span class=
=3D"n">OnCircle</span><span class=3D"p">(</span><span class=3D"n">Point</sp=
an> <span class=3D"n">x</span><span class=3D"p">,</span> <span class=3D"n">=
Circle</span> <span class=3D"n">c</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"k">return</span> <span class=3D"n">dcmp</span><span clas=
s=3D"p">(</span><span class=3D"n">c</span><span class=3D"p">.</span><span c=
lass=3D"n">r</span> <span class=3D"o">-</span> <span class=3D"n">Length</sp=
an><span class=3D"p">(</span><span class=3D"n">c</span><span class=3D"p">.<=
/span><span class=3D"n">c</span> <span class=3D"o">-</span> <span class=3D"=
n">x</span><span class=3D"p">))</span> <span class=3D"o">=3D=3D</span> <spa=
n class=3D"mi">0</span><span class=3D"p">;</span>
<span class=3D"p">}</span>

<span class=3D"c1">//=E7=BA=BF=E6=AE=B5=E4=B8=8E=E5=9C=86=E7=9A=84=E4=BA=A4=
=E7=82=B9</span>
<span class=3D"kt">int</span> <span class=3D"n">getSegCircleIntersection</s=
pan><span class=3D"p">(</span><span class=3D"n">Line</span> <span class=3D"=
n">L</span><span class=3D"p">,</span> <span class=3D"n">Circle</span> <span=
 class=3D"n">C</span><span class=3D"p">,</span> <span class=3D"n">Point</sp=
an><span class=3D"o">*</span> <span class=3D"n">sol</span><span class=3D"p"=
>)</span>
<span class=3D"p">{</span>
    <span class=3D"n">Vector</span> <span class=3D"n">nor</span> <span clas=
s=3D"o">=3D</span> <span class=3D"n">Normal</span><span class=3D"p">(</span=
><span class=3D"n">L</span><span class=3D"p">.</span><span class=3D"n">v</s=
pan><span class=3D"p">);</span>
    <span class=3D"n">Line</span> <span class=3D"n">pl</span> <span class=
=3D"o">=3D</span> <span class=3D"n">Line</span><span class=3D"p">(</span><s=
pan class=3D"n">C</span><span class=3D"p">.</span><span class=3D"n">c</span=
><span class=3D"p">,</span> <span class=3D"n">nor</span><span class=3D"p">)=
;</span>
    <span class=3D"n">Point</span> <span class=3D"n">ip</span> <span class=
=3D"o">=3D</span> <span class=3D"n">GetIntersection</span><span class=3D"p"=
>(</span><span class=3D"n">pl</span><span class=3D"p">,</span> <span class=
=3D"n">L</span><span class=3D"p">);</span>
    <span class=3D"kt">double</span> <span class=3D"n">dis</span> <span cla=
ss=3D"o">=3D</span> <span class=3D"n">Length</span><span class=3D"p">(</spa=
n><span class=3D"n">ip</span> <span class=3D"o">-</span> <span class=3D"n">=
C</span><span class=3D"p">.</span><span class=3D"n">c</span><span class=3D"=
p">);</span>
    <span class=3D"k">if</span> <span class=3D"p">(</span><span class=3D"n"=
>dcmp</span><span class=3D"p">(</span><span class=3D"n">dis</span> <span cl=
ass=3D"o">-</span> <span class=3D"n">C</span><span class=3D"p">.</span><spa=
n class=3D"n">r</span><span class=3D"p">)</span> <span class=3D"o">&gt;</sp=
an> <span class=3D"mi">0</span><span class=3D"p">)</span> <span class=3D"k"=
>return</span> <span class=3D"mi">0</span><span class=3D"p">;</span>
    <span class=3D"n">Point</span> <span class=3D"n">dxy</span> <span class=
=3D"o">=3D</span> <span class=3D"n">Unit</span><span class=3D"p">(</span><s=
pan class=3D"n">L</span><span class=3D"p">.</span><span class=3D"n">v</span=
><span class=3D"p">)</span> <span class=3D"o">*</span> <span class=3D"n">sq=
rt</span><span class=3D"p">(</span><span class=3D"n">sqrt</span><span class=
=3D"p">(</span><span class=3D"n">C</span><span class=3D"p">.</span><span cl=
ass=3D"n">r</span><span class=3D"p">)</span> <span class=3D"o">-</span> <sp=
an class=3D"n">sqrt</span><span class=3D"p">(</span><span class=3D"n">dis</=
span><span class=3D"p">));</span>
    <span class=3D"kt">int</span> <span class=3D"n">ret</span> <span class=
=3D"o">=3D</span> <span class=3D"mi">0</span><span class=3D"p">;</span>
    <span class=3D"n">sol</span><span class=3D"p">[</span><span class=3D"n"=
>ret</span><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span cl=
ass=3D"n">ip</span> <span class=3D"o">+</span> <span class=3D"n">dxy</span>=
<span class=3D"p">;</span>
    <span class=3D"k">if</span> <span class=3D"p">(</span><span class=3D"n"=
>OnSegment</span><span class=3D"p">(</span><span class=3D"n">sol</span><spa=
n class=3D"p">[</span><span class=3D"n">ret</span><span class=3D"p">],</spa=
n> <span class=3D"n">L</span><span class=3D"p">.</span><span class=3D"n">p<=
/span><span class=3D"p">,</span> <span class=3D"n">L</span><span class=3D"p=
">.</span><span class=3D"n">point</span><span class=3D"p">(</span><span cla=
ss=3D"mi">1</span><span class=3D"p">)))</span> <span class=3D"n">ret</span>=
<span class=3D"o">++</span><span class=3D"p">;</span>
    <span class=3D"n">sol</span><span class=3D"p">[</span><span class=3D"n"=
>ret</span><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span cl=
ass=3D"n">ip</span> <span class=3D"o">-</span> <span class=3D"n">dxy</span>=
<span class=3D"p">;</span>
    <span class=3D"k">if</span> <span class=3D"p">(</span><span class=3D"n"=
>OnSegment</span><span class=3D"p">(</span><span class=3D"n">sol</span><spa=
n class=3D"p">[</span><span class=3D"n">ret</span><span class=3D"p">],</spa=
n> <span class=3D"n">L</span><span class=3D"p">.</span><span class=3D"n">p<=
/span><span class=3D"p">,</span> <span class=3D"n">L</span><span class=3D"p=
">.</span><span class=3D"n">point</span><span class=3D"p">(</span><span cla=
ss=3D"mi">1</span><span class=3D"p">)))</span> <span class=3D"n">ret</span>=
<span class=3D"o">++</span><span class=3D"p">;</span>
    <span class=3D"k">return</span> <span class=3D"n">ret</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>

<span class=3D"c1">//=E7=BA=BF=E6=AE=B5=E5=88=87=E5=89=B2=E5=9C=86</span>
<span class=3D"kt">double</span> <span class=3D"n">SegCircleArea</span><spa=
n class=3D"p">(</span><span class=3D"n">Circle</span> <span class=3D"n">C</=
span><span class=3D"p">,</span> <span class=3D"n">Point</span> <span class=
=3D"n">a</span><span class=3D"p">,</span> <span class=3D"n">Point</span> <s=
pan class=3D"n">b</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">double</span> <span class=3D"n">a1</span> <span clas=
s=3D"o">=3D</span> <span class=3D"n">angle</span><span class=3D"p">(</span>=
<span class=3D"n">a</span> <span class=3D"o">-</span> <span class=3D"n">C</=
span><span class=3D"p">.</span><span class=3D"n">c</span><span class=3D"p">=
);</span>
    <span class=3D"kt">double</span> <span class=3D"n">a2</span> <span clas=
s=3D"o">=3D</span> <span class=3D"n">angle</span><span class=3D"p">(</span>=
<span class=3D"n">b</span> <span class=3D"o">-</span> <span class=3D"n">C</=
span><span class=3D"p">.</span><span class=3D"n">c</span><span class=3D"p">=
);</span>
    <span class=3D"kt">double</span> <span class=3D"n">da</span> <span clas=
s=3D"o">=3D</span> <span class=3D"n">fabs</span><span class=3D"p">(</span><=
span class=3D"n">a1</span> <span class=3D"o">-</span> <span class=3D"n">a2<=
/span><span class=3D"p">);</span>
    <span class=3D"k">if</span> <span class=3D"p">(</span><span class=3D"n"=
>da</span> <span class=3D"o">&gt;</span> <span class=3D"n">PI</span><span c=
lass=3D"p">)</span> <span class=3D"n">da</span> <span class=3D"o">=3D</span=
> <span class=3D"n">PI</span> <span class=3D"o">*</span> <span class=3D"mf"=
>2.0</span> <span class=3D"o">-</span> <span class=3D"n">da</span><span cla=
ss=3D"p">;</span>
    <span class=3D"k">return</span> <span class=3D"n">dcmp</span><span clas=
s=3D"p">(</span><span class=3D"n">Cross</span><span class=3D"p">(</span><sp=
an class=3D"n">b</span> <span class=3D"o">-</span> <span class=3D"n">C</spa=
n><span class=3D"p">.</span><span class=3D"n">c</span><span class=3D"p">,</=
span> <span class=3D"n">a</span> <span class=3D"o">-</span> <span class=3D"=
n">C</span><span class=3D"p">.</span><span class=3D"n">c</span><span class=
=3D"p">))</span> <span class=3D"o">*</span> <span class=3D"n">da</span> <sp=
an class=3D"o">*</span> <span class=3D"n">sqrt</span><span class=3D"p">(</s=
pan><span class=3D"n">C</span><span class=3D"p">.</span><span class=3D"n">r=
</span><span class=3D"p">)</span> <span class=3D"o">/</span> <span class=3D=
"mf">2.0</span><span class=3D"p">;</span>
<span class=3D"p">}</span>

<span class=3D"c1">//=E5=A4=9A=E8=BE=B9=E5=BD=A2=E4=B8=8E=E5=9C=86=E7=9B=B8=
=E4=BA=A4=E9=9D=A2=E7=A7=AF</span>
<span class=3D"kt">double</span> <span class=3D"n">PolyCiclrArea</span><spa=
n class=3D"p">(</span><span class=3D"n">Circle</span> <span class=3D"n">C</=
span><span class=3D"p">,</span> <span class=3D"n">Point</span> <span class=
=3D"o">*</span><span class=3D"n">p</span><span class=3D"p">,</span> <span c=
lass=3D"kt">int</span> <span class=3D"n">n</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"kt">double</span> <span class=3D"n">ret</span> <span cla=
ss=3D"o">=3D</span> <span class=3D"mf">0.0</span><span class=3D"p">;</span>
    <span class=3D"n">Point</span> <span class=3D"n">sol</span><span class=
=3D"p">[</span><span class=3D"mi">2</span><span class=3D"p">];</span>
    <span class=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">n=
</span><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span class=
=3D"n">p</span><span class=3D"p">[</span><span class=3D"mi">0</span><span c=
lass=3D"p">];</span>
    <span class=3D"c1">//REP(i, n)</span>
    <span class=3D"k">for</span><span class=3D"p">(</span><span class=3D"kt=
">int</span> <span class=3D"n">i</span><span class=3D"o">=3D</span><span cl=
ass=3D"mi">1</span><span class=3D"p">;</span><span class=3D"n">i</span><spa=
n class=3D"o">&lt;=3D</span><span class=3D"n">n</span><span class=3D"p">;</=
span><span class=3D"n">i</span><span class=3D"o">++</span><span class=3D"p"=
>)</span>
    <span class=3D"p">{</span>
        <span class=3D"c1">//double t1, t2;</span>
        <span class=3D"kt">int</span> <span class=3D"n">cnt</span> <span cl=
ass=3D"o">=3D</span> <span class=3D"n">getSegCircleIntersection</span><span=
 class=3D"p">(</span><span class=3D"n">Line</span><span class=3D"p">(</span=
><span class=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">i</s=
pan><span class=3D"p">],</span> <span class=3D"n">p</span><span class=3D"p"=
>[</span><span class=3D"n">i</span><span class=3D"o">+</span><span class=3D=
"mi">1</span><span class=3D"p">]</span><span class=3D"o">-</span><span clas=
s=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">i</span><span c=
lass=3D"p">]),</span> <span class=3D"n">C</span><span class=3D"p">,</span> =
<span class=3D"n">sol</span><span class=3D"p">);</span>
        <span class=3D"k">if</span> <span class=3D"p">(</span><span class=
=3D"n">cnt</span> <span class=3D"o">=3D=3D</span> <span class=3D"mi">0</spa=
n><span class=3D"p">)</span>
        <span class=3D"p">{</span>
            <span class=3D"k">if</span> <span class=3D"p">(</span><span cla=
ss=3D"o">!</span><span class=3D"n">InCircle</span><span class=3D"p">(</span=
><span class=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">i</s=
pan><span class=3D"p">],</span> <span class=3D"n">C</span><span class=3D"p"=
>)</span> <span class=3D"o">||</span> <span class=3D"o">!</span><span class=
=3D"n">InCircle</span><span class=3D"p">(</span><span class=3D"n">p</span><=
span class=3D"p">[</span><span class=3D"n">i</span><span class=3D"o">+</spa=
n><span class=3D"mi">1</span><span class=3D"p">],</span> <span class=3D"n">=
C</span><span class=3D"p">))</span> <span class=3D"n">ret</span> <span clas=
s=3D"o">+=3D</span> <span class=3D"n">SegCircleArea</span><span class=3D"p"=
>(</span><span class=3D"n">C</span><span class=3D"p">,</span> <span class=
=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">i</span><span cl=
ass=3D"p">],</span> <span class=3D"n">p</span><span class=3D"p">[</span><sp=
an class=3D"n">i</span><span class=3D"o">+</span><span class=3D"mi">1</span=
><span class=3D"p">]);</span>
            <span class=3D"k">else</span> <span class=3D"n">ret</span> <spa=
n class=3D"o">+=3D</span> <span class=3D"n">Cross</span><span class=3D"p">(=
</span><span class=3D"n">p</span><span class=3D"p">[</span><span class=3D"n=
">i</span><span class=3D"o">+</span><span class=3D"mi">1</span><span class=
=3D"p">]</span> <span class=3D"o">-</span> <span class=3D"n">C</span><span =
class=3D"p">.</span><span class=3D"n">c</span><span class=3D"p">,</span> <s=
pan class=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">i</span=
><span class=3D"p">]</span> <span class=3D"o">-</span> <span class=3D"n">C<=
/span><span class=3D"p">.</span><span class=3D"n">c</span><span class=3D"p"=
>)</span> <span class=3D"o">/</span> <span class=3D"mf">2.0</span><span cla=
ss=3D"p">;</span>
        <span class=3D"p">}</span>
        <span class=3D"k">if</span> <span class=3D"p">(</span><span class=
=3D"n">cnt</span> <span class=3D"o">=3D=3D</span> <span class=3D"mi">1</spa=
n><span class=3D"p">)</span>
        <span class=3D"p">{</span>
            <span class=3D"k">if</span> <span class=3D"p">(</span><span cla=
ss=3D"n">InCircle</span><span class=3D"p">(</span><span class=3D"n">p</span=
><span class=3D"p">[</span><span class=3D"n">i</span><span class=3D"p">],</=
span> <span class=3D"n">C</span><span class=3D"p">)</span> <span class=3D"o=
">&amp;&amp;</span> <span class=3D"o">!</span><span class=3D"n">InCircle</s=
pan><span class=3D"p">(</span><span class=3D"n">p</span><span class=3D"p">[=
</span><span class=3D"n">i</span><span class=3D"o">+</span><span class=3D"m=
i">1</span><span class=3D"p">],</span> <span class=3D"n">C</span><span clas=
s=3D"p">))</span> <span class=3D"n">ret</span> <span class=3D"o">+=3D</span=
> <span class=3D"n">Cross</span><span class=3D"p">(</span><span class=3D"n"=
>sol</span><span class=3D"p">[</span><span class=3D"mi">0</span><span class=
=3D"p">]</span> <span class=3D"o">-</span> <span class=3D"n">C</span><span =
class=3D"p">.</span><span class=3D"n">c</span><span class=3D"p">,</span> <s=
pan class=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">i</span=
><span class=3D"p">]</span> <span class=3D"o">-</span> <span class=3D"n">C<=
/span><span class=3D"p">.</span><span class=3D"n">c</span><span class=3D"p"=
>)</span> <span class=3D"o">/</span> <span class=3D"mf">2.0</span><span cla=
ss=3D"p">,</span> <span class=3D"n">ret</span> <span class=3D"o">+=3D</span=
> <span class=3D"n">SegCircleArea</span><span class=3D"p">(</span><span cla=
ss=3D"n">C</span><span class=3D"p">,</span> <span class=3D"n">sol</span><sp=
an class=3D"p">[</span><span class=3D"mi">0</span><span class=3D"p">],</spa=
n> <span class=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">i<=
/span><span class=3D"o">+</span><span class=3D"mi">1</span><span class=3D"p=
">]);</span>
            <span class=3D"k">else</span> <span class=3D"n">ret</span> <spa=
n class=3D"o">+=3D</span> <span class=3D"n">SegCircleArea</span><span class=
=3D"p">(</span><span class=3D"n">C</span><span class=3D"p">,</span> <span c=
lass=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">i</span><spa=
n class=3D"p">],</span> <span class=3D"n">sol</span><span class=3D"p">[</sp=
an><span class=3D"mi">0</span><span class=3D"p">]),</span> <span class=3D"n=
">ret</span> <span class=3D"o">+=3D</span> <span class=3D"n">Cross</span><s=
pan class=3D"p">(</span><span class=3D"n">p</span><span class=3D"p">[</span=
><span class=3D"n">i</span><span class=3D"o">+</span><span class=3D"mi">1</=
span><span class=3D"p">]</span> <span class=3D"o">-</span> <span class=3D"n=
">C</span><span class=3D"p">.</span><span class=3D"n">c</span><span class=
=3D"p">,</span> <span class=3D"n">sol</span><span class=3D"p">[</span><span=
 class=3D"mi">0</span><span class=3D"p">]</span> <span class=3D"o">-</span>=
 <span class=3D"n">C</span><span class=3D"p">.</span><span class=3D"n">c</s=
pan><span class=3D"p">)</span> <span class=3D"o">/</span> <span class=3D"mf=
">2.0</span><span class=3D"p">;</span>
        <span class=3D"p">}</span>
        <span class=3D"k">if</span> <span class=3D"p">(</span><span class=
=3D"n">cnt</span> <span class=3D"o">=3D=3D</span> <span class=3D"mi">2</spa=
n><span class=3D"p">)</span>
        <span class=3D"p">{</span>
            <span class=3D"k">if</span> <span class=3D"p">((</span><span cl=
ass=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">i</span><span=
 class=3D"p">]</span> <span class=3D"o">&lt;</span> <span class=3D"n">p</sp=
an><span class=3D"p">[</span><span class=3D"n">i</span> <span class=3D"o">+=
</span> <span class=3D"mi">1</span><span class=3D"p">])</span> <span class=
=3D"o">^</span> <span class=3D"p">(</span><span class=3D"n">sol</span><span=
 class=3D"p">[</span><span class=3D"mi">0</span><span class=3D"p">]</span> =
<span class=3D"o">&lt;</span> <span class=3D"n">sol</span><span class=3D"p"=
>[</span><span class=3D"mi">1</span><span class=3D"p">]))</span> <span clas=
s=3D"n">swap</span><span class=3D"p">(</span><span class=3D"n">sol</span><s=
pan class=3D"p">[</span><span class=3D"mi">0</span><span class=3D"p">],</sp=
an> <span class=3D"n">sol</span><span class=3D"p">[</span><span class=3D"mi=
">1</span><span class=3D"p">]);</span>
            <span class=3D"n">ret</span> <span class=3D"o">+=3D</span> <spa=
n class=3D"n">SegCircleArea</span><span class=3D"p">(</span><span class=3D"=
n">C</span><span class=3D"p">,</span> <span class=3D"n">p</span><span class=
=3D"p">[</span><span class=3D"n">i</span><span class=3D"p">],</span> <span =
class=3D"n">sol</span><span class=3D"p">[</span><span class=3D"mi">0</span>=
<span class=3D"p">]);</span>
            <span class=3D"n">ret</span> <span class=3D"o">+=3D</span> <spa=
n class=3D"n">Cross</span><span class=3D"p">(</span><span class=3D"n">sol</=
span><span class=3D"p">[</span><span class=3D"mi">1</span><span class=3D"p"=
>]</span> <span class=3D"o">-</span> <span class=3D"n">C</span><span class=
=3D"p">.</span><span class=3D"n">c</span><span class=3D"p">,</span> <span c=
lass=3D"n">sol</span><span class=3D"p">[</span><span class=3D"mi">0</span><=
span class=3D"p">]</span> <span class=3D"o">-</span> <span class=3D"n">C</s=
pan><span class=3D"p">.</span><span class=3D"n">c</span><span class=3D"p">)=
</span> <span class=3D"o">/</span> <span class=3D"mf">2.0</span><span class=
=3D"p">;</span>
            <span class=3D"n">ret</span> <span class=3D"o">+=3D</span> <spa=
n class=3D"n">SegCircleArea</span><span class=3D"p">(</span><span class=3D"=
n">C</span><span class=3D"p">,</span> <span class=3D"n">sol</span><span cla=
ss=3D"p">[</span><span class=3D"mi">1</span><span class=3D"p">],</span> <sp=
an class=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">i</span>=
<span class=3D"o">+</span><span class=3D"mi">1</span><span class=3D"p">]);<=
/span>
        <span class=3D"p">}</span>
    <span class=3D"p">}</span>
    <span class=3D"k">return</span> <span class=3D"n">fabs</span><span clas=
s=3D"p">(</span><span class=3D"n">ret</span><span class=3D"p">);</span>
<span class=3D"p">}</span>

<span class=3D"kt">double</span> <span class=3D"n">area</span><span class=
=3D"p">(</span><span class=3D"n">vector</span><span class=3D"o">&lt;</span>=
<span class=3D"n">Point</span><span class=3D"o">&gt;</span><span class=3D"n=
">p</span><span class=3D"p">)</span> <span class=3D"c1">//=E8=AE=A1=E7=AE=
=97=E5=87=B8=E5=8C=85=E7=9A=84=E9=9D=A2=E7=A7=AF</span>
<span class=3D"p">{</span>
    <span class=3D"kt">double</span> <span class=3D"n">ans</span> <span cla=
ss=3D"o">=3D</span> <span class=3D"mi">0</span><span class=3D"p">;</span>
    <span class=3D"kt">int</span> <span class=3D"n">sz</span> <span class=
=3D"o">=3D</span> <span class=3D"n">p</span><span class=3D"p">.</span><span=
 class=3D"n">size</span><span class=3D"p">();</span>
    <span class=3D"k">for</span> <span class=3D"p">(</span><span class=3D"k=
t">int</span> <span class=3D"n">i</span> <span class=3D"o">=3D</span> <span=
 class=3D"mi">1</span><span class=3D"p">;</span> <span class=3D"n">i</span>=
 <span class=3D"o">&lt;</span> <span class=3D"n">sz</span> <span class=3D"o=
">-</span> <span class=3D"mi">1</span><span class=3D"p">;</span> <span clas=
s=3D"n">i</span><span class=3D"o">++</span><span class=3D"p">)</span>
        <span class=3D"n">ans</span> <span class=3D"o">+=3D</span> <span cl=
ass=3D"n">Cross</span><span class=3D"p">(</span><span class=3D"n">p</span><=
span class=3D"p">[</span><span class=3D"n">i</span><span class=3D"p">]</spa=
n> <span class=3D"o">-</span> <span class=3D"n">p</span><span class=3D"p">[=
</span><span class=3D"mi">0</span><span class=3D"p">],</span> <span class=
=3D"n">p</span><span class=3D"p">[</span><span class=3D"n">i</span> <span c=
lass=3D"o">+</span> <span class=3D"mi">1</span><span class=3D"p">]</span> <=
span class=3D"o">-</span> <span class=3D"n">p</span><span class=3D"p">[</sp=
an><span class=3D"mi">0</span><span class=3D"p">]);</span>
    <span class=3D"k">return</span> <span class=3D"n">ans</span> <span clas=
s=3D"o">/</span> <span class=3D"mf">2.0</span><span class=3D"p">;</span>
<span class=3D"p">}</span>

<span class=3D"kt">double</span> <span class=3D"n">seg</span><span class=3D=
"p">(</span><span class=3D"n">Point</span> <span class=3D"n">o</span><span =
class=3D"p">,</span> <span class=3D"n">Point</span> <span class=3D"n">a</sp=
an><span class=3D"p">,</span> <span class=3D"n">Point</span> <span class=3D=
"n">b</span><span class=3D"p">)</span>
<span class=3D"p">{</span>
    <span class=3D"k">if</span> <span class=3D"p">(</span><span class=3D"n"=
>dcmp</span><span class=3D"p">(</span><span class=3D"n">b</span><span class=
=3D"p">.</span><span class=3D"n">x</span> <span class=3D"o">-</span> <span =
class=3D"n">a</span><span class=3D"p">.</span><span class=3D"n">x</span><sp=
an class=3D"p">)</span> <span class=3D"o">=3D=3D</span> <span class=3D"mi">=
0</span><span class=3D"p">)</span> <span class=3D"k">return</span> <span cl=
ass=3D"p">(</span><span class=3D"n">o</span><span class=3D"p">.</span><span=
 class=3D"n">y</span> <span class=3D"o">-</span> <span class=3D"n">a</span>=
<span class=3D"p">.</span><span class=3D"n">y</span><span class=3D"p">)</sp=
an> <span class=3D"o">/</span> <span class=3D"p">(</span><span class=3D"n">=
b</span><span class=3D"p">.</span><span class=3D"n">y</span> <span class=3D=
"o">-</span> <span class=3D"n">a</span><span class=3D"p">.</span><span clas=
s=3D"n">y</span><span class=3D"p">);</span>
    <span class=3D"k">return</span> <span class=3D"p">(</span><span class=
=3D"n">o</span><span class=3D"p">.</span><span class=3D"n">x</span> <span c=
lass=3D"o">-</span> <span class=3D"n">a</span><span class=3D"p">.</span><sp=
an class=3D"n">x</span><span class=3D"p">)</span> <span class=3D"o">/</span=
> <span class=3D"p">(</span><span class=3D"n">b</span><span class=3D"p">.</=
span><span class=3D"n">x</span> <span class=3D"o">-</span> <span class=3D"n=
">a</span><span class=3D"p">.</span><span class=3D"n">x</span><span class=
=3D"p">);</span>
<span class=3D"p">}</span>

<span class=3D"n">vector</span><span class=3D"o">&lt;</span><span class=3D"=
n">Point</span><span class=3D"o">&gt;</span> <span class=3D"n">pp</span><sp=
an class=3D"p">[</span><span class=3D"mi">110</span><span class=3D"p">];</s=
pan>
<span class=3D"n">pair</span><span class=3D"o">&lt;</span><span class=3D"kt=
">double</span><span class=3D"p">,</span> <span class=3D"kt">int</span><spa=
n class=3D"o">&gt;</span> <span class=3D"n">s</span><span class=3D"p">[</sp=
an><span class=3D"mi">2000200</span><span class=3D"p">];</span>
<span class=3D"kt">double</span> <span class=3D"n">polyunion</span><span cl=
ass=3D"p">(</span><span class=3D"n">vector</span><span class=3D"o">&lt;</sp=
an><span class=3D"n">Point</span><span class=3D"o">&gt;*</span><span class=
=3D"n">p</span><span class=3D"p">,</span> <span class=3D"kt">int</span> <sp=
an class=3D"n">n</span><span class=3D"p">)</span><span class=3D"c1">//=E6=
=B1=82n=E4=B8=AA=E5=A4=9A=E5=87=B8=E5=8C=85=E7=9A=84=E9=9D=A2=E7=A7=AF=E4=
=BA=A4</span>
<span class=3D"p">{</span>
    <span class=3D"kt">double</span> <span class=3D"n">ret</span> <span cla=
ss=3D"o">=3D</span> <span class=3D"mi">0</span><span class=3D"p">;</span>
    <span class=3D"k">for</span> <span class=3D"p">(</span><span class=3D"k=
t">int</span> <span class=3D"n">i</span> <span class=3D"o">=3D</span> <span=
 class=3D"mi">0</span><span class=3D"p">;</span> <span class=3D"n">i</span>=
 <span class=3D"o">&lt;</span> <span class=3D"n">n</span><span class=3D"p">=
;</span> <span class=3D"n">i</span><span class=3D"o">++</span><span class=
=3D"p">)</span>
    <span class=3D"p">{</span>
        <span class=3D"kt">int</span> <span class=3D"n">sz</span> <span cla=
ss=3D"o">=3D</span> <span class=3D"n">p</span><span class=3D"p">[</span><sp=
an class=3D"n">i</span><span class=3D"p">].</span><span class=3D"n">size</s=
pan><span class=3D"p">();</span>
        <span class=3D"k">for</span> <span class=3D"p">(</span><span class=
=3D"kt">int</span> <span class=3D"n">j</span> <span class=3D"o">=3D</span> =
<span class=3D"mi">0</span><span class=3D"p">;</span> <span class=3D"n">j</=
span> <span class=3D"o">&lt;</span> <span class=3D"n">sz</span><span class=
=3D"p">;</span> <span class=3D"n">j</span><span class=3D"o">++</span><span =
class=3D"p">)</span>
        <span class=3D"p">{</span>
            <span class=3D"kt">int</span> <span class=3D"n">m</span> <span =
class=3D"o">=3D</span> <span class=3D"mi">0</span><span class=3D"p">;</span=
>
            <span class=3D"n">s</span><span class=3D"p">[</span><span class=
=3D"n">m</span><span class=3D"o">++</span><span class=3D"p">]</span> <span =
class=3D"o">=3D</span> <span class=3D"n">mp</span><span class=3D"p">(</span=
><span class=3D"mi">0</span><span class=3D"p">,</span> <span class=3D"mi">0=
</span><span class=3D"p">);</span>
            <span class=3D"n">s</span><span class=3D"p">[</span><span class=
=3D"n">m</span><span class=3D"o">++</span><span class=3D"p">]</span> <span =
class=3D"o">=3D</span> <span class=3D"n">mp</span><span class=3D"p">(</span=
><span class=3D"mi">1</span><span class=3D"p">,</span> <span class=3D"mi">0=
</span><span class=3D"p">);</span>
            <span class=3D"n">Point</span> <span class=3D"n">a</span> <span=
 class=3D"o">=3D</span> <span class=3D"n">p</span><span class=3D"p">[</span=
><span class=3D"n">i</span><span class=3D"p">][</span><span class=3D"n">j</=
span><span class=3D"p">],</span> <span class=3D"n">b</span> <span class=3D"=
o">=3D</span> <span class=3D"n">p</span><span class=3D"p">[</span><span cla=
ss=3D"n">i</span><span class=3D"p">][(</span><span class=3D"n">j</span> <sp=
an class=3D"o">+</span> <span class=3D"mi">1</span><span class=3D"p">)</spa=
n> <span class=3D"o">%</span> <span class=3D"n">sz</span><span class=3D"p">=
];</span>
            <span class=3D"k">for</span> <span class=3D"p">(</span><span cl=
ass=3D"kt">int</span> <span class=3D"n">k</span> <span class=3D"o">=3D</spa=
n> <span class=3D"mi">0</span><span class=3D"p">;</span> <span class=3D"n">=
k</span> <span class=3D"o">&lt;</span> <span class=3D"n">n</span><span clas=
s=3D"p">;</span> <span class=3D"n">k</span><span class=3D"o">++</span><span=
 class=3D"p">)</span>
            <span class=3D"p">{</span>
                <span class=3D"k">if</span> <span class=3D"p">(</span><span=
 class=3D"n">i</span> <span class=3D"o">!=3D</span> <span class=3D"n">k</sp=
an><span class=3D"p">)</span>
                <span class=3D"p">{</span>
                    <span class=3D"kt">int</span> <span class=3D"n">siz</sp=
an> <span class=3D"o">=3D</span> <span class=3D"n">p</span><span class=3D"p=
">[</span><span class=3D"n">k</span><span class=3D"p">].</span><span class=
=3D"n">size</span><span class=3D"p">();</span>
                    <span class=3D"k">for</span> <span class=3D"p">(</span>=
<span class=3D"kt">int</span> <span class=3D"n">ii</span> <span class=3D"o"=
>=3D</span> <span class=3D"mi">0</span><span class=3D"p">;</span> <span cla=
ss=3D"n">ii</span> <span class=3D"o">&lt;</span> <span class=3D"n">siz</spa=
n><span class=3D"p">;</span> <span class=3D"n">ii</span><span class=3D"o">+=
+</span><span class=3D"p">)</span>
                    <span class=3D"p">{</span>
                        <span class=3D"n">Point</span> <span class=3D"n">c<=
/span> <span class=3D"o">=3D</span> <span class=3D"n">p</span><span class=
=3D"p">[</span><span class=3D"n">k</span><span class=3D"p">][</span><span c=
lass=3D"n">ii</span><span class=3D"p">],</span> <span class=3D"n">d</span> =
<span class=3D"o">=3D</span> <span class=3D"n">p</span><span class=3D"p">[<=
/span><span class=3D"n">k</span><span class=3D"p">][(</span><span class=3D"=
n">ii</span> <span class=3D"o">+</span> <span class=3D"mi">1</span><span cl=
ass=3D"p">)</span> <span class=3D"o">%</span> <span class=3D"n">siz</span><=
span class=3D"p">];</span>
                        <span class=3D"kt">int</span> <span class=3D"n">c1<=
/span> <span class=3D"o">=3D</span> <span class=3D"n">dcmp</span><span clas=
s=3D"p">(</span><span class=3D"n">Cross</span><span class=3D"p">(</span><sp=
an class=3D"n">b</span> <span class=3D"o">-</span> <span class=3D"n">a</spa=
n><span class=3D"p">,</span> <span class=3D"n">c</span> <span class=3D"o">-=
</span> <span class=3D"n">a</span><span class=3D"p">));</span>
                        <span class=3D"kt">int</span> <span class=3D"n">c2<=
/span> <span class=3D"o">=3D</span> <span class=3D"n">dcmp</span><span clas=
s=3D"p">(</span><span class=3D"n">Cross</span><span class=3D"p">(</span><sp=
an class=3D"n">b</span> <span class=3D"o">-</span> <span class=3D"n">a</spa=
n><span class=3D"p">,</span> <span class=3D"n">d</span> <span class=3D"o">-=
</span> <span class=3D"n">a</span><span class=3D"p">));</span>
                        <span class=3D"k">if</span> <span class=3D"p">(</sp=
an><span class=3D"n">c1</span> <span class=3D"o">=3D=3D</span> <span class=
=3D"mi">0</span> <span class=3D"o">&amp;&amp;</span> <span class=3D"n">c2</=
span> <span class=3D"o">=3D=3D</span> <span class=3D"mi">0</span><span clas=
s=3D"p">)</span>
                        <span class=3D"p">{</span>
                            <span class=3D"k">if</span> <span class=3D"p">(=
</span><span class=3D"n">dcmp</span><span class=3D"p">(</span><span class=
=3D"n">Dot</span><span class=3D"p">(</span><span class=3D"n">b</span> <span=
 class=3D"o">-</span> <span class=3D"n">a</span><span class=3D"p">,</span> =
<span class=3D"n">d</span> <span class=3D"o">-</span> <span class=3D"n">c</=
span><span class=3D"p">))</span> <span class=3D"o">&gt;</span> <span class=
=3D"mi">0</span> <span class=3D"o">&amp;&amp;</span> <span class=3D"n">i</s=
pan> <span class=3D"o">&gt;</span> <span class=3D"n">k</span><span class=3D=
"p">)</span>
                            <span class=3D"p">{</span>
                                <span class=3D"n">s</span><span class=3D"p"=
>[</span><span class=3D"n">m</span><span class=3D"o">++</span><span class=
=3D"p">]</span> <span class=3D"o">=3D</span> <span class=3D"n">mp</span><sp=
an class=3D"p">(</span><span class=3D"n">seg</span><span class=3D"p">(</spa=
n><span class=3D"n">c</span><span class=3D"p">,</span> <span class=3D"n">a<=
/span><span class=3D"p">,</span> <span class=3D"n">b</span><span class=3D"p=
">),</span> <span class=3D"mi">1</span><span class=3D"p">);</span>
                                <span class=3D"n">s</span><span class=3D"p"=
>[</span><span class=3D"n">m</span><span class=3D"o">++</span><span class=
=3D"p">]</span> <span class=3D"o">=3D</span> <span class=3D"n">mp</span><sp=
an class=3D"p">(</span><span class=3D"n">seg</span><span class=3D"p">(</spa=
n><span class=3D"n">d</span><span class=3D"p">,</span> <span class=3D"n">a<=
/span><span class=3D"p">,</span> <span class=3D"n">b</span><span class=3D"p=
">),</span> <span class=3D"o">-</span><span class=3D"mi">1</span><span clas=
s=3D"p">);</span>
                            <span class=3D"p">}</span>
                        <span class=3D"p">}</span>
                        <span class=3D"k">else</span>
                        <span class=3D"p">{</span>
                            <span class=3D"kt">double</span> <span class=3D=
"n">s1</span> <span class=3D"o">=3D</span> <span class=3D"n">Cross</span><s=
pan class=3D"p">(</span><span class=3D"n">d</span> <span class=3D"o">-</spa=
n> <span class=3D"n">c</span><span class=3D"p">,</span> <span class=3D"n">a=
</span> <span class=3D"o">-</span> <span class=3D"n">c</span><span class=3D=
"p">);</span>
                            <span class=3D"kt">double</span> <span class=3D=
"n">s2</span> <span class=3D"o">=3D</span> <span class=3D"n">Cross</span><s=
pan class=3D"p">(</span><span class=3D"n">d</span> <span class=3D"o">-</spa=
n> <span class=3D"n">c</span><span class=3D"p">,</span> <span class=3D"n">b=
</span> <span class=3D"o">-</span> <span class=3D"n">c</span><span class=3D=
"p">);</span>
                            <span class=3D"k">if</span> <span class=3D"p">(=
</span><span class=3D"n">c1</span> <span class=3D"o">&gt;=3D</span> <span c=
lass=3D"mi">0</span> <span class=3D"o">&amp;&amp;</span> <span class=3D"n">=
c2</span> <span class=3D"o">&lt;</span> <span class=3D"mi">0</span><span cl=
ass=3D"p">)</span> <span class=3D"n">s</span><span class=3D"p">[</span><spa=
n class=3D"n">m</span><span class=3D"o">++</span><span class=3D"p">]</span>=
 <span class=3D"o">=3D</span> <span class=3D"n">mp</span><span class=3D"p">=
(</span><span class=3D"n">s1</span> <span class=3D"o">/</span> <span class=
=3D"p">(</span><span class=3D"n">s1</span> <span class=3D"o">-</span> <span=
 class=3D"n">s2</span><span class=3D"p">),</span> <span class=3D"mi">1</spa=
n><span class=3D"p">);</span>
                            <span class=3D"k">else</span> <span class=3D"k"=
>if</span> <span class=3D"p">(</span><span class=3D"n">c1</span> <span clas=
s=3D"o">&lt;</span> <span class=3D"mi">0</span> <span class=3D"o">&amp;&amp=
;</span> <span class=3D"n">c2</span> <span class=3D"o">&gt;=3D</span> <span=
 class=3D"mi">0</span><span class=3D"p">)</span> <span class=3D"n">s</span>=
<span class=3D"p">[</span><span class=3D"n">m</span><span class=3D"o">++</s=
pan><span class=3D"p">]</span> <span class=3D"o">=3D</span> <span class=3D"=
n">mp</span><span class=3D"p">(</span><span class=3D"n">s1</span> <span cla=
ss=3D"o">/</span> <span class=3D"p">(</span><span class=3D"n">s1</span> <sp=
an class=3D"o">-</span> <span class=3D"n">s2</span><span class=3D"p">),</sp=
an> <span class=3D"o">-</span><span class=3D"mi">1</span><span class=3D"p">=
);</span>
                        <span class=3D"p">}</span>
                    <span class=3D"p">}</span>
                <span class=3D"p">}</span>
            <span class=3D"p">}</span>
            <span class=3D"n">sort</span><span class=3D"p">(</span><span cl=
ass=3D"n">s</span><span class=3D"p">,</span> <span class=3D"n">s</span> <sp=
an class=3D"o">+</span> <span class=3D"n">m</span><span class=3D"p">);</spa=
n>
            <span class=3D"kt">double</span> <span class=3D"n">pre</span> <=
span class=3D"o">=3D</span> <span class=3D"n">min</span><span class=3D"p">(=
</span><span class=3D"n">max</span><span class=3D"p">(</span><span class=3D=
"n">s</span><span class=3D"p">[</span><span class=3D"mi">0</span><span clas=
s=3D"p">].</span><span class=3D"n">first</span><span class=3D"p">,</span> <=
span class=3D"mf">0.0</span><span class=3D"p">),</span> <span class=3D"mf">=
1.0</span><span class=3D"p">),</span> <span class=3D"n">now</span><span cla=
ss=3D"p">;</span>
            <span class=3D"kt">double</span> <span class=3D"n">sum</span> <=
span class=3D"o">=3D</span> <span class=3D"mi">0</span><span class=3D"p">;<=
/span>
            <span class=3D"kt">int</span> <span class=3D"n">cov</span> <spa=
n class=3D"o">=3D</span> <span class=3D"n">s</span><span class=3D"p">[</spa=
n><span class=3D"mi">0</span><span class=3D"p">].</span><span class=3D"n">s=
econd</span><span class=3D"p">;</span>
            <span class=3D"k">for</span> <span class=3D"p">(</span><span cl=
ass=3D"kt">int</span> <span class=3D"n">j</span> <span class=3D"o">=3D</spa=
n> <span class=3D"mi">1</span><span class=3D"p">;</span> <span class=3D"n">=
j</span> <span class=3D"o">&lt;</span> <span class=3D"n">m</span><span clas=
s=3D"p">;</span> <span class=3D"n">j</span><span class=3D"o">++</span><span=
 class=3D"p">)</span>
            <span class=3D"p">{</span>
                <span class=3D"n">now</span> <span class=3D"o">=3D</span> <=
span class=3D"n">min</span><span class=3D"p">(</span><span class=3D"n">max<=
/span><span class=3D"p">(</span><span class=3D"n">s</span><span class=3D"p"=
>[</span><span class=3D"n">j</span><span class=3D"p">].</span><span class=
=3D"n">first</span><span class=3D"p">,</span> <span class=3D"mf">0.0</span>=
<span class=3D"p">),</span> <span class=3D"mf">1.0</span><span class=3D"p">=
);</span>
                <span class=3D"k">if</span> <span class=3D"p">(</span><span=
 class=3D"o">!</span><span class=3D"n">cov</span><span class=3D"p">)</span>=
 <span class=3D"n">sum</span> <span class=3D"o">+=3D</span> <span class=3D"=
n">now</span> <span class=3D"o">-</span> <span class=3D"n">pre</span><span =
class=3D"p">;</span>
                <span class=3D"n">cov</span> <span class=3D"o">+=3D</span> =
<span class=3D"n">s</span><span class=3D"p">[</span><span class=3D"n">j</sp=
an><span class=3D"p">].</span><span class=3D"n">second</span><span class=3D=
"p">;</span>
                <span class=3D"n">pre</span> <span class=3D"o">=3D</span> <=
span class=3D"n">now</span><span class=3D"p">;</span>
            <span class=3D"p">}</span>
            <span class=3D"n">ret</span> <span class=3D"o">+=3D</span> <spa=
n class=3D"n">Cross</span><span class=3D"p">(</span><span class=3D"n">a</sp=
an><span class=3D"p">,</span> <span class=3D"n">b</span><span class=3D"p">)=
</span><span class=3D"o">*</span><span class=3D"n">sum</span><span class=3D=
"p">;</span>
        <span class=3D"p">}</span>
    <span class=3D"p">}</span>
    <span class=3D"k">return</span> <span class=3D"n">ret</span> <span clas=
s=3D"o">/</span> <span class=3D"mi">2</span><span class=3D"p">;</span>
<span class=3D"p">}</span>

<span class=3D"kt">int</span> <span class=3D"n">Main</span><span class=3D"p=
">(){</span>
    <span class=3D"kt">int</span> <span class=3D"n">n</span><span class=3D"=
p">,</span> <span class=3D"n">m</span><span class=3D"p">,</span> <span clas=
s=3D"n">kcase</span> <span class=3D"o">=3D</span> <span class=3D"mi">1</spa=
n><span class=3D"p">;</span>
    <span class=3D"kt">double</span> <span class=3D"n">x1</span><span class=
=3D"p">,</span><span class=3D"n">x2</span><span class=3D"p">,</span><span c=
lass=3D"n">x3</span><span class=3D"p">,</span><span class=3D"n">x4</span><s=
pan class=3D"p">,</span><span class=3D"n">y1</span><span class=3D"p">,</spa=
n><span class=3D"n">y2</span><span class=3D"p">,</span><span class=3D"n">y3=
</span><span class=3D"p">,</span><span class=3D"n">y4</span><span class=3D"=
p">;</span>
    <span class=3D"k">while</span> <span class=3D"p">(</span><span class=3D=
"o">~</span><span class=3D"n">scanf</span><span class=3D"p">(</span><span c=
lass=3D"s">"%lf%lf%lf%lf"</span><span class=3D"p">,</span><span class=3D"o"=
>&amp;</span><span class=3D"n">x1</span><span class=3D"p">,</span><span cla=
ss=3D"o">&amp;</span><span class=3D"n">y1</span><span class=3D"p">,</span><=
span class=3D"o">&amp;</span><span class=3D"n">x2</span><span class=3D"p">,=
</span><span class=3D"o">&amp;</span><span class=3D"n">y2</span><span class=
=3D"p">)){</span>
        <span class=3D"n">scanf</span><span class=3D"p">(</span><span class=
=3D"s">"%lf%lf%lf%lf"</span><span class=3D"p">,</span><span class=3D"o">&am=
p;</span><span class=3D"n">x3</span><span class=3D"p">,</span><span class=
=3D"o">&amp;</span><span class=3D"n">y3</span><span class=3D"p">,</span><sp=
an class=3D"o">&amp;</span><span class=3D"n">x4</span><span class=3D"p">,</=
span><span class=3D"o">&amp;</span><span class=3D"n">y4</span><span class=
=3D"p">);</span>

        <span class=3D"n">pp</span><span class=3D"p">[</span><span class=3D=
"mi">0</span><span class=3D"p">].</span><span class=3D"n">clear</span><span=
 class=3D"p">();</span>
        <span class=3D"n">pp</span><span class=3D"p">[</span><span class=3D=
"mi">1</span><span class=3D"p">].</span><span class=3D"n">clear</span><span=
 class=3D"p">();</span>

        <span class=3D"n">pp</span><span class=3D"p">[</span><span class=3D=
"mi">0</span><span class=3D"p">].</span><span class=3D"n">pb</span><span cl=
ass=3D"p">(</span><span class=3D"n">Point</span><span class=3D"p">(</span><=
span class=3D"n">x1</span><span class=3D"p">,</span><span class=3D"n">y1</s=
pan><span class=3D"p">));</span>
        <span class=3D"n">pp</span><span class=3D"p">[</span><span class=3D=
"mi">0</span><span class=3D"p">].</span><span class=3D"n">pb</span><span cl=
ass=3D"p">(</span><span class=3D"n">Point</span><span class=3D"p">(</span><=
span class=3D"n">x1</span><span class=3D"p">,</span><span class=3D"n">y2</s=
pan><span class=3D"p">));</span>
        <span class=3D"n">pp</span><span class=3D"p">[</span><span class=3D=
"mi">0</span><span class=3D"p">].</span><span class=3D"n">pb</span><span cl=
ass=3D"p">(</span><span class=3D"n">Point</span><span class=3D"p">(</span><=
span class=3D"n">x2</span><span class=3D"p">,</span><span class=3D"n">y1</s=
pan><span class=3D"p">));</span>
        <span class=3D"n">pp</span><span class=3D"p">[</span><span class=3D=
"mi">0</span><span class=3D"p">]</span><span class=3D"o">=3D</span><span cl=
ass=3D"n">ConvexHull</span><span class=3D"p">(</span><span class=3D"n">pp</=
span><span class=3D"p">[</span><span class=3D"mi">0</span><span class=3D"p"=
>]);</span>
<span class=3D"c1">//        for(int i=3D0;i&lt;pp[0].size();i++){</span>
<span class=3D"c1">//            printf("%lf  %lf\n",pp[0][i].x,pp[0][i].y)=
;</span>
<span class=3D"c1">//        }puts("-----");</span>
        <span class=3D"n">pp</span><span class=3D"p">[</span><span class=3D=
"mi">1</span><span class=3D"p">].</span><span class=3D"n">pb</span><span cl=
ass=3D"p">(</span><span class=3D"n">Point</span><span class=3D"p">(</span><=
span class=3D"n">x3</span><span class=3D"p">,</span><span class=3D"n">y3</s=
pan><span class=3D"p">));</span>
        <span class=3D"n">pp</span><span class=3D"p">[</span><span class=3D=
"mi">1</span><span class=3D"p">].</span><span class=3D"n">pb</span><span cl=
ass=3D"p">(</span><span class=3D"n">Point</span><span class=3D"p">(</span><=
span class=3D"n">x3</span><span class=3D"p">,</span><span class=3D"n">y4</s=
pan><span class=3D"p">));</span>
        <span class=3D"n">pp</span><span class=3D"p">[</span><span class=3D=
"mi">1</span><span class=3D"p">].</span><span class=3D"n">pb</span><span cl=
ass=3D"p">(</span><span class=3D"n">Point</span><span class=3D"p">(</span><=
span class=3D"n">x4</span><span class=3D"p">,</span><span class=3D"n">y3</s=
pan><span class=3D"p">));</span>
        <span class=3D"n">pp</span><span class=3D"p">[</span><span class=3D=
"mi">1</span><span class=3D"p">].</span><span class=3D"n">pb</span><span cl=
ass=3D"p">(</span><span class=3D"n">Point</span><span class=3D"p">(</span><=
span class=3D"n">x4</span><span class=3D"p">,</span><span class=3D"n">y4</s=
pan><span class=3D"p">));</span>
        <span class=3D"n">pp</span><span class=3D"p">[</span><span class=3D=
"mi">1</span><span class=3D"p">]</span><span class=3D"o">=3D</span><span cl=
ass=3D"n">ConvexHull</span><span class=3D"p">(</span><span class=3D"n">pp</=
span><span class=3D"p">[</span><span class=3D"mi">1</span><span class=3D"p"=
>]);</span>
<span class=3D"c1">//        for(int i=3D0;i&lt;pp[1].size();i++){</span>
<span class=3D"c1">//            printf("%lf  %lf\n",pp[1][i].x,pp[1][i].y)=
;</span>
<span class=3D"c1">//        }puts("-----");</span>

        <span class=3D"kt">double</span> <span class=3D"n">t1</span> <span =
class=3D"o">=3D</span> <span class=3D"n">area</span><span class=3D"p">(</sp=
an><span class=3D"n">pp</span><span class=3D"p">[</span><span class=3D"mi">=
0</span><span class=3D"p">])</span> <span class=3D"o">+</span> <span class=
=3D"n">area</span><span class=3D"p">(</span><span class=3D"n">pp</span><spa=
n class=3D"p">[</span><span class=3D"mi">1</span><span class=3D"p">]);</spa=
n>
        <span class=3D"kt">double</span> <span class=3D"n">t2</span> <span =
class=3D"o">=3D</span> <span class=3D"n">polyunion</span><span class=3D"p">=
(</span><span class=3D"n">pp</span><span class=3D"p">,</span> <span class=
=3D"mi">2</span><span class=3D"p">);</span>
        <span class=3D"n">printf</span><span class=3D"p">(</span><span clas=
s=3D"s">"%.10lf</span><span class=3D"se">\n</span><span class=3D"s">"</span=
><span class=3D"p">,</span><span class=3D"n">t1</span><span class=3D"o">-</=
span><span class=3D"n">t2</span><span class=3D"p">);</span>
    <span class=3D"p">}</span>
    <span class=3D"k">return</span> <span class=3D"mi">0</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>

<span class=3D"kt">int</span> <span class=3D"n">main</span><span class=3D"p=
">(){</span>
<span class=3D"cp">#ifndef ONLINE_JUDGE</span>
    <span class=3D"n">freopen</span><span class=3D"p">(</span><span class=
=3D"s">"asdf.in"</span> <span class=3D"p">,</span><span class=3D"s">"r"</sp=
an><span class=3D"p">,</span><span class=3D"n">stdin</span> <span class=3D"=
p">);</span>
    <span class=3D"n">freopen</span><span class=3D"p">(</span><span class=
=3D"s">"asdf.out"</span><span class=3D"p">,</span><span class=3D"s">"w"</sp=
an><span class=3D"p">,</span><span class=3D"n">stdout</span><span class=3D"=
p">);</span>
    <span class=3D"kt">double</span> <span class=3D"n">_time_tabris</span><=
span class=3D"o">=3D</span><span class=3D"n">clock</span><span class=3D"p">=
();</span>
<span class=3D"cp">#endif </span><span class=3D"c1">// ONLINE_JUDGE</span>
    <span class=3D"n">Main</span><span class=3D"p">();</span>
<span class=3D"cp">#ifndef ONLINE_JUDGE</span>
	<span class=3D"n">printf</span><span class=3D"p">(</span><span class=3D"s"=
>"time: %lf</span><span class=3D"se">\n</span><span class=3D"s">"</span><sp=
an class=3D"p">,</span><span class=3D"n">clock</span><span class=3D"p">()</=
span><span class=3D"o">-</span><span class=3D"n">_time_tabris</span><span c=
lass=3D"p">);</span>
<span class=3D"cp">#endif </span><span class=3D"c1">//ONLINE_JUDGE</span>
    <span class=3D"k">return</span> <span class=3D"mi">0</span><span class=
=3D"p">;</span>
<span class=3D"p">}</span>
</pre></div>
</td></tr></tbody></table>
</div>
<a class=3D"pturl" href=3D"https://paste.ubuntu.com/24458430/plain/">Downlo=
ad as text</a>
</div>




		    </div>
	    </div>
	</div>



</body></html>
------MultipartBoundary--myup3W28cJhACPRv5gfAkJpIiTgDgdI7llNQjDYTk8----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: https://paste.ubuntu.com/static/pastebin.css

@charset "utf-8";

.c { color: rgb(0, 136, 0); font-style: italic; }

.err { border: 1px solid rgb(255, 0, 0); }

.k { color: rgb(170, 34, 255); font-weight: bold; }

.o { color: rgb(102, 102, 102); }

.cm { color: rgb(0, 136, 0); font-style: italic; }

.cp { color: rgb(0, 136, 0); }

.c1 { color: rgb(0, 136, 0); font-style: italic; }

.c-Special { color: rgb(0, 136, 0); font-weight: bold; }

.gd { color: rgb(160, 0, 0); }

.ge { font-style: italic; }

.gr { color: rgb(255, 0, 0); }

.gh { color: rgb(0, 0, 128); font-weight: bold; }

.gi { color: rgb(0, 160, 0); }

.go { color: rgb(128, 128, 128); }

.gp { color: rgb(0, 0, 128); font-weight: bold; }

.gs { font-weight: bold; }

.gu { color: rgb(128, 0, 128); font-weight: bold; }

.gt { color: rgb(0, 64, 208); }

.kc { color: rgb(170, 34, 255); font-weight: bold; }

.kd { color: rgb(170, 34, 255); font-weight: bold; }

.kp { color: rgb(170, 34, 255); }

.kr { color: rgb(170, 34, 255); font-weight: bold; }

.kt { color: rgb(170, 34, 255); font-weight: bold; }

.m { color: rgb(102, 102, 102); }

.s { color: rgb(187, 68, 68); }

.na { color: rgb(187, 68, 68); }

.nb { color: rgb(170, 34, 255); }

.nc { color: rgb(0, 0, 255); }

.no { color: rgb(136, 0, 0); }

.nd { color: rgb(170, 34, 255); }

.ni { color: rgb(153, 153, 153); font-weight: bold; }

.ne { color: rgb(210, 65, 58); font-weight: bold; }

.nf { color: rgb(0, 160, 0); }

.nl { color: rgb(160, 160, 0); }

.nn { color: rgb(0, 0, 255); font-weight: bold; }

.nt { color: rgb(0, 128, 0); font-weight: bold; }

.nv { color: rgb(184, 134, 11); }

.ow { color: rgb(170, 34, 255); font-weight: bold; }

.mf { color: rgb(102, 102, 102); }

.mh { color: rgb(102, 102, 102); }

.mi { color: rgb(102, 102, 102); }

.mo { color: rgb(102, 102, 102); }

.sb { color: rgb(187, 68, 68); }

.sc { color: rgb(187, 68, 68); }

.sd { color: rgb(187, 68, 68); font-style: italic; }

.s2 { color: rgb(187, 68, 68); }

.se { color: rgb(187, 102, 34); font-weight: bold; }

.sh { color: rgb(187, 68, 68); }

.si { color: rgb(187, 102, 136); font-weight: bold; }

.sx { color: rgb(0, 128, 0); }

.sr { color: rgb(187, 102, 136); }

.s1 { color: rgb(187, 68, 68); }

.ss { color: rgb(184, 134, 11); }

.bp { color: rgb(170, 34, 255); }

.vc { color: rgb(184, 134, 11); }

.vg { color: rgb(184, 134, 11); }

.vi { color: rgb(184, 134, 11); }

.il { color: rgb(102, 102, 102); }

body { background-image: url("bg_dotted.png"); font-family: arial, helvetic=
a, sans-serif; font-size: small; }

#title { background: url("ubuntu_logo.png") no-repeat; width: 375px; height=
: 56px; margin: 0px auto 30px; font-size: 0%; color: rgb(255, 255, 255); }

#contentColumn { margin: -10px auto 20px; width: 95%; font-family: Verdana,=
 arial, helvetica, sans-serif; box-shadow: rgb(187, 187, 187) 0px 1px 5px; =
background: rgb(255, 255, 255); border-radius: 0px 0px 10px 10px; }

#pasteform table { margin: 0px auto; }

.inside { padding: 0px 1.5em; }

#contentColumn { padding-top: 3em; padding-bottom: 1em; }

#contentColumn .inside { position: relative; top: -2em; padding: 0px 0.5em;=
 }

th, td { padding: 0px 0px 6px 12px; color: rgb(136, 136, 136); }

label, .pturl { color: rgb(221, 72, 20) !important; }

h1 { text-align: center; color: rgb(221, 72, 20); font-family: Verdana, ari=
al, helvetica, sans-serif; font-size: medium; font-weight: 400; padding-top=
: 0.4em; margin: 0px; }

textarea { font: 110% "Courier New", Courier, monospace; color: rgb(0, 0, 0=
); width: 100%; }

.linenos { font-size: medium; }

div.paste { font-size: small; border: 1px solid rgb(221, 221, 221); backgro=
und-color: rgb(238, 238, 238); border-radius: 4px; padding: 10px 0px; margi=
n: 20px 10px 100px; color: rgb(0, 0, 0); }

div.paste div { border: 0px; margin: 0px; padding: 0px; box-shadow: rgb(238=
, 238, 238) 0px 1px 5px; font-size: medium; }

div.paste a { color: rgb(0, 0, 0); text-decoration: none; font-weight: 700;=
 font-size: 0.9em; padding: 1em; }

#pasteform > table { width: 100%; }
------MultipartBoundary--myup3W28cJhACPRv5gfAkJpIiTgDgdI7llNQjDYTk8----
Content-Type: image/png
Content-Transfer-Encoding: base64
Content-Location: https://paste.ubuntu.com/static/bg_dotted.png

iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAMAAACeL25MAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJ
bWFnZVJlYWR5ccllPAAAAAZQTFRF////zsrFFOhhzwAAAA9JREFUeNpiYGTAAAABBgAAJwAC/Bns
gQAAAABJRU5ErkJggg==

------MultipartBoundary--myup3W28cJhACPRv5gfAkJpIiTgDgdI7llNQjDYTk8----
Content-Type: image/png
Content-Transfer-Encoding: base64
Content-Location: https://paste.ubuntu.com/static/ubuntu_logo.png

iVBORw0KGgoAAAANSUhEUgAAAXcAAAA2CAYAAAA8s9mDAAAACXBIWXMAAAsTAAALEwEAmpwYAAAK
p2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjarZZ3UJPpFsbP933pBQIJVUroHekEkBJCC6Ag
HWyEhB5iDAkiYmdxBdaCighWdFFEwUaRtSAWbItiw75BFhV1XVzFhsr9gyXcO/feP+7MPTPvzG/O
PPO857zvPw8Aba9AKhWjDIA8iVwWExrITkpOYRMfARGMgAwM8BYI86Xc6OhI+M+FAHy4CwgAwC0H
gVQqhv+tNETp+UIAJBoA0kT5wjwA5DgAUiGUyuQAWAAAmC+US+UAmAgAWLKk5BQArBAAWJnjXAEA
rLRx3gUALFlcDA8AOw5AogkEskwAaicAsAuEmXIAqhIAnCSibAkAjQEAfsIsgQiAFg0A9nl580UA
tGIAsE77J5/Mf/FMU3kKBJkqHt8FAABIQdn5UrFgEfy/K0+smLjDCABo+bmxEQDAAkAKhYLg2AnO
SudHTrBUHhgzwdlyfpxKowiLn2BFbjx3gnPnR6j0krQZUSr/fF7KBBdlxSVOsCg9KHiCZfNjVPr8
gtjgST1vxgTnCMKjJ1ggA5jgdHFozOTM0ao5JeIZql0yZCEqTXr+5L7yrLgwFcviVJqM7BC+al9Z
2KS/OFrlKVPEqN4hXRKv8hQJglRvC0EQDJEQCWyIBxdwA2dwkqcXygEAePOli2TZmVlyNlcqFafb
s/kSoaM928XJ2QWSklPY49/17h4gAIBokyZ71XsAglMAkLTJHscP4KAIQIs42bN4D6DGBTh5TqiQ
FYz3cAAAeKCAOrBAD4zADKzBAVzAA3wgAIIhHKIgDpJhLgghC/JABguhGFZAKZTDetgMNbAT9sB+
OARHoQ1Owlm4CFfhBtyBh6CEQXgFw/ABRhEEISJ0hInoIcaIBWKHuCAcxA8JRiKRGCQZSUUyEQmi
QIqRVUg5UonUILuRBuQIcgI5i1xGepH7SD8yhPyFfEExlIayUEPUEp2KclAuGoHGoXPQTHQBWoSW
oGvRarQOPYi2omfRq+gdVIm+QkcwwKiYNmaCOWAcjIdFYSlYBibDlmJlWBVWhzVhHVg3dgtTYq+x
zzgCjolj4xxwPrgwXDxOiFuAW4qrwNXg9uNacedxt3D9uGHcdzwdb4C3w3vj+fgkfCZ+Ib4UX4Wv
x7fgL+Dv4AfxHwgEgjbBiuBJCCMkE3IIiwkVhO2EZkInoZcwQBghEol6RDuiLzGKKCDKiaXErcSD
xDPEm8RB4icSlWRMciGFkFJIEtJKUhXpAOk06SbpOWmUzCBbkL3JUWQReRF5HXkvuYN8nTxIHqVo
UKwovpQ4Sg5lBaWa0kS5QHlEeUelUk2pXtSZ1Gzqcmo19TD1ErWf+pmmSbOl8WizaQraWto+Wift
Pu0dnU63pAfQU+hy+lp6A/0c/Qn9kxpTzVGNryZSW6ZWq9aqdlPtjTpZ3UKdqz5XvUi9Sv2Y+nX1
1wwyw5LBYwgYSxm1jBOMPsaIBlPDWSNKI0+jQuOAxmWNF5pETUvNYE2RZonmHs1zmgNMjGnG5DGF
zFXMvcwLzEEWgWXF4rNyWOWsQ6we1rCWppabVoJWoVat1iktpTambanN1xZrr9M+qn1X+4uOoQ5X
J11njU6Tzk2dj7pTdAN003XLdJt17+h+0WPrBevl6m3Qa9N7rI/Tt9Wfqb9Qf4f+Bf3XU1hTfKYI
p5RNOTrlgQFqYGsQY7DYYI/BNYMRQyPDUEOp4VbDc4avjbSNAoxyjDYZnTYaMmYa+xlnG28yPmP8
kq3F5rLF7Gr2efawiYFJmInCZLdJj8moqZVpvOlK02bTx2YUM45Zhtkmsy6zYXNj8+nmxeaN5g8s
yBYciyyLLRbdFh8trSwTLVdbtlm+sNK14lsVWTVaPbKmW/tbL7Cus75tQ7Dh2OTabLe5YYvauttm
2dbaXrdD7Tzssu222/Xa4+297CX2dfZ9DjQHrkOBQ6NDv6O2Y6TjSsc2xzdTzaemTN0wtXvqdyd3
J7HTXqeHzprO4c4rnTuc/3KxdRG61LrcdqW7hrguc213fetm55butsPtnjvTfbr7avcu928enh4y
jyaPIU9zz1TPbZ59HBYnmlPBueSF9wr0WuZ10uuzt4e33Puo958+Dj65Pgd8XkyzmpY+be+0AV9T
X4Hvbl+lH9sv1W+Xn9LfxF/gX+f/NMAsQBRQH/Cca8PN4R7kvgl0CpQFtgR+5HnzlvA6g7Cg0KCy
oJ5gzeD44JrgJyGmIZkhjSHDoe6hi0M7w/BhEWEbwvr4hnwhv4E/HO4ZviT8fAQtIjaiJuJppG2k
LLJjOjo9fPrG6Y9mWMyQzGiLgih+1Maox9FW0Quif5lJmBk9s3bmsxjnmOKY7lhm7LzYA7Ef4gLj
1sU9jLeOV8R3JagnzE5oSPiYGJRYmahMmpq0JOlqsn5ydnJ7CjElIaU+ZWRW8KzNswZnu88unX13
jtWcwjmX5+rPFc89NU99nmDesVR8amLqgdSvgihBnWAkjZ+2LW1YyBNuEb4SBYg2iYbSfdMr059n
+GZUZrzI9M3cmDmU5Z9VlfU6m5ddk/02JyxnZ87H3Kjcfblj4kRxcx4pLzXvhERTkis5P99ofuH8
XqmdtFSqXOC9YPOCYVmErD4fyZ+T3y5nyaXyawprxQ+K/gK/gtqCTwsTFh4r1CiUFF5bZLtozaLn
RSFFPy/GLRYu7io2KV5R3L+Eu2T3UmRp2tKuZWbLSpYNLg9dvn8FZUXuil9XOq2sXPl+VeKqjhLD
kuUlAz+E/tBYqlYqK+1b7bN654+4H7N/7Fnjumbrmu9lorIr5U7lVeVfK4QVV35y/qn6p7G1GWt7
1nms27GesF6y/u4G/w37KzUqiyoHNk7f2LqJvals0/vN8zZfrnKr2rmFskWxRVkdWd2+1Xzr+q1f
a7Jq7tQG1jZvM9i2ZtvH7aLtN3cE7GjaabizfOeXXdm77u0O3d1aZ1lXtYewp2DPs70Je7t/5vzc
UK9fX17/bZ9kn3J/zP7zDZ4NDQcMDqxrRBsVjUMHZx+8cSjoUHuTQ9PuZu3m8sNwWHH45ZHUI3eP
RhztOsY51nTc4vi2FmZLWSvSuqh1uC2rTdme3N57IvxEV4dPR8svjr/sO2lysvaU1ql1pymnS06P
nSk6M9Ip7Xx9NvPsQNe8rofnks7dPj/zfM+FiAuXLoZcPNfN7T5zyffSycvel09c4Vxpu+pxtfWa
+7WWX91/benx6Gm97nm9/YbXjY7eab2nb/rfPHsr6NbF2/zbV+/MuNN7N/7uvb7Zfcp7onsv7ovv
v31Q8GD04fJH+EdljxmPq54YPKn7zea3ZqWH8lR/UP+1p7FPHw4IB179nv/718GSZ/RnVc+Nnze8
cHlxcihk6MbLWS8HX0lfjb4u/UPjj21vrN8c/zPgz2vDScODb2Vvx/6qeKf3bt97t/ddI9EjTz7k
fRj9WPZJ79P+z5zP3V8SvzwfXfiV+LX6m823ju8R3x+N5Y2NSQUyAQAAYACAZmQA/LUPgJ4MwLwB
QFEbz7t/53RkMrH/Nx7PxAAA4AHQBABRAQBunQBHlgNYdgKoAUB0AEBcAKCurqrzd+VnuLqMe1Hb
APBVY2PvEgGINgDf+sbGRtvGxr7VA2APADo/jOdsAADGQYBhHZ5rZOSVFt6/5d1/APUC9B+hkUmv
AAAAIGNIUk0AAG4nAABzrwABB7UAAHmtAABNZwABBecAADHuAAASF1Ui32QAAA43SURBVHja7F1N
aBtJFv6mNhBISLZnN4bZMCQ9BDYhF7eHXMxkSfswc9iDrZyWkIM7ZA8DyxD7EHIbK7ktOdhhLzlk
kHxY5mg7h73sQQrMksOaSGJhSQ6DNLMhe0iIexwwBCadOVRJarWquqtbaqlbeh80ceRWuX5effXq
1XuvPsDYwUwANgATwCXxrwl4H4BAGDIeO7MGAAfAkpC7IOoAqgA258uNOvUYIa/IAIGyIoC1/s+J
3AlDJ/UVADcAGJpfqwJYJZIn5BGMuoAwBcRuAagJJcKI8VUbQO2xM+tQLxKI3AmE7BF7BdzcF4mj
p87i7FfrOHP9Dg4dOdb+uPTYmS1RbxKI3AmEbBC7KYhdW1s/c/0OPvx0ATMXF/Hx0pf+XzmkwRPy
hEPUBYTAem8KLdcGUAa8Vo4bU1IR+9FTZ/HR51dx/NwFHD5xEu8O3uD1kwp+1dXWe372afB1ssET
iNwJeSF0B8Ay+r1HqgBySe5Cy7b7BP7IMZy+chMH/3uGmYuLPUQ+c3ERL7972CH75zv3ZUWvA1gg
mSFkflZTFxB8mvokYU324flbDzBzcRGHf3sS+093cfDjM+w/3cX+010AwMzFRRw6cgyHT5z029z9
sIUdn0AgzZ1AGLHWbkFygGpeuYkjp84CAD78dAG1m3/s0+rbNncA+P1X6/jP2p/w88GbYFHL4P7w
BAJp7gTCCFHo02KOHMNHX1wFALw7eIP//vXPfV/6+eANnv1tFXtPKgCAwydO9phu/No7dTGByJ1A
GD1m2z8cP3cBv/viakcbB4DWt3fx9tUL5Ze//+brzs8fzknN6xZ1MYHInUAYPYw2sZ+/9QCnr9zE
x0tfduzq7X9V+PngTeed4+cuSN8RbpYEQmZBNnfCxMJPzIdPnMTLfz3E8XMXQrX2Nn749q7MFdIP
Ezn1JCKQ5k4g5Bovv3uId+IwdO9JBTOfcfv5UXGoGoYz1+/g/K0HOHP9jvT38+VGlXp4IinRAlhB
xHuQ5j6CDrfBD7Fm0R+UUgfQALANeO5kCRlMdO27pyEPoa8D+IH/6xHhdPvEfvvqBf79lz90tPjz
tx4AAD76/GqPXV2m8be9ag5+fEa9OR2kXkHvQflC3ndmhwD2XvL5bcArJuggWVlVwEsQ9MFM8Ax+
DsLDx9sDUgJYGcA9wKuPsd5BIREIy3LJDNHOWUHmVow/6PtbzOXtx8aQFrpKjM2dpL9YEXJ/84X4
CxGzeX20ZLURfGn/6S7evnrR8YDZf7aLl9897J8QR47BvHKz8/////PvirYSJgz2CBaQFfBU061k
PBXzr2W4s5vgKVqNGN9xANQAtp4zwbLAIx8dDOaJYQgybQoynFZIyfeHb+92fjav3MRvPl3A4RMn
O6Q+c3ERc3f/0dHa/cFNAewQFxJiUu26mOO2mOeVtE0/k3qguiLIbWGyTDWxSL4CsGuAV562xs+X
G63Hzuw2Av7ur59U8HznPj5e+hLPd+7jzPU7fYem7w7edGz1ivQDALBNZJWY5Czwy3imrQ8Lkjlq
A0htfk6yt4wltvFzUzyTSgCrp739yyhuSyYUnm/fx/7TXRw9dVZK7PtPdzuBS/vPdvH6SZ8laGO+
3GgRSccm9VpgV0qX8aSMvJB7S2hLDXQPOSxwG3UBatONxbdD3mpOx8cFPxysA/gpYHKwRLuXEG7K
GSTRVV3UQffdLGnv9cfO7AbfxfWibW55++pFxwQDAG9fveixt898thgk95ZYNAjJlK1pxiZ6z5/c
tHeAWSf3Kp9M0sM38RlbFRN4TVHGCsB2cupJcjmk3u3Pi8IEta6YQDb/faL2r+bZA2e+3Fh97Mza
KmJ5/aTSp5kfP3uhR3MPTMbL8+WGCwIhNrwiwFroPVBNVZayTO6X9exynisIrgq5NwUE8VcnWHCq
AFsAv0rOlLywjOn18FgQcqGlOX7/zdfYq1V6olQFsS9QHnfCgPO0jBRt7EFk2Fsm7oGLV+WaphS2
OMiZZMFxQ0wGhWmdTvPlhjtfbswB2ND9zusnFT+x14nYCXnEhEWoehshGurylGgGsq2eMQkRdwOS
/KrQ4nV3MC0A1+bLjbl0iZ0Z6SgezODmuM4zpL/BzN5yM0NlKdeJWcPtx4HHIHI+T6K3zCbkAQmF
EM1+krAN7kcbhIkpz4UiUgZURdKvAviBfHCSPAKwPVxCZya6wWmX0D0Ml+lZdbEA3Yt3xSGzwIP+
2n9HpctV+RyJ4yLLbFG2rai3K+r9CNoBdKwS8cJquJdXJ/Bvub+9rL04byJ5QJ8hgo5U5ddF+WXN
9lrg52K+cVY5ejBD9LXlk1ErRDdXjSl7L3mKCYVYVlbEILKi/HsDTab3iscYXr3DhDZue5itqEMC
LUTVn2wlwXcG1IKGWa6yj4rIPJTyGPWU1DKr3deqp6ZXNivFLNceUh/YEbLQ1Cxnj+eKSW2MdMu3
9flFxSGRT9O/s5jUxGGqrbeFyUdVrYkQcgYHPOJaR27j7sosqB0QfMQu3QWGIG3vKuaIepuaXzAA
bOkRcCK0y3cyIC8m7xsuL5MaxFRXmGYsUF4QwvjRNmO0zUBQm2s6E/aTiO1/yyf7dfBkcn60Y0IC
84EV5XmkmC0hdpebITrxJobPdGAjXqxDVaOPZHUqKcp6JP61IY/9KHGPutgmGleU2/D1o8Q8hRLP
7ZRa5G3VN74/Afi1aKMtWWxKAOYmldx/Iu2VkGGExC+wArht1uzXDkOD0eoAPgm307O2tu6fB8sA
JOTe54BQhzydhyAzZsTQphE/KR8zJMTuArgWINQqbw9bQa+N2wB3idY9d2uBx9iUFXVZQ3+A3DrS
CUwKSeTITCEbVmDRLlA+dwIhU/C2wVNmBLVgO9wO7bnRB7BeXUJupsLzIvjZZrjW67kpp7lwJHUK
iYXxNiREG8d0EpKXyXPFYehtSV86I5aXllj0g2OzROROIGSP4F1OXH0T9sYQyi5LytXRuMe96w22
vaxh31/tb8MwXSW9IvrPOm6MSV6CC5FF5E4gZJPgW5IJWxhS4ToadnABWNb33Bk2mClZgO5p9mGw
rdaQK3evv/yx9NMjXXI/TZOLQBg7NiVEZ4/ob+9ItPvmmLxCJG3WNgG5Ke9AtiWfWWPoo+AOQukt
Y+Z8UlyKqbG0JG22QUgLBnWBlvZel3grR8xN5qDrLSJ7t6pHPl4ZYDcC7xrgXiHrYlcRM9AqMcx+
wtaOQwm2dXb4O6y4YzQaWZlUbxlLd3ULIXfC4HBDxmebukdbIzOjiUPqZaOpBSuhSrpmgHuKrIiE
fZsjvhTGGED5MsY3RqMFG4IAZAysoBhAN8HdqqS9DwZVf5PZb4DttkJb3xo+qXgu4M2Be4W4IVxR
EhGvFo1RdnAIXcd/CbHlMpe36rS6GkFCtkLDrGJ6YaQk9LRoDr4Lbc9TE73+3H6Z3kHvhSumeG7E
G1uvCO477qCbv0ZWzwpPPZ36zV8tSM8jxkbEmVzUDoU0Noc5wFkhhDjChKER0gcbU6xhX8JA5hOv
xaP2ZFGXuVUexr3A1iXKTPCdVeHnrZonl5ItsO185MwWc8OR1HULwCfpd4sqqCeTYzQeNkS/C00b
hXyliWUW5KHJYrUODQuuqlfk1HJSZAmuWgYGhqpv14i3tWQ6aqyC75TDiX0oxFoFvGvgNvm6fOFO
1DZd5cPMDjdJ+aGViZoJzcxVrEZb4/NtjdUMG/1h1X7cjtYwlattaQou+lARsBmeTVILO4rPbZGY
iqDGcoyxiurvtOTmsnxsY2u7cRWErChdS/2LbzYupGciumlbrbmixm1tUSQ/7JVUh1CZJQgijNir
mif590KEsCJSqka0kRnIr5ufSgbWOcEr0yULkmbNkK28SpNxRHpTHTKY8AVWKkuO5hgFFuSRKgYt
6JlvW8nr6bkS5Wtt/IqnNLnadlYkqO0KuSpWQkMhLCWhwdYV28I0OrnmS4rvKia7oSFQlzUFqAyw
ZYXWYQgzwpq45FYmqGbO2WQnRBtaFyRfDdfQmKXQWlb5LlClwcMWtvl6Qi0wb9BREmQKi0ZUJpYw
+nMinfnfCrR7GfHuE72HXrNrW+laSPui6RDlcyu+lWA8q1BhgIT1YU/CyzoGfprxzSnMFMn3U6hP
lAaQhUstWG3AdoaYcGJf+qD7FLPP5cqLOAqKeVjTn0dsRfLuVvgus+8yCFsxL7fCd+3MUIyrrVlP
yWUkzOJBUrJIWGm/NCPqaIvy1mOOkRPCESrOWo8xL+Nc1lFMJme9v3QmhNwrybdszEqH4HNB7oO2
fSui/BKRu1JeKxG3/ZghBLsXcttSJfDUNMm4ElFWTa1UKUkxTBGrRfNGpPK156tfU69ekWPU9JW5
F36zVax5OWpy71SimVNyH1LuC2YOcNVVjsm9Q/C15P0fWX5xyIvnygSQe9Q1blbKu24Zue8Nv65x
57pSPpspzMH3gyk1kWeSWSD3Hi1+K8Hgtg8fHf1DVmaK99cTkOped/uYxoEJK8UU9HYfiK2l9sFw
RfJYCeqsKitm/zBHk+Sboo9iLETMENv0WoJ7P7eEfNn58OSSEkczBmmYMWS1OURybybYLVuai/uA
CwUzEigJUQtPM11lcvTk/kGMw4OwieQO3/2HGeh6SAQPLN3uQeuo3I6YxqHppAblKIm7NZzEUZEL
Q2tECapSJPceLIgDRgfdJHcmugf1jwBsJ5NtZoEfjF9Sz9VO0F41vG+lZfnrmbCuzPSVG+SVOi9T
57o6ZvjKMSX1a7e1qjc3mSk4xwJPMOavm4GuY0eMOkr5LIIz+/hWU/4pXQqBMG7NnSYhIX2poy4g
EAgEIncCgUAgELkTCAQCgcidQCAQCETuBAKBQCByJxAIhKnBLwMAIw4vSOyhlUUAAAAASUVORK5C
YII=

------MultipartBoundary--myup3W28cJhACPRv5gfAkJpIiTgDgdI7llNQjDYTk8------
